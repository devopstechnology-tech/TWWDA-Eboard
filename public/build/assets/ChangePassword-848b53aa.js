import{u as C,c as O,a as l,b as P}from"./useUnexpectedErrorHandler-26b06961.js";import{d as V,i as T,j as q,k as A,r as u,b as B,o,c as r,e as s,f as m,w as N,g as j,t as p,h as _,u as h,l as F,D as $,m as I,V as H}from"./main-6dda9e4d.js";import{a as M}from"./useStaffAuthenticateRequest-0dcbf7f2.js";import{F as b}from"./FormInput-a47218b6.js";import{_ as U}from"./LoadingComponent.vue_vue_type_script_setup_true_lang-9003c7c3.js";import{u as Y}from"./useMutation-9732af13.js";import"./staff_routes-4cc72ee9.js";import"./useQueryClient-918ce480.js";const G={class:"card card-outline card-primary register-box"},J={class:"card-header text-center h1 text-primary"},L=s("b",null,"Eboard",-1),W={class:"font-bold error-message text-danger"},z={class:"card-body"},K={key:0,class:"login-box-msg text-primary"},Q={key:1,class:"login-box-msg text-danger"},X={key:2,class:"login-box-msg text-danger"},Z={class:"row"},ee={class:"row"},se={class:"col-md-12 mb-2"},te={key:0,type:"submit",class:"btn btn-primary btn-block"},me=V({__name:"ChangePassword",setup(oe){const i=T(),f=C(),y=q(),c=A(),w=y.query.token,d=u(""),a=u(""),n=u(!1),k=O({otp:l().required(),password:l().required(),token:l().required()}),{handleSubmit:v,setErrors:x}=P({validationSchema:k,initialValues:{otp:"",password:"",token:w}}),{mutate:S,isLoading:E}=Y(e=>M(e),{onSuccess:async()=>{i.intendedRoute?await c.push(i.intendedRoute):(i.setIntendedRoute(void 0),await c.push({name:$}))},onError:async e=>{if(e.response&&e.response.status===403)try{const t=await e.response.json();d.value=`Access Denied: ${t.errors}`,n.value=!0,setTimeout(()=>{c.push({name:I})},5e3)}catch(t){console.error("Error parsing JSON:",t),a.value="Error parsing the error message.",n.value=!0}else e instanceof H?x(e.messages):f(e)}}),g=v(async e=>{e.otp&&typeof e.otp!="string"&&(e.otp=String(e.otp)),S(e)});return(e,t)=>{const R=B("router-link");return o(),r("div",G,[s("div",J,[m(R,{to:"",class:"1"},{default:N(()=>[L,j("System")]),_:1}),s("div",W,p(d.value),1)]),s("div",z,[n.value?_("",!0):(o(),r("p",K," Change Your Password as You Desire, don't share it ")),n.value&&!a.value?(o(),r("p",Q,p(d.value),1)):_("",!0),a.value?(o(),r("p",X,p(a.value),1)):_("",!0),s("form",{novalidate:"",onSubmit:t[0]||(t[0]=(...D)=>h(g)&&h(g)(...D))},[s("div",Z,[m(b,{labeled:!0,direction:"up",label:"OTP",name:"otp",class:"w-full text-sm tracking-wide col-md-12 mb-2",placeholder:"Enter your OTP",type:"number"}),m(b,{labeled:!0,direction:"up",label:"Password **",name:"password",class:"w-full text-sm tracking-wide col-md-12 mb-2",placeholder:"*****",type:"password"})]),s("div",ee,[s("div",se,[h(E)?(o(),F(U,{key:1})):(o(),r("button",te,"Sign In"))])])],32)])])}}});export{me as default};
