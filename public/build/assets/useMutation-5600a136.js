var R=Object.defineProperty;var l=(a,t)=>R(a,"name",{value:t,configurable:!0});import{S as M,z as m,A as g,B as O,C as S,E as C,G as E,H as b,I as x,J as A,K as q,M as w,u as p,N as K,O as U}from"./main-73cc7250.js";import{u as D}from"./useQueryClient-0fa55727.js";const v=class v extends M{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=this.client.defaultMutationOptions(t),m(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(e=this.currentMutation)==null||e.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var t;(t=this.currentMutation)==null||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();const e={listeners:!0};t.type==="success"?e.onSuccess=!0:t.type==="error"&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof t<"u"?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:g(),e={...t,isLoading:t.status==="loading",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=e}notify(t){O.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(t.onSuccess){var e,s,i,n;(e=(s=this.mutateOptions).onSuccess)==null||e.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(i=(n=this.mutateOptions).onSettled)==null||i.call(n,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(t.onError){var r,u,c,h;(r=(u=this.mutateOptions).onError)==null||r.call(u,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(c=(h=this.mutateOptions).onSettled)==null||c.call(h,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}t.listeners&&this.listeners.forEach(({listener:d})=>{d(this.currentResult)})})}};l(v,"MutationObserver");let f=v;function j(a,t,e){var s;const i=S(()=>L(a,t,e)),n=(s=i.value.queryClient)!=null?s:D(i.value.queryClientKey),r=new f(n,n.defaultMutationOptions(i.value)),u=C(r.getCurrentResult()),c=r.subscribe(o=>{E(u,o)}),h=l((o,y)=>{r.mutate(o,y).catch(()=>{})},"mutate");b(i,()=>{r.setOptions(n.defaultMutationOptions(i.value))}),x(()=>{c()});const d=A(q(u));return b(()=>u.error,o=>{if(o&&w(i.value.useErrorBoundary,[o]))throw o}),{...d,mutate:h,mutateAsync:u.mutate,reset:u.reset}}l(j,"useMutation");function L(a,t,e){const s=p(a),i=p(t);let n=s;return K(s)&&(typeof i=="function"?n={...p(e),mutationKey:s,mutationFn:i}:n={...i,mutationKey:s}),typeof s=="function"&&(n={...i,mutationFn:s}),U(n)}l(L,"parseMutationArgs");export{j as u};
