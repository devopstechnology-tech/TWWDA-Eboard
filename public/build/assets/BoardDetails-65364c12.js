var vt=Object.defineProperty;var i=(R,y)=>vt(R,"name",{value:y,configurable:!0});import{d as xe,i as Ce,j as De,k as Ye,r as v,V as qe,C as J,P as ke,b as Ne,u as n,o as t,c as s,e,a1 as I,F as z,T as Y,f as A,w as we,g as N,t as r,h as _,l as ye,R as H,$ as je,a0 as Oe,_ as Ee,H as lt,a2 as bt,a3 as ft,a4 as it,a5 as gt,a6 as We,a7 as yt,a8 as xt,Z as $t}from"./main-d97516e2.js";import{f as wt}from"./useBoardRequest-eb8bdd66.js";import{r as kt,a as Mt,b as dt,s as et,i as Ct,u as tt,c as St,d as st,e as Tt,g as Pt,h as qt,j as ot,k as He,m as Dt,n as It,o as Fe,p as Ft,q as Bt,t as Et,v as Ut,w as At,f as at,F as nt,x as Rt,y as Vt}from"./Breadcrumb-62de853f.js";import{u as Ue,d as Ze,c as _e,a as p,b as Ae,e as Te,f as Le}from"./useUnexpectedErrorHandler-01ee037e.js";import{a as Lt,b as jt,c as Ot,d as Nt}from"./useCommitteeRequest-787b5c72.js";import{u as rt}from"./useStaffRequest-cb748c9e.js";import{F as Pe}from"./FormInput-19d746f6.js";import{F as ze}from"./FormQuillEditor-3e5c8bfd.js";import{F as Qe}from"./FormUpload-a6d2fc77.js";import{u as Me}from"./useQuery-f8736dfe.js";import{u as Ht,a as Kt,b as zt,c as Gt,d as Qt,v as Be,F as Ke,e as Yt,f as Wt,g as Zt,h as Je,i as Jt,j as Xt}from"./FormDynamicInput-2daa5165.js";import{a as es,b as ts,c as ss,d as os}from"./useMeetingRequest-eac1459b.js";import{_ as Ve}from"./FormDateTimeInput.vue_vue_type_style_index_0_lang-6e3ff0f9.js";import{F as as}from"./FormRadioInput-636b4964.js";import{a as ns,b as ls,c as is}from"./usePollRequest-97611322.js";import{a as ds,b as rs,c as cs}from"./useTaskRequest-3c5f3f5d.js";import"./index-a4206e89.js";import"./staff_routes-2c9640ed.js";import"./useQueryClient-99479e2d.js";import"./folder_routes-575ae698.js";const ge=i(R=>(je("data-v-ef402eee"),R=R(),Oe(),R),"_withScopeId$4"),us={key:0,class:"container-fluid"},ms={class:"row"},_s={class:"col-12"},ps={class:"card"},hs={class:"card-header d-flex justify-content-between"},vs=ge(()=>e("h2",{class:"card-header-title h3"},"Committee",-1)),bs={class:"ml-auto flex items-center space-x-2"},fs={class:"card-body"},gs={class:"row"},ys={class:"info-box shadow-lg p-4 mb-4 d-flex flex-column flex-grow-1"},xs={class:"d-flex flex-column flex-grow-1 align-items-center"},$s=["src"],ws={key:0,class:"ml-3 flex-1 w-100"},ks={class:"h2 mb-2"},Ms={key:0,class:"mb-1"},Cs={class:"text-gray-900 m-0"},Ss={key:1},Ts=ge(()=>e("br",null,null,-1)),Ps=["onClick"],qs=ge(()=>e("i",{class:"fa fa-plus mr-2"},null,-1)),Ds=["innerHTML"],Is={class:"d-flex justify-content-end mt-2 w-100"},Fs=["onClick"],Bs=ge(()=>e("i",{class:"fa fa-edit"},null,-1)),Es=[Bs],Us=["onClick"],As=ge(()=>e("i",{class:"fa fa-trash-alt"},null,-1)),Rs=[As],Vs=ge(()=>e("i",{class:"fa fa-eye"},null,-1)),Ls={class:"flex justify-center items-center min-h-screen"},js={method:"dialog",class:"modal-box rounded-xl relative bg-white shadow-xl"},Os={class:"font-bold text-lg text-center"},Ns=ge(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Hs={class:"overflow-auto p-4",style:{"max-height":"80vh"}},Ks={class:"grid grid-cols-1 md:grid-cols-2 gap-4 p-2"},zs={class:"col-span-2"},Gs={class:"flex flex-wrap -mx-2"},Qs={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Ys={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Ws=["src"],Zs={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Js=["src"],Xs={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},eo={class:"flex justify-center col-md-6"},to={method:"dialog",class:"modal-box rounded-xl"},so=ge(()=>e("h3",{class:"font-bold text-lg justify-center flex"},r("Add Members"),-1)),oo=ge(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),ao={class:"w-full mt-6 p-2"},no={class:"font-thin text-sm flex flex-col items-center gap-6"},lo={key:0,class:"message"},io=ge(()=>e("button",{type:"submit",class:"btn btn-md mb-1 w-full pt-1 text-red-600 mt-6 bg-primary"},r("Add Members"),-1)),ro={key:1,class:"container-fluid"},co=ge(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),uo=[co],mo=xe({__name:"Committees",setup(R){const y=Ce(),V=De();Ye();const x=v(!1),S=v("create"),b=V.params.boardId,B=v(""),q=v([]),E=v(null),k=v(null),w=v([]),j=Ue(),ee=Ze().test("fileOrString","Must be a file or a string",u=>u instanceof File||typeof u=="string"),U=_e({name:p().required("Name is required"),description:p().required("Description is required"),icon:ee.required("Icon is required"),cover:ee.required("Cover is required")}),{handleSubmit:f,setErrors:$,setFieldValue:G,values:te}=Ae({validationSchema:U,initialValues:{name:"",description:"",icon:"",cover:""}}),le=f(async u=>{var h,K;try{const d={name:u.name,description:u.description,icon:u.icon,cover:u.cover};S.value==="create"?await Lt(d,b):S.value==="edit"&&await jt(d,B.value),(h=E.value)==null||h.close(),(K=k.value)==null||K.close(),await g(),kt(),Mt(),Z(),x.value=!1}catch(d){d instanceof qe?$(d.messages):j(d)}}),he=i(async()=>{var u;try{const h={members:q.value};await Ot(h,b,B.value),(u=k.value)==null||u.close(),await g(),Z(),x.value=!1}catch(h){h instanceof qe?$(h.messages):j(h)}},"onSubmitMembers"),{errorMessage:D}=Te("members"),ie=i(u=>{var h;S.value="create",x.value=!0,(h=E.value)==null||h.showModal()},"openCreateModal"),M=i(u=>{var h;G("name",u.name),G("description",u.description),G("icon",u.icon),G("cover",u.cover),st(u.cover),tt(u.icon),B.value=u.id,S.value="edit",x.value=!0,(h=E.value)==null||h.showModal()},"openEditModal"),Z=i(()=>{G("name",""),G("description",""),G("icon",""),G("cover",""),S.value="create",x.value=!0,B.value=""},"resetForm"),ve=i((u,h)=>{var d;const K=u.members.map(T=>T.user.id.toString());q.value=K,S.value="members",B.value=u.id,x.value=!0,(d=k.value)==null||d.showModal()},"openEditMembersModal"),de=i(()=>{},"selectedUsers"),se=i(()=>{},"removeSelectedUsers"),me=J(()=>{var h;const u=[];return w.value&&((h=w.value)==null?void 0:h.length)>0&&w.value.reduce((K,d)=>(K.push({id:d.id,name:`${d.full_name}`}),K),u),u}),ae=i(async()=>{const u=await rt({paginate:"false"});w.value=u.data},"getUsers");ke(async()=>{window.dispatchEvent(new CustomEvent("updateTitle",{detail:"Committees"})),ae()});const be=i(()=>Me({queryKey:["getCommitteesKey"],queryFn:async()=>(await Nt(b,{paginate:"false"})).data}),"getCommittees"),{isLoading:re,data:ce,refetch:g}=be(),O=J(()=>S.value==="create"?"Create Committee":S.value==="edit"?"Edit Committee":"");return(u,h)=>{var T;const K=Ne("router-link"),d=Ne("Multiselect");return n(y).hasPermission(["view board"])?(t(),s("div",us,[e("div",ms,[e("div",_s,[e("div",ps,[e("div",hs,[vs,e("div",bs,[e("button",{class:"btn btn-primary btn-sm",onClick:h[0]||(h[0]=I(o=>ie(),["prevent"]))}," New Comittee ")])]),e("div",fs,[e("div",gs,[(t(!0),s(z,null,Y(n(ce),o=>(t(),s("div",{class:"col-md-4 col-12 d-flex",key:o.id},[e("div",ys,[e("div",xs,[e("img",{class:"img-circle elevation-2",src:n(dt)(o.icon),alt:"User Avatar",style:{width:"128px",height:"128px"}},null,8,$s),o.committeeable?(t(),s("div",ws,[e("h3",ks,[A(K,{to:{name:"CommitteeDetails",params:{committeeId:o.id,boardId:o.committeeable.details.id}},class:"badge badge-soft bg-primary text-wrap"},{default:we(()=>[N(r(o.name),1)]),_:2},1032,["to"])]),o.committeeable?(t(),s("h3",Ms,[N(" Board: "),A(K,{to:{name:"BoardDetails",params:{boardId:o.committeeable.details.id}},class:"badge badge-soft text-wrap"},{default:we(()=>[N(r(o.committeeable.details.name),1)]),_:2},1032,["to"])])):_("",!0),e("p",Cs," Owner: "+r(o.owner),1),o.members?(t(),s("div",Ss,[e("span",null,r(o.members.length)+" "+r(o.members.length===1?"Member":"Members"),1),Ts,n(y).hasPermission(["add member to committee"])?(t(),s("a",{key:0,href:"",onClick:I(l=>ve(o),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},[qs,N(" Members ")],8,Ps)):_("",!0)])):_("",!0),e("p",{class:"text-muted m-0 truncate",innerHTML:o.description},null,8,Ds)])):_("",!0)]),e("div",Is,[n(y).hasPermission(["edit committee"])?(t(),s("a",{key:0,href:"",onClick:I(l=>M(o),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out mr-2"},Es,8,Fs)):_("",!0),n(y).hasPermission(["delete committee"])?(t(),s("a",{key:1,href:"",onClick:I(l=>u.deleteCommittee(o),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out mr-2"},Rs,8,Us)):_("",!0),n(y).hasPermission(["view committee"])&&o.committeeable?(t(),ye(K,{key:2,to:{name:"CommitteeDetails",params:{committeeId:o.id,boardId:o.committeeable.details.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:we(()=>[Vs]),_:2},1032,["to"])):_("",!0)])])]))),128))])])])])]),e("div",Ls,[e("dialog",{id:"CommitteeModal",class:"modal w-full max-w-4xl mx-auto p-0",ref_key:"CommitteeModal",ref:E},[e("form",js,[e("h3",Os,r(O.value),1),Ns,e("div",Hs,[e("div",Ks,[e("div",zs,[e("form",{novalidate:"",onSubmit:h[3]||(h[3]=I((...o)=>n(le)&&n(le)(...o),["prevent"])),class:""},[e("div",Gs,[e("div",Qs,[A(Pe,{labeled:!0,label:"Name",name:"name",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter Name",type:"text"})]),e("div",Ys,[A(Qe,{labeled:!0,label:"Upload icon Image",name:"icon",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter icon Image",type:"file",accept:n(et).join(", "),onChange:h[1]||(h[1]=o=>n(Ct)(o))},null,8,["accept"]),e("img",{src:n(tt)((T=n(te))==null?void 0:T.icon),class:"file_attachment"},null,8,Ws)]),e("div",Zs,[A(Qe,{labeled:!0,label:"Upload Cover Image",name:"cover",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter Cover Image",type:"file",accept:n(et).join(", "),onChange:h[2]||(h[2]=o=>n(St)(o))},null,8,["accept"]),e("img",{src:n(st)(n(te).cover),class:"file_attachment"},null,8,Js)])]),A(ze,{label:"Description",name:"description",theme:"snow",placeholder:"Enter Description",toolbar:"full",contentType:"html",class:"col-span-3 mb-4"}),e("button",Xs,r(O.value),1)],32)])])])])],512)]),e("div",eo,[e("dialog",{id:"membersmodal",class:"modal",ref_key:"membersmodal",ref:k},[e("form",to,[so,oo,e("div",ao,[e("div",no,[e("form",{novalidate:"",onSubmit:I(he,["prevent"]),class:"w-full rounded-xl mx-auto p-1 custom-modal"},[e("div",{class:H(["multiselect-container",{error:!!n(D)}])},[A(d,{id:"members",modelValue:q.value,"onUpdate:modelValue":h[4]||(h[4]=o=>q.value=o),mode:"tags",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:me.value,valueProp:"id",trackBy:"id",label:"name",class:H(["multiselect-container",{error:!!n(D)}]),onSelect:h[5]||(h[5]=o=>de()),onDeselect:h[6]||(h[6]=o=>se())},null,8,["modelValue","options","class"]),n(D)?(t(),s("div",lo,r(n(D)),1)):_("",!0)],2),io],32)])])])],512)])])):(t(),s("div",ro,uo))}}});const _o=Ee(mo,[["__scopeId","data-v-ef402eee"]]),oe=i(R=>(je("data-v-455161d6"),R=R(),Oe(),R),"_withScopeId$3"),po={key:0},ho={class:"card"},vo={class:"card-header p-3"},bo={class:"row"},fo={class:"col-12"},go={class:"row"},yo={class:"col-lg-9 col-md-8 col-12 mt-2"},xo={"aria-label":"Breadcrumbs",class:"text-sm overflow-hidden"},$o={class:"breadcrumb mb-0 bg-warning"},wo=["onClick"],ko={class:"col-lg-3 col-md-4 col-12"},Mo={class:"row"},Co={class:"col-md-6 col-12 mt-2"},So={class:"dropdown"},To={class:"nav-link dropdown-toggle btn btn-secondary btn-block",href:"#",id:"navbarDropdown",type:"button",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},Po=oe(()=>e("span",{class:"text-warning mr-1"},"sort by:",-1)),qo={class:"dropdown-menu","aria-labelledby":"navbarDropdown"},Do=["onClick"],Io={class:"col-md-6 col-12 mt-2"},Fo={key:0,class:"dropdown"},Bo={key:0,class:"nav-link dropdown-toggle btn btn-primary btn-block",href:"#",id:"navbarDropdown",type:"button",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},Eo=oe(()=>e("i",{class:"fas fa-plus mr-2"},null,-1)),Uo={class:"dropdown-menu","aria-labelledby":"navbarDropdown"},Ao=oe(()=>e("i",{class:"fas fa-plus"},null,-1)),Ro=oe(()=>e("i",{class:"fas fa-file-upload"},null,-1)),Vo={key:0,class:"col-12 mt-3"},Lo={class:"input-group input-group-lg"},jo=oe(()=>e("div",{class:"input-group-append"},[e("button",{type:"submit",class:"btn btn-lg btn-default"},[e("i",{class:"fa fa-search"})])],-1)),Oo={class:"card-body py-0 px-4 min-h-[300px] relative -top-px z-10"},No={class:"table-responsive"},Ho={class:"table mb-0"},Ko={class:"w-28"},zo={key:0},Go=["onClick"],Qo=["src"],Yo={key:1},Wo=["src"],Zo={key:0},Jo={class:"font-weight-bold text-primary text-truncate"},Xo={class:"text-sm font-weight-bold text-primary"},ea=oe(()=>e("span",{class:"text-black"},"Folders",-1)),ta={class:"text-sm font-weight-bold text-primary"},sa=oe(()=>e("span",{class:"text-black"},"Files",-1)),oa={key:1},aa={key:0},na={class:"font-weight-bold text-primary text-truncate"},la={class:"text-sm font-weight-bold text-primary"},ia={class:"text-black"},da={class:"w-28"},ra={key:0},ca={class:"text-xs text-primary text-truncate"},ua={key:1},ma={key:0},_a={class:"text-xs text-primary text-truncate"},pa={class:"w-20 text-center"},ha={class:"flex justify-end space-x-2"},va={key:0},ba=["onClick"],fa=oe(()=>e("i",{class:"far fa-edit"},null,-1)),ga=[fa],ya={key:1},xa=["onClick"],$a=oe(()=>e("i",{class:"far fa-edit"},null,-1)),wa=[$a],ka=oe(()=>e("i",{class:"far fa-eye"},null,-1)),Ma={class:"flex justify-center col-md-6"},Ca={method:"dialog",class:"modal-box rounded-xl"},Sa={class:"font-bold text-lg justify-center flex"},Ta=oe(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Pa={class:"w-full mt-6 p-2"},qa={class:"font-thin text-sm flex flex-col items-center gap-6"},Da={class:"row"},Ia={key:0,class:"row mt-2 ml-2"},Fa={key:0,class:"row mt-2 ml-2"},Ba={class:"col-md-6"},Ea=["src"],Ua={class:"col-md-6"},Aa=oe(()=>e("strong",null,"File Name:",-1)),Ra={class:"text-bold text-primary"},Va=oe(()=>e("strong",null,"File Size:",-1)),La={class:"text-bold text-primary"},ja=oe(()=>e("strong",null,"Type:",-1)),Oa={class:"text-bold text-primary"},Na=oe(()=>e("strong",null,"Last Modified: ",-1)),Ha={class:"text-bold text-primary"},Ka={type:"submit",class:"btn btn-md mb-1 w-full pt-1 text-red-600 mt-6 bg-primary"},za={key:1},Ga=oe(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),Qa=[Ga],Ya=xe({__name:"Documents",setup(R){const y=Ce(),V=Ue(),x=De(),S=v("create"),b=v("folder"),B=v("name-asc"),q=v(""),E=v([]),k=x.params.boardId,w=v([{id:"1",name:"Folders"}]),j=v(null),ee=v(!1),U=v(null),f=v(null),$=[{id:"name-asc",name:"Name (A-Z)"},{id:"name-desc",name:"Name (Z-A)"},{id:"date-newest",name:"Newest to oldest"},{id:"date-oldest",name:"Oldest to newest"}];function G(o){B.value=o}i(G,"applySort");const te=J(()=>{const o=$.find(l=>l.id===B.value);return o?o.name:"Unknown"});function le(o){console.log("folder",o),w.value.push({id:o.id,name:o.name})}i(le,"addToNavigationPath");function he(o){const l=w.value.slice(0,o+1);if(l.length!==w.value.length){w.value=l;const m=D(w.value.at(-1).id,de.value);E.value=m?m.children||[]:[]}}i(he,"navigateTo");function D(o,l){if(!Array.isArray(l))return null;for(const m of l){if(m.id===o)return m;if(m.children&&Array.isArray(m.children)){const a=D(o,m.children);if(a)return a}}return null}i(D,"findFolderById");function ie(o){w.value.at(-1).id!==o.id&&(le(o),console.log("folder",o.children),E.value=o.children||[])}i(ie,"openFolder");function M(o){let l=0,m=0;return o.children&&o.children.length>0&&o.children.forEach(a=>{a.type==="folder"?l++:a.type==="file"&&m++}),{folderCount:l,fileCount:m}}i(M,"countChildrenTypes");const Z=i(()=>Me({queryKey:["getBoardFoldersKey",k],queryFn:async()=>(await Qt(k,{paginate:"false"})).data}),"getBoardFolders"),{isLoading:ve,data:de,refetch:se}=Z();ke(async()=>{await se()}),lt(de,o=>{var l;if(o&&o.length>0)if(w.value.length===1&&(o[0],w.value[0].id="1",w.value[0].name="Documents"),w.value.length===1)E.value=o;else{const m=D((l=w.value.at(-1))==null?void 0:l.id,o);E.value=m?m.children||[]:[]}},{immediate:!0});const me=J(()=>q.value?ae.value.filter(o=>o.name.toLowerCase().includes(q.value.toLowerCase())):ae.value),ae=J(()=>{const o=w.value.length>1?E.value:de.value;return Array.isArray(o)?[...o].sort((l,m)=>{switch(B.value){case"name-asc":return l.name.localeCompare(m.name);case"name-desc":return m.name.localeCompare(l.name);case"date-newest":return new Date(m.created_at).getTime()-new Date(l.created_at).getTime();case"date-oldest":return new Date(l.created_at).getTime()-new Date(m.created_at).getTime();default:return 0}}):[]}),be=_e({name:p().required(),meeting_id:p().required(),board_id:p().required(),folder_id:p().nullable(),parent_id:p(),type:p().oneOf(["folder","file"]).required(),fileupload:Ze().nullable()}),{handleSubmit:re,setErrors:ce,setFieldValue:g,values:O}=Ae({validationSchema:be,initialValues:{name:"",meeting_id:k,board_id:k,folder_id:null,parent_id:"",type:"",fileupload:null}}),u=i(o=>{var a;const l=o.target;if(!((a=l.files)!=null&&a.length))return;const m=l.files[0];g("name",m.name),g("type","file")},"updateName"),h=i(o=>{var m;T(),S.value="create",b.value=o,ee.value=!0,(m=f.value)==null||m.showModal(),g("type",o);const l=w.value.at(-1);g("parent_id",l.id),console.log("parent",l)},"openCreateFolderModal"),K=re(async(o,{resetForm:l})=>{var m;try{if(S.value==="create")if(b.value==="folder"){const a={children:[],created_at:null,icon:null,id:null,meeting_id:o.meeting_id,board_id:o.board_id,folder_id:null,name:o.name,parent_id:o.parent_id.toString(),type:o.type,fileupload:null,media:[]};await Ht(a,k)}else{const a={children:[],created_at:null,icon:null,id:null,meeting_id:o.meeting_id,board_id:o.board_id,folder_id:null,name:o.name,parent_id:o.parent_id.toString(),type:o.type,fileupload:o.fileupload,media:[]};await Kt(a,k)}else if(b.value==="folder"){const a={children:[],created_at:null,folder_id:null,icon:null,id:null,meeting_id:o.meeting_id,board_id:o.board_id,name:o.name,parent_id:o.parent_id.toString(),type:o.type,fileupload:null,media:[]},F=U.value?U.value.toString():null;a.folder_id=F,await zt(a,k,a.folder_id)}else{const a={children:[],created_at:null,folder_id:null,icon:null,id:null,meeting_id:o.meeting_id,board_id:o.board_id,name:o.name,parent_id:o.parent_id.toString(),type:o.type,fileupload:o.fileupload,media:[]},F=U.value?U.value.toString():null;a.folder_id=F,await Gt(a,k,a.folder_id)}await se(),T(),(m=f.value)==null||m.close()}catch(a){a instanceof qe?ce(a.messages):V(a)}}),d=i((o,l)=>{var m;T(),j.value=o,U.value=o.id.toString(),S.value="edit",b.value=l,ee.value=!0,g("name",o.name),g("folder_id",o.id),g("type",l),l==="file"&&(g("fileupload",o.name),Bt(o.media[0])),g("parent_id",o.id),console.log("folder.media",o.name),(m=f.value)==null||m.showModal()},"openEditFolderModal"),T=i(()=>{g("name",""),g("folder_id",null),g("fileupload",""),g("parent_id",""),g("type",""),b.value="folder",S.value="create",ee.value=!1,j.value=null,U.value=null,Tt()},"resetFolder");return(o,l)=>{const m=Ne("router-link");return n(y).hasPermission(["view folders"])?(t(),s("div",po,[e("div",ho,[e("div",vo,[e("div",bo,[e("div",fo,[e("div",go,[e("div",yo,[e("nav",xo,[e("ol",$o,[(t(!0),s(z,null,Y(w.value,(a,F)=>(t(),s("li",{key:a.id,class:"breadcrumb-item"},[e("a",{href:"#",class:"text-gray-800 font-medium",onClick:I(C=>he(F),["prevent"])},r(a.name),9,wo)]))),128))])])]),e("div",ko,[e("div",Mo,[e("div",Co,[e("div",So,[e("button",To,[Po,N(r(te.value),1)]),e("div",qo,[(t(),s(z,null,Y($,a=>e("a",{key:a.id,href:"#",class:"dropdown-item",onClick:I(F=>G(a.id),["prevent"])},r(a.name),9,Do)),64))])])]),e("div",Io,[w.value.length>1?(t(),s("div",Fo,[n(y).hasPermission(["create folders","upload documents","create dropzone"])?(t(),s("button",Bo,[Eo,N(" New ")])):_("",!0),e("div",Uo,[n(y).hasPermission(["create folders","create dropzone"])?(t(),s("a",{key:0,href:"#",onClick:l[0]||(l[0]=I(a=>h("folder"),["prevent"])),class:"dropdown-item"},[Ao,N(" New folder ")])):_("",!0),n(y).hasPermission(["upload documents"])?(t(),s("a",{key:1,href:"#",onClick:l[1]||(l[1]=I(a=>h("file"),["prevent"])),class:"dropdown-item"},[Ro,N(" Upload a file ")])):_("",!0)])])):_("",!0)])])])])]),n(y).hasPermission(["search documents"])?(t(),s("div",Vo,[e("div",Lo,[bt(e("input",{type:"search",class:"form-control form-control-lg",placeholder:"Type your keywords here","onUpdate:modelValue":l[2]||(l[2]=a=>q.value=a)},null,512),[[ft,q.value]]),jo])])):_("",!0)])]),e("div",Oo,[e("div",No,[e("table",Ho,[e("tbody",null,[(t(!0),s(z,null,Y(me.value,a=>{var F,C,ne,W;return t(),s("tr",{key:a.id,class:"group bg-white hover:bg-gray-100 cursor-pointer"},[e("td",Ko,[a.type==="folder"?(t(),s("div",zo,[e("div",{onClick:I(ue=>ie(a),["prevent"])},[e("img",{src:n(Pt)(a.icon),class:"img-fluid",alt:"Folder Icon"},null,8,Qo)],8,Go)])):(t(),s("div",Yo,[n(y).hasPermission(["view documents"])?(t(),ye(m,{key:0,to:{name:"BoardMediaDetails",params:{boardId:n(k),folderId:a.id,mediaId:(F=a==null?void 0:a.media[0])==null?void 0:F.uuid}},class:"d-block text-success hover:text-green-700 transition ease-in-out"},{default:we(()=>{var ue;return[e("img",{src:n(qt)((ue=a==null?void 0:a.media[0])==null?void 0:ue.mime_type),class:"img-fluid",alt:"File Icon"},null,8,Wo)]}),_:2},1032,["to"])):_("",!0)]))]),e("td",null,[a.type==="folder"?(t(),s("div",Zo,[e("p",Jo,r(a.name),1),e("p",Xo,[N(r(M(a).folderCount)+": ",1),ea]),e("p",ta,[N(r(M(a).fileCount)+": ",1),sa])])):(t(),s("div",oa,[n(y).hasPermission(["view documents"])?(t(),s("div",aa,[e("p",na,r((C=a==null?void 0:a.media[0])==null?void 0:C.file_name),1),e("p",la,[N(" Size: "),e("span",ia,r(n(ot)((ne=a==null?void 0:a.media[0])==null?void 0:ne.size)),1)])])):_("",!0)]))]),e("td",da,[a.type==="folder"?(t(),s("div",ra,[e("p",ca,r(n(He)(a.created_at,"")),1)])):(t(),s("div",ua,[n(y).hasPermission(["view documents"])?(t(),s("div",ma,[e("p",_a,r(n(He)(a.created_at,"")),1)])):_("",!0)]))]),e("td",pa,[e("div",ha,[a.type==="folder"?(t(),s("div",va,[n(y).hasPermission(["edit folders"])?(t(),s("a",{key:0,href:"#",onClick:I(ue=>d(a,"folder"),["prevent"]),class:"text-warning hover:text-blue-700 transition ease-in-out"},ga,8,ba)):_("",!0)])):(t(),s("div",ya,[n(y).hasPermission(["edit documents"])?(t(),s("a",{key:0,href:"#",onClick:I(ue=>d(a,"file"),["prevent"]),class:"text-warning hover:text-blue-700 transition ease-in-out"},wa,8,xa)):_("",!0),n(y).hasPermission(["view documents"])&&a.type==="file"?(t(),ye(m,{key:1,to:{name:"BoardMediaDetails",params:{boardId:n(k),folderId:a.id,mediaId:(W=a==null?void 0:a.media[0])==null?void 0:W.uuid}},class:"text-success hover:text-green-700 transition ease-in-out"},{default:we(()=>[ka]),_:2},1032,["to"])):_("",!0)]))])])])}),128))])])])])]),e("div",Ma,[e("dialog",{id:"foldermodal",class:"modal",ref_key:"FolderModal",ref:f},[e("form",Ca,[e("h3",Sa,r(S.value==="create"?b.value==="folder"?"Create Folder":"Upload File":b.value==="folder"?"Update Folder":"Update File"),1),Ta,e("div",Pa,[e("div",qa,[e("form",{novalidate:"",onSubmit:l[4]||(l[4]=I((...a)=>n(K)&&n(K)(...a),["prevent"])),class:"w-full rounded-xl mx-auto p-1 custom-modal"},[e("div",Da,[A(Pe,{labeled:!0,label:b.value==="folder"?"Folder name":"Upload File name",name:"name",class:"col-md-12 w-full text-sm text-white tracking-wide",placeholder:b.value==="folder"?"Folder name":"Upload File name",type:"text"},null,8,["label","placeholder"]),b.value==="file"?(t(),s("div",Ia,[A(Qe,{labeled:!0,label:"Upload Cover Image for the Board",name:"fileupload",class:"w-full text-sm text-white tracking-wide col-md-12",placeholder:"Enter Cover Image of the Board",type:"file",accept:n(Dt).join(", "),onChange:l[3]||(l[3]=a=>{n(It)(a),u(a)})},null,8,["accept"]),n(O).fileupload?(t(),s("div",Fa,[e("div",Ba,[n(Fe).previewUrl?(t(),s("img",{key:0,src:n(Fe).previewUrl,alt:"File Preview",class:"file_attachment"},null,8,Ea)):_("",!0)]),e("div",Ua,[e("p",null,[Aa,e("span",Ra,r(n(Fe).name),1)]),e("p",null,[Va,e("span",La,r(n(ot)(n(Fe).size)),1)]),e("p",null,[ja,e("span",Oa,r(n(Fe).type),1)]),e("p",null,[Na,e("span",Ha,r(n(Ft)(n(Fe).lastModifiedDate)),1)])])])):_("",!0)])):_("",!0)]),e("button",Ka,r(S.value==="create"?b.value==="folder"?"Create Folder":"Upload File":b.value==="folder"?"Update Folder":"Update File"),1)],32)])])])],512)])])):(t(),s("div",za,Qa))}}});const Wa=Ee(Ya,[["__scopeId","data-v-455161d6"]]),Ie=i(R=>(je("data-v-c4e9a860"),R=R(),Oe(),R),"_withScopeId$2"),Za={class:"row"},Ja={class:"col-md-12"},Xa={class:"card card-widget"},en={class:"card-header"},tn=Ie(()=>e("h1",{class:"h2 mb-2 lg:mb-0"},"Meetings",-1)),sn={class:"card-tools"},on=Ie(()=>e("i",{class:"far fa fa-plus mr-2"},null,-1)),an=[on],nn={key:0,class:"card-body"},ln={key:0,class:"products-list product-list-in-card pl-2 pr-2"},dn={class:"product-img meeting-custom-size mr-2"},rn={key:0,class:"calendar-icon w-full flex flex-col items-center justify-center mt-1 calendaheight"},cn={class:"month customonth"},un={class:"day font-medium customday"},mn={class:"year font-medium customyear"},_n=Ie(()=>e("div",null,[e("span",{class:"text-danger font-bold ml-2 mr-2"}," Upcoming ")],-1)),pn={class:"product-info"},hn={class:"text-primary text-bold"},vn={key:0,class:"badge float-right bg-white"},bn=["onClick"],fn={class:"badge float-right bg-white"},gn=Ie(()=>e("i",{class:"far fa-eye"},null,-1)),yn={class:"badge float-right bg-white"},xn=["onClick"],$n=Ie(()=>e("i",{class:"far fa-edit"},null,-1)),wn=[$n],kn={key:1,class:"product-description"},Mn=["innerHTML"],Cn={key:2,class:"row border-top border-bottom border-warning d-flex justify-content-between align-items-center bg-warning"},Sn={class:"text-primary bg-primary font-bold ml-2 mr-2"},Tn={class:"text-primary font-bold ml-2 mr-2"},Pn={key:0},qn=["onClick"],Dn={key:3,class:"text-bold text-red"},In={key:4,class:"text-bold text-red"},Fn={class:"text-primary font-bold ml-2 mr-2"},Bn={class:"text-primary font-bold ml-2 mr-2"},En=["onClick"],Un=Ie(()=>e("i",{class:"far fa-eye"},null,-1)),An={key:1},Rn={class:"flex justify-center col-md-6"},Vn={method:"dialog",class:"modal-box rounded-xl"},Ln={class:"font-bold text-lg justify-center flex"},jn=Ie(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),On={class:"grid grid-cols-3 md:grid-cols-3 gap-2 p-2"},Nn={class:"col-span-3"},Hn={key:0,class:"flex flex-wrap -mx-2 mt-2"},Kn={class:"w-full md:w-1/2 px-1 md:px-2"},zn={class:"w-full md:w-1/2 px-1 md:px-2"},Gn={key:1,class:"flex flex-wrap -mx-2 mt-2"},Qn={class:"w-full md:w-1/2 px-1 md:px-2"},Yn={key:2,class:"flex flex-wrap -mx-2 mt-2"},Wn={key:3,class:"flex flex-wrap -mx-2 mt-2"},Zn={class:"w-full md:w-1/3 px-1 md:px-2"},Jn={class:"w-full md:w-1/3 px-1 md:px-2"},Xn={class:"w-full md:w-1/3 px-1 md:px-2"},el=["onClick"],tl={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},sl=xe({__name:"HomeDashboard",setup(R){const y=Ce(),V=v(!1),x=v("create"),S=v(null),b=v(null);v(null);const B=Ue();v(1),v(15),v();const E=De().params.boardId,k=v(""),w=_e({id:p().required(),date:p().required(),start_time:p().required(),end_time:p().required(),status:p().nullable(),heldstatus:p().nullable(),meeting_id:p().nullable()}),j=_e({title:p().required(),conference:p().required(),location:p().required(),link:p().nullable(),description:p().required(),status:p().required(),board_id:p().required(),type:p().required(),schedules:Le().of(w).required()}),{handleSubmit:ee,setErrors:U,setFieldValue:f,values:$}=Ae({validationSchema:j,initialValues:{title:"",conference:"",location:"",description:"",link:null,board_id:E,status:"unpublished",type:"single",schedules:[{id:Be(),date:"",start_time:"",end_time:"",status:null,heldstatus:null,meeting_id:null}]}}),G=i(()=>{var d;se(),x.value="create",V.value=!0,(d=b.value)==null||d.showModal()},"openCreateMeetingModal"),te=i(d=>{var o;se(),S.value=d,f("title",d.title),f("conference",d.conference),f("location",d.location),f("description",d.description),f("type",d.type),f("status",d.status),f("schedules",d.schedules);const T={id:d.nearestSchedule.id,date:d.nearestSchedule.date,start_time:d.nearestSchedule.start_time,end_time:d.nearestSchedule.end_time,status:d.nearestSchedule.status,heldstatus:d.nearestSchedule.heldstatus,meeting_id:d.nearestSchedule.meeting_id};f("schedules",[...$.schedules,T]),d.conference==="Custom 3rd party Links"&&(ie(d.conference),f("link",d.link)),console.log("values",$),x.value="edit",V.value=!0,(o=b.value)==null||o.showModal()},"openEditMeetingModal"),le=i((d,T)=>{var l;se(),se(),S.value=d,f("title",d.title),f("conference",d.conference),f("location",d.location),f("description",d.description),f("type",d.type),f("status",d.status),f("schedules",d.schedules);const o={id:T.id,date:T.date,start_time:T.start_time,end_time:T.end_time,status:T.status,heldstatus:T.heldstatus,meeting_id:T.meeting_id};f("schedules",[o]),d.conference==="Custom 3rd party Links"&&(ie(d.conference),f("link",d.link)),console.log("values",$),x.value="edit",V.value=!0,(l=b.value)==null||l.showModal()},"openEditScheduleMeetingModal"),he=[{name:"In Person",value:"No Vedio (Meeting in Person)"},{name:"3rd party",value:"Custom 3rd party Links"}],D=[{name:"Single",value:"single"},{name:"Find Date",value:"manual"}],ie=i(d=>{k.value=d},"handleConferenceTypeChange");ke(async()=>{}),J(()=>ve);const M=J(()=>he),Z=J(()=>D),ve=i(()=>Me({queryKey:["getBoardMeetingsKey"],queryFn:async()=>(await es(E,{paginate:"false"})).data}),"getMeetings"),de=ee(async d=>{var T,o,l;console.log("values",d),console.log("setErrors",U);try{x.value==="create"?await ts(d):(T=S.value)!=null&&T.id&&await ss(d,(o=S.value)==null?void 0:o.id),await ce(),se(),V.value=!1,(l=b.value)==null||l.close()}catch(m){m instanceof qe?U(m.messages):B(m)}});function se(){f("title",""),f("conference",""),f("location",""),f("description",""),f("link",null),f("type","single"),f("status","unpublished"),f("schedules",[{id:Be(),date:"",start_time:"",end_time:"",status:null,heldstatus:null,meeting_id:null}])}i(se,"reseting");const me=i(()=>{Array.isArray($.schedules)||(console.error("Invalid state: values.schedules is not an array."),f("schedules",[]));const d={id:Be(),date:"",start_time:"",end_time:"",status:null,heldstatus:null,meeting_id:null};f("schedules",[...$.schedules,d])},"addEmptySchedule"),ae=i(d=>{if($.schedules.length===1){gt({title:"Error",text:"You need at least one date to schedule.",type:"error"});return}const T=$.schedules.filter((o,l)=>l!==d);f("schedules",T)},"removeSchedule"),{isLoading:be,data:re,refetch:ce}=ve(),g=v("published"),O=J(()=>{if(!re.value)return[];const d=new Date;return re.value.filter(o=>g.value==="past"?new Date(o.created_at)<d:o.status.toLowerCase()===g.value).map(o=>{if(o.schedules&&o.schedules.length>0){const l=[...o.schedules].sort((C,ne)=>{const W=new Date(C.date.split("-").reverse().join("-")),ue=new Date(ne.date.split("-").reverse().join("-"));return W.getTime()-ue.getTime()});let m=l[0],a=1/0;return l.forEach(C=>{const W=new Date(C.date.split("-").reverse().join("-")).getTime()-d.getTime();Math.abs(W)<Math.abs(a)&&(a=W,m=C)}),{...o,nearestSchedule:m,schedules:l.filter(C=>C.id!==m.id)}}else return o})}),u=i(d=>{g.value=d},"filterMeetings"),h=i(d=>{switch(d){case"scheduled":return"text-primary";case"held":return"text-success";case"cancelled":return"text-danger";case"postponed":return"text-warning";default:return""}},"getHeldStatusClass"),K=i(async d=>{await os(d),await ce()},"onPublish");return(d,T)=>{const o=Ne("router-link");return t(),s(z,null,[e("div",Za,[e("div",Ja,[e("div",Xa,[e("div",en,[tn,e("div",sn,[e("button",{type:"button",class:H(["btn btn-tool",{"btn-info":g.value==="published"}]),onClick:T[0]||(T[0]=l=>u("published"))}," Published ",2),e("button",{type:"button",class:H(["btn btn-tool",{"btn-info":g.value==="unpublished"}]),onClick:T[1]||(T[1]=l=>u("unpublished"))}," UnPublished ",2),e("button",{type:"button",class:H(["btn btn-tool",{"btn-info":g.value==="past"}]),onClick:T[2]||(T[2]=l=>u("past"))}," Past ",2),n(y).hasPermission(["create meeting"])?(t(),s("button",{key:0,type:"button",onClick:I(G,["prevent"]),class:"btn btn-tool"},an)):_("",!0)])]),n(y).hasPermission(["view meeting"])?(t(),s("div",nn,[O.value.length>0?(t(),s("ul",ln,[(t(!0),s(z,null,Y(O.value,l=>(t(),s("li",{class:"item",key:l.id},[e("div",dn,[l!=null&&l.nearestSchedule?(t(),s("div",rn,[e("div",cn,r(n(Et)(l.nearestSchedule.date)),1),e("div",un,[e("span",null,r(n(Ut)(l.nearestSchedule.date)),1)]),e("div",mn,[e("span",null,r(n(At)(l.nearestSchedule.date)),1)])])):_("",!0),_n]),e("div",pn,[n(y).hasPermission(["view meeting"])?(t(),ye(o,{key:0,to:{name:"BoardMeetingDetails",params:{boardId:n(E),meetingId:l.id,scheduleId:l.nearestSchedule.id}},class:"product-title"},{default:we(()=>[N(" Meeting: "),e("span",hn,r(l.title),1),g.value==="unpublished"?(t(),s("span",vn,[n(y).hasPermission(["publish meeting"])?(t(),s("a",{key:0,href:"",onClick:I(m=>K(l.id),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"}," Publish ",8,bn)):_("",!0)])):_("",!0),e("span",fn,[n(y).hasPermission(["view meeting"])?(t(),ye(o,{key:0,to:{name:"BoardMeetingDetails",params:{boardId:n(E),meetingId:l.id,scheduleId:l.nearestSchedule.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:we(()=>[gn]),_:2},1032,["to"])):_("",!0)]),e("span",yn,[n(y).hasPermission(["edit meeting"])?(t(),s("a",{key:0,href:"",onClick:I(m=>te(l),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},wn,8,xn)):_("",!0)])]),_:2},1032,["to"])):_("",!0),n(y).hasPermission(["edit meeting"])?(t(),s("span",kn,[N(" Description: "),e("span",{class:"text-primary text-bold",innerHTML:l.description},null,8,Mn)])):_("",!0),l!=null&&l.nearestSchedule?(t(),s("div",Cn,[e("div",null,[e("span",Sn," Upcoming "+r(n(at)(l.nearestSchedule.date)),1),N(" || When: "),e("span",Tn,r(n(nt)(l.nearestSchedule.date)),1),N(" || Held Status: "),e("span",{class:H([h(l.nearestSchedule.heldstatus),"font-bold ml-2 mr-2"])},r(l.nearestSchedule.heldstatus),3)]),l!=null&&l.nearestSchedule?(t(),s("span",Pn,[l.nearestSchedule.heldstatus==="scheduled"?(t(),s("button",{key:0,class:"btn btn-sm btn-warning font-bold ml-2 mr-2 mt-1 mb-1",onClick:I(m=>le(l,l.nearestSchedule),["prevent"])}," Postpone ",8,qn)):_("",!0)])):_("",!0)])):_("",!0),l.schedules.length?(t(),s("div",Dn,"Other Schedules")):(t(),s("div",In,"no Other Recuring Schdedules")),(t(!0),s(z,null,Y(l.schedules,m=>(t(),s("div",{class:H(["row","border-top","border-bottom","border-warning","d-flex","justify-content-between","align-items-center",n(Rt)(m.date)?"bg-gray":""]),key:m.id},[e("div",null,[N(" Day: "),e("span",Fn,r(n(at)(m.date)),1),N(" || When: "),e("span",Bn,r(n(nt)(m.date)),1),N(" || Held Status: "),e("span",{class:H([h(m.heldstatus),"font-bold ml-2 mr-2"])},r(m.heldstatus),3)]),e("span",null,[m.heldstatus==="scheduled"&&n(y).hasPermission(["edit meeting"])?(t(),s("button",{key:0,class:"btn btn-sm btn-warning font-bold ml-2 mr-2 mt-1 mb-1",onClick:I(a=>le(l,m),["prevent"])}," Postpone ",8,En)):_("",!0),n(y).hasPermission(["view meeting"])?(t(),ye(o,{key:1,to:{name:"BoardMeetingDetails",params:{boardId:n(E),meetingId:l.id,scheduleId:m.id}},class:"mr-2 hover:text-info transition duration-150 ease-in-out"},{default:we(()=>[Un]),_:2},1032,["to"])):_("",!0)])],2))),128))])]))),128))])):(t(),s("div",An," No meetings found for "+r(g.value),1))])):_("",!0)])])]),e("div",Rn,[e("dialog",{id:"meetingmodal",class:"modal",ref_key:"MeetingModal",ref:b},[e("form",Vn,[e("h3",Ln,r(x.value=="create"?"Create Meeting":"Edit Meeting"),1),jn,e("div",{class:"overflow-auto p-4",style:it([{"max-height":"80vh"},x.value=="schedule"?"height:500px;":""])},[e("div",On,[e("div",Nn,[e("form",{novalidate:"",onSubmit:T[3]||(T[3]=I((...l)=>n(de)&&n(de)(...l),["prevent"])),class:""},[x.value=="create"||x.value=="edit"?(t(),s("div",Hn,[e("div",Kn,[A(Pe,{labeled:!0,label:"Meeting Title",name:"title",placeholder:"Enter Meeting Title",type:"text"})]),e("div",zn,[A(Ke,{labeled:!0,name:"conference",label:"Select Meeting Type",placeholder:"Select Meeting Type",options:M.value,onSelectedItem:ie},null,8,["options"])])])):_("",!0),x.value=="create"||x.value=="edit"?(t(),s("div",Gn,[e("div",Qn,[k.value==="Custom 3rd party Links"?(t(),ye(Pe,{key:0,labeled:!0,label:"Meeting Link",name:"link",placeholder:"Enter Third Party Link",type:"text"})):_("",!0)]),e("div",{class:H(["w-full px-1 md:px-2",k.value==="Custom 3rd party Links"?"md:w-1/2":""])},[A(Pe,{labeled:!0,label:"Meeting Location",name:"location",placeholder:"e.g 'Conference Room 6'",type:"text"})],2)])):_("",!0),x.value=="create"||x.value=="edit"?(t(),s("div",Yn,[x.value=="create"||x.value=="edit"?(t(),ye(ze,{key:0,label:"Meeting Description",name:"description",theme:"snow",placeholder:"Enter Meeting Description",toolbar:"full",contentType:"html",class:"col-span-3"})):_("",!0)])):_("",!0),x.value=="create"||x.value=="edit"?(t(),s("div",Wn,[A(as,{name:"type",label:"Meeting Schedule Type",placeholder:"Select Meeting Schedule Type",inline:!0,options:Z.value,checked:n($).type},null,8,["options","checked"])])):_("",!0),n($).schedules?(t(!0),s(z,{key:4},Y(n($).schedules,(l,m)=>(t(),s("div",{class:"flex flex-wrap -mx-2 mt-2 relative",key:m},[e("div",Zn,[A(Ve,{label:"Meeting Date "+(m+1),name:"schedules["+m+"].date",mode:"date-picker",modeltype:"dd-MM-yyyy",enabletimepicker:!1,placeholder:"Meeting Date"},null,8,["label","name"])]),e("div",Jn,[A(Ve,{label:"Meeting Start Time "+(m+1),name:"schedules["+m+"].start_time",mode:"time-picker",modeltype:"h:mm bbbb",is24:!1,enabletimepicker:!0,placeholder:"Select Start Time"},null,8,["label","name"])]),e("div",Xn,[A(Ve,{label:"Meeting End Time "+(m+1),name:"schedules["+m+"].end_time",mode:"time-picker",modeltype:"h:mm bbbb",is24:!1,enabletimepicker:!0,placeholder:"Select End Time"},null,8,["label","name"])]),x.value!=="schedule"?(t(),s("button",{key:0,type:"button",class:"absolute top-0 right-0 mt-2 mr-2 text-red-600 font-bold",onClick:I(a=>ae(m),["prevent"])}," ✕ ",8,el)):_("",!0)]))),128)):_("",!0),n($).type==="manual"&&x.value!=="schedule"?(t(),s("button",{key:5,type:"button",class:"btn btn-primary mt-4",onClick:me}," Add Another Data ")):_("",!0),e("button",tl,r(x.value==="create"?"Create Meeting":"Edit Meeting"),1)],32)])])],4)])],512)])],64)}}});const ol=Ee(sl,[["__scopeId","data-v-c4e9a860"]]),al={class:"role-container w-100 d-flex justify-content-center"},nl=["aria-expanded"],ll={key:0,class:"dropdown-menu show justify-content","aria-labelledby":"role-status"},il=["onClick"],dl={key:1,class:"text-center"},rl=xe({__name:"MemberPosition",props:{member:{},positions:{},disableRemotePosition:{}},emits:["position-updated"],setup(R,{emit:y}){const V=R,x=y,S=v(null),b=v(!1),B=i(j=>{j.stopPropagation(),b.value=!b.value},"toggleDropdown"),q=i(j=>{x("position-updated",{memberId:V.member.id,positionId:j.id}),b.value=!1},"updateRole"),E=J(()=>{var j;return`bg-${(j=V.member)==null?void 0:j.position.name.toLowerCase()} text-white`}),k=J(()=>{var j;return(j=V.member)==null?void 0:j.position.name}),w=J(()=>V.positions);return(j,ee)=>{var U,f,$,G;return t(),s("div",al,[k.value?(t(),s("div",{key:0,class:"dropdown",ref_key:"dropdownRef",ref:S},[e("button",{class:H(["btn btn-primary dropdown-toggle text-truncate w-100",E.value]),type:"button",onClick:B,"aria-haspopup":"true","aria-expanded":b.value},[e("i",{class:H(["mr-2 fa "+((U=V.member)==null?void 0:U.position.icon),"mr-2"])},null,2),N(" "+r((f=V.member)==null?void 0:f.position.name),1)],10,nl),b.value?(t(),s("ul",ll,[(t(!0),s(z,null,Y(w.value,te=>(t(),s("li",{key:te.name},[e("a",{href:"#",class:"dropdown-item",onClick:I(le=>q(te),["prevent"])},[e("i",{class:H(["mr-2 fa "+te.icon,"mr-2"])},null,2),N(" "+r(te.name),1)],8,il)]))),128))])):_("",!0)],512)):(t(),s("div",dl,[e("i",{class:H(["mr-2 fa "+(($=V.member)==null?void 0:$.position.icon),"mr-2"])},null,2),N(" "+r((G=V.member)==null?void 0:G.position.name),1)]))])}}});const cl=Ee(rl,[["__scopeId","data-v-c85c72a2"]]),Se=i(R=>(je("data-v-afd0c974"),R=R(),Oe(),R),"_withScopeId$1"),ul={class:"card"},ml={class:"card-header flex items-center"},_l=Se(()=>e("h2",{class:"card-header-title h3"},"Board Members",-1)),pl={class:"ml-auto flex items-center space-x-2"},hl={class:"container-fluid"},vl={class:"row"},bl={class:"card card-outline card-primary h-100"},fl={class:"card-body box-profile"},gl={class:"text-center"},yl={class:"profile-username text-center text-primary"},xl=["onClick"],$l=["onClick"],wl=Se(()=>e("i",{class:"far fa-eye"},null,-1)),kl=[wl],Ml={class:"text-muted text-center text-bold"},Cl={key:0,class:"mt-3"},Sl=Se(()=>e("div",{class:"text-bold text-danger text-center mb-1"}," Position ",-1)),Tl={class:"text-center"},Pl={key:1,class:"mt-3"},ql=Se(()=>e("div",{class:"text-bold text-danger text-center mb-1"}," Position ",-1)),Dl={class:"text-center"},Il={class:"mt-3"},Fl=Se(()=>e("div",{class:"text-bold text-danger text-center mb-1"}," Last Updated ",-1)),Bl={class:"text-center text-primary text-small"},El={class:"flex justify-center col-md-6"},Ul={method:"dialog",class:"modal-box rounded-xl"},Al=Se(()=>e("h3",{class:"font-bold text-lg justify-center flex"},r("Add Members"),-1)),Rl=Se(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Vl={class:"w-full mt-6 p-2"},Ll={class:"font-thin text-sm flex flex-col items-center gap-6"},jl={key:0,class:"message"},Ol=Se(()=>e("button",{type:"submit",class:"btn btn-md mb-1 w-full pt-1 text-red-600 mt-6 bg-primary"},r("Add Members"),-1)),Nl=xe({__name:"Members",setup(R){const y=Ce(),V=De(),x=Ye(),S=Ue(),b=v("create"),B=V.params.boardId,q=v(!1),E=v(null),k=v([]),w=v([]),{errorMessage:j}=Te("assignees"),ee=_e({id:p().nullable(),position_id:p().nullable(),board_id:Ze().required(),members:Le().of(p()).nullable()}),{handleSubmit:U,setErrors:f,setFieldValue:$,values:G}=Ae({validationSchema:ee,initialValues:{id:"",position_id:"",board_id:B,members:[]}}),te=i(()=>{$("members",k.value)},"selectedUsers"),le=i(()=>{$("members",k.value)},"removeselectedUsers"),he=i(g=>{var u;const O=g.members.map(h=>h.user.id.toString());k.value=O,$("members",k.value),b.value="edit",q.value=!0,(u=E.value)==null||u.showModal()},"openEditMembersModal"),D=U(async(g,{resetForm:O})=>{var u;try{$("members",k.value);const h={board_id:g.board_id,members:g.members};if(b.value==="create")await Yt(h,B);else if(b.value==="edit")await Wt(h,B);else if(b.value==="position"){const K={id:g.id,position_id:g.position_id};await Zt(K,B)}await me(),ie(),(u=E.value)==null||u.close()}catch(h){h instanceof qe?f(h.messages):S(h)}}),ie=i(()=>{b.value="create",q.value=!1,k.value=[],$("members",[]),$("position_id","")},"reset"),M=J(()=>{var O;const g=[];return w.value&&((O=w.value)==null?void 0:O.length)>0&&w.value.reduce((u,h)=>(u.push({id:h.id,name:`${h.full_name}`}),u),g),g}),Z=i(async()=>{const g=await rt({paginate:"false"});w.value=g.data},"getUsers");ke(async()=>{window.dispatchEvent(new CustomEvent("updateTitle",{detail:"Members"})),Z()});const ve=i(()=>Me({queryKey:["getBoardMembersKey",B],queryFn:async()=>(await Je(B,{paginate:"false"})).data}),"getBoardMembers"),{isLoading:de,data:se,refetch:me}=ve(),ae=v([]),be=i(async()=>{const g=await Jt({paginate:"false"});ae.value=g.data},"getPositions");ke(async()=>{await be()});const re=i(g=>{ie(),b.value="position",$("id",g.memberId),$("position_id",g.positionId),D()},"handlePositionUpdated"),ce=i(g=>{x.push({name:"ProfileDetails",params:{userId:g.id,profileId:g.profile.id}})},"openUserProfile");return(g,O)=>(t(),s(z,null,[e("div",ul,[e("div",ml,[_l,e("div",pl,[e("button",{class:"btn btn-secondary btn-sm",onClick:O[0]||(O[0]=I(u=>he({members:n(se)}),["prevent"]))}," Update Members ")])]),e("div",hl,[e("div",vl,[(t(!0),s(z,null,Y(n(se),(u,h)=>(t(),s("div",{class:"col-lg-3 col-md-4 col-sm-6 mb-3",key:h},[e("div",bl,[e("div",fl,[e("div",gl,[e("h3",yl,[e("a",{href:"",onClick:I(K=>{var d,T;return((T=(d=n(y))==null?void 0:d.user)==null?void 0:T.id)===u.user.id?ce(u.user):""},["prevent"])},r(u.user.full_name),9,xl),n(y).hasPermission(["view board member profile"])?(t(),s("button",{key:0,type:"button",onClick:I(K=>ce(u.user),["prevent"]),title:"",class:"mx-2 btn btn-sm btn-primary"},kl,8,$l)):_("",!0)]),e("p",Ml,r(u.position.name),1)]),n(y).hasPermission(["assign board position"])?(t(),s("div",Cl,[Sl,e("div",Tl,[A(cl,{member:u,positions:ae.value,disableRemotePosition:0,onPositionUpdated:re},null,8,["member","positions"])])])):(t(),s("div",Pl,[ql,e("div",Dl,[e("i",{class:H(["mr-2 fa "+u.position.icon,"mr-2"])},null,2),N(" "+r(u.position.name),1)])])),e("div",Il,[Fl,e("p",Bl,r(n(He)(u.updated_at,null)),1)])])])]))),128))])])]),N("> "),e("div",El,[e("dialog",{id:"membersmodal",class:"modal",ref_key:"membersmodal",ref:E},[e("form",Ul,[Al,Rl,e("div",Vl,[e("div",Ll,[e("form",{novalidate:"",onSubmit:O[4]||(O[4]=I((...u)=>n(D)&&n(D)(...u),["prevent"])),class:"w-full rounded-xl mx-auto p-1 custom-modal"},[e("div",{class:H(["multiselect-container",{error:!!n(j)}])},[A(n(We),{id:"members",modelValue:k.value,"onUpdate:modelValue":O[1]||(O[1]=u=>k.value=u),mode:"tags",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:M.value,valueProp:"id",trackBy:"id",label:"name",class:H(["multiselect-container",{error:!!n(j)}]),onSelect:O[2]||(O[2]=u=>te()),onDeselect:O[3]||(O[3]=u=>le())},null,8,["modelValue","options","class"]),n(j)?(t(),s("div",jl,r(n(j)),1)):_("",!0)],2),Ol],32)])])])],512)])],64))}});const Hl=Ee(Nl,[["__scopeId","data-v-afd0c974"]]),Kl={key:0},zl={class:"card h-full"},Gl={class:"card-header flex items-center"},Ql=e("div",{class:"flex items-center flex-1 w-full"},[e("h2",{class:"card-header-title h3"}," Board Polls ")],-1),Yl={key:0,class:"flex items-center space-x-2"},Wl=e("i",{class:"far fa fa-plus mr-2"},null,-1),Zl=e("span",{class:"sr-only"},"Add poll",-1),Jl={class:"card-container"},Xl={key:0},ei={key:1},ti={class:"row overflow-auto p-4",style:{"max-height":"100vh"}},si={class:"card card-outline card-primary h-100"},oi={class:"card-header"},ai={class:"card-tools"},ni=["onClick"],li=e("i",{class:"fas fa-edit"},null,-1),ii=[li],di={class:"card-body"},ri={class:"text-primary tex-bold uppercase"},ci=e("strong",{class:"text-primary"},"Question:",-1),ui={class:"mt-2 text-primary text-bold"},mi={class:""},_i=e("strong",null,"Answer Options:",-1),pi={class:"row"},hi={class:"col-6"},vi={class:"list-unstyled text-success"},bi={class:"col-6"},fi={class:"list-unstyled text-success"},gi={class:"d-flex justify-content-between"},yi=e("strong",null,"Due Date:",-1),xi=e("strong",null,"Status:",-1),$i=e("strong",null,"Vote:",-1),wi=["innerHTML"],ki={class:""},Mi=e("strong",null,"Assignees:",-1),Ci={class:"row"},Si={class:"col-6"},Ti={class:"list-unstyled"},Pi={class:"col-6"},qi={class:"list-unstyled"},Di=e("strong",null,"Description:",-1),Ii=["innerHTML"],Fi={class:"flex justify-center items-center min-h-screen"},Bi={method:"dialog",class:"modal-box rounded-xl relative bg-white shadow-xl"},Ei={class:"font-bold text-lg text-center"},Ui=e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1),Ai={class:"overflow-auto p-4",style:{"max-height":"80vh"}},Ri={class:"grid grid-cols-2 md:grid-cols-2 gap-4 p-2"},Vi={class:"col-span-2"},Li={class:"flex flex-wrap -mx-2 mt-2"},ji={class:"w-full md:w-1/2 px-1 md:px-2"},Oi={class:"w-full md:w-1/2 px-1 md:px-2"},Ni={class:"flex flex-wrap -mx-2 mt-2"},Hi={class:"w-full md:w-1/3 px-1 md:px-2 text-center"},Ki=e("h2",{class:"font-bold text-sm text-center"},"Click to Add Options",-1),zi=e("h4",{class:"text-info font-semibold"},"Your Options",-1),Gi={key:0},Qi={key:0,class:"w-full md:w-2/3 px-1 md:px-2 flex flex-col"},Yi=["onClick"],Wi={class:"flex flex-wrap -mx-2 mt-2"},Zi={class:"w-full md:w-1/2 px-1 md:px-2"},Ji={class:"w-full md:w-1/2 px-1 md:px-2"},Xi={key:0},ed=e("h2",{class:"font-bold text-primary text-sm text-center"}," All Members Will be assiged this Poll ",-1),td=[ed],sd={key:0,class:"form-group col-span-3"},od=e("label",{class:"text-bold font-medium tracking-wide"}," People To Vote ",-1),ad={key:0,class:"message"},nd={key:1},ld={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},id={key:1},dd=e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1),rd=[dd],cd=xe({__name:"Pollp",setup(R){const y=Ce(),V=De(),x=v(!1),S=v("create"),b=V.params.boardId,B=v(null),q=v([]),E=v(null),k=v("single"),w=v("individuals"),j=v([]),ee=v([]),U=v(""),f=Ue();Te("duedate");const{errorMessage:$}=Te("pollassignees"),G=_e({id:p().required(),title:p().required(),poll_id:p().nullable(),deleted_at:p().nullable(),created_at:p().nullable(),updated_at:p().nullable()}),te=_e({id:p().required(),full_name:p().required()}),le=_e({id:p().required(),poll_id:p().nullable(),member_id:p().required(),user:te}),he=_e({board_id:p().nullable(),question:p().required(),description:p().required(),questionoptiontype:p().required(),optionstatus:p().required(),options:Le().of(G).required(),duedate:p().required(),assigneetype:p().required(),assigneestatus:p().required(),pollassignees:Le().of(le).nullable(),status:p().required()}),{handleSubmit:D,setErrors:ie,setFieldValue:M,values:Z}=Ae({validationSchema:he,initialValues:{board_id:b,question:"",description:"",questionoptiontype:"",optionstatus:"",options:[{id:Be(),title:"",poll_id:null,deleted_at:null,created_at:null,updated_at:null}],duedate:"",assigneetype:"",assigneestatus:"",pollassignees:[],status:"inactive"}});Te("options");const ve=i(()=>{var c;re(),S.value="create",x.value=!0,(c=E.value)==null||c.showModal()},"openCreatePollModal"),de=i(c=>{var L;re(),B.value=c.id,M("question",c.question),M("description",c.description),M("questionoptiontype",c.questionoptiontype),M("optionstatus",c.optionstatus),M("duedate",c.duedate),M("assigneetype",c.assigneetype),M("assigneestatus",c.assigneestatus),M("status",c.status),M("options",c.options),w.value=c.assigneestatus,se(c.pollassignees),S.value="edit",x.value=!0,(L=E.value)==null||L.showModal()},"openEditPollModal");function se(c){q.value=c.map(L=>({id:L.id,full_name:L.user.full_name,poll_id:L.poll_id,member_id:L.member_id,user:L.user})),M("pollassignees",q.value)}i(se,"mappollassigneesToReactiveRef");const me=i(()=>{M("pollassignees",q.value)},"selectedMembers"),ae=i(()=>{M("pollassignees",q.value)},"removeselectedUsers"),be=D(async(c,{resetForm:L})=>{var P;try{console.log("dddd");const Q={board_id:c.board_id,question:c.question,description:c.description,questionoptiontype:c.questionoptiontype,optionstatus:c.optionstatus,options:c.options,duedate:c.duedate,assigneetype:c.assigneetype,assigneestatus:c.assigneestatus,pollassignees:c.pollassignees,status:c.status};if(S.value==="create")await ns(Q,b);else{const X=B.value;await ls(Q,X)}(P=E.value)==null||P.close(),await Xe(),re()}catch(Q){Q instanceof qe?ie(Q.messages):f(Q)}}),re=i(()=>{S.value="create",x.value=!1,B.value=null,k.value="single",w.value="all_members",q.value=[],M("board_id",b),M("question",""),M("description",""),M("questionoptiontype","single"),M("optionstatus","single"),M("options",[{id:Be(),title:"",poll_id:null,deleted_at:null,created_at:null,updated_at:null}]),M("duedate",""),M("assigneetype","all_members"),M("assigneestatus","all_members"),M("pollassignees",[]),M("status","inactive")},"reset"),ce=i(c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),"formattedDateTime"),g=i(c=>O(c)?"bg-danger":"bg-success","dateBadgeClass"),O=i(c=>{const L=new Date,P=new Date(c);return L>P},"hasDueDatePassed"),u=i(c=>{if(!c.votes||c.votes.length===0)return"No votes yet";const L=c.votes.length,P=c.pollassignees.length;if(L>P)return console.error("Total votes exceed total members, which is unexpected."),"Voting data error";const Q=c.votes.reduce((fe,Re)=>{const Ge=JSON.parse(Re.option_id).id;return fe[Ge]=(fe[Ge]||0)+1,fe},{}),X=Object.keys(Q).reduce((fe,Re)=>Q[fe]>Q[Re]?fe:Re);if(!c.options.find(fe=>fe.id===X))return console.error("Most voted option not found in poll options."),"Voting data error";const ht=P-L;return(Q[X]/L*100).toFixed(1),`${c.options.map(fe=>`${((Q[fe.id]||0)/L*100).toFixed(1)}% voted for ${fe.title}`).join("<br>")}<br>Total votes: ${L} / ${ht} not yet`},"calculateVoteStats"),h=i(c=>{switch(c){case"Backlog":return"badge bg-warning";case"Pending":return"badge bg-info";case"On Progress":return"badge bg-primary";case"Completed":return"badge bg-success";default:return"badge"}},"statusClass"),K=[{name:"Single Answer",value:"single"},{name:"Multiple Answers: More than one",value:"multiple"}],d=[{name:"Individuals",value:"individuals"},{name:"Assign All Board Members",value:"all_members"}],T=J(()=>K),o=J(()=>d),l=i(c=>{ee.value=[],j.value=[],a(),k.value=c,M("questionoptiontype",c),M("optionstatus",c)},"handleQuestionOptionTypeChange"),m=i(c=>{q.value=[],U.value=c,w.value=c,M("assigneetype",c),M("assigneestatus",c),M("pollassignees",[])},"handleAssigneeTypeChange"),a=i(()=>{Array.isArray(Z.options)||(console.error("Invalid state: values.options is not an array."),M("options",[]));const c={id:Be(),title:"",poll_id:null,deleted_at:null,created_at:null,updated_at:null};M("options",[...Z.options,c])},"addEmptyOption");lt(()=>Z.options,c=>{});const F=i(c=>{const L=Z.options.filter(P=>P.id!==c);console.log("vv",L),M("options",L)},"removeOption"),C=i(()=>Me({queryKey:["getPollMembershisKey"],queryFn:async()=>(await Je(b,{paginate:"false"})).data.map(ct())}),"getMembers"),{isLoading:ne,data:W,refetch:ue}=C(),ct=i(()=>c=>({id:c.id,full_name:c.user.full_name,member_id:c.id,user:c.user}),"formatEvent"),ut=J(()=>{var c;return!W.value||((c=W.value)==null?void 0:c.length)===0?[]:W.value}),mt=i(()=>Me({queryKey:["getBoardPollsKey",b],queryFn:async()=>(await is(b,{paginate:"false"})).data}),"getBoardPolls"),{isLoading:_t,data:pt,refetch:Xe}=mt();return ke(async()=>{ue(),Xe()}),(c,L)=>n(y).hasPermission(["view poll"])?(t(),s("div",Kl,[e("div",zl,[e("div",Gl,[Ql,n(y).hasPermission(["create poll"])?(t(),s("div",Yl,[e("button",{type:"button",onClick:I(ve,["prevent"]),class:"btn btn-tool"},[Wl,N(),Zl])])):_("",!0)]),e("div",Jl,[n(_t)?(t(),s("div",Xl,"Loading Board Polls...")):(t(),s("div",ei,[e("div",ti,[(t(!0),s(z,null,Y(n(pt),(P,Q)=>(t(),s("div",{class:"col-lg-12 col-md-12 col-sm-12 mb-2",key:Q},[e("div",si,[e("div",oi,[e("div",ai,[n(y).hasPermission(["edit poll"])?(t(),s("button",{key:0,class:"btn btn-tool",onClick:I(X=>de(P),["prevent"])},ii,8,ni)):_("",!0)])]),e("div",di,[e("div",ri,[ci,e("p",ui,r(P.question),1),e("div",mi,[_i,e("div",pi,[e("div",hi,[e("ul",vi,[(t(!0),s(z,null,Y(P.options.slice(0,Math.ceil(P.options.length/2)),(X,$e)=>(t(),s("li",{key:X.id},r($e+1)+". "+r(X.title),1))),128))])]),e("div",bi,[e("ul",fi,[(t(!0),s(z,null,Y(P.options.slice(Math.ceil(P.options.length/2)),(X,$e)=>(t(),s("li",{key:X.id},r($e+1+Math.ceil(P.options.length/2))+". "+r(X.title),1))),128))])])])])]),e("div",gi,[e("div",null,[yi,e("p",{class:H(g(P.duedate))},r(ce(P.duedate)),3)]),e("div",null,[xi,e("p",null,[e("span",{class:H(h(P.status))},r(P.status),3)])]),e("div",null,[$i,e("p",null,[e("span",{innerHTML:u(P)},null,8,wi)])])]),e("div",ki,[Mi,e("div",Ci,[e("div",Si,[e("ul",Ti,[(t(!0),s(z,null,Y(P.pollassignees.slice(0,Math.ceil(P.pollassignees.length/2)),(X,$e)=>(t(),s("li",{key:X.id},r($e+1)+". "+r(X.user.full_name),1))),128))])]),e("div",Pi,[e("ul",qi,[(t(!0),s(z,null,Y(P.pollassignees.slice(Math.ceil(P.pollassignees.length/2)),(X,$e)=>(t(),s("li",{key:X.id},r($e+1+Math.ceil(P.pollassignees.length/2))+". "+r(X.user.full_name),1))),128))])])])]),e("div",null,[Di,e("p",{innerHTML:P.description,class:"mt-2"},null,8,Ii)])])])]))),128))])]))])]),e("div",Fi,[e("dialog",{id:"pollmodal",class:"modal w-full max-w-4xl mx-auto p-0",ref_key:"PollModal",ref:E},[e("form",Bi,[e("h3",Ei,r(S.value=="create"?"Create Poll":"Edit Poll"),1),Ui,e("div",Ai,[e("div",Ri,[e("div",Vi,[e("form",{novalidate:"",onSubmit:L[3]||(L[3]=I((...P)=>n(be)&&n(be)(...P),["prevent"])),class:""},[A(Pe,{labeled:!0,label:"Poll Question",name:"question",placeholder:"Enter Poll Question",type:"text"}),A(ze,{label:"Poll description",name:"description",theme:"snow",placeholder:"Enter Poll Description",toolbar:"full",contentType:"html",class:"col-span-2"}),e("div",Li,[e("div",ji,[A(Ke,{labeled:!0,name:"questionoptiontype",label:"Select Allowed Answers On the Question",placeholder:"Select Allowed Answers On the Question",options:T.value,onSelectedItem:l},null,8,["options"])]),e("div",Oi,[A(Ve,{label:"Poll Due Date",name:"duedate",flow:["month"],placeholder:"Enter Poll Due Date & Time"})])]),e("div",Ni,[e("div",Hi,[e("div",null,[Ki,e("button",{onClick:I(a,["prevent"]),class:"btn btn-primary h-10 mt-2"}," Add Option ")]),zi,n(Z).options?(t(),s("ul",Gi,[(t(!0),s(z,null,Y(n(Z).options,(P,Q)=>(t(),s("li",{class:"text-primary font-bold text-justify",key:Q},r(Q+1)+"."+r(P==null?void 0:P.title),1))),128))])):_("",!0)]),n(Z).options?(t(),s("div",Qi,[(t(!0),s(z,null,Y(n(Z).options,(P,Q)=>(t(),s("div",{class:"form-group flex items-center mb-2",key:Q},[A(Xt,{labeled:!0,label:"Title for option "+(Q+1),name:"options["+Q+"].title",placeholder:"Enter title",class:"flex-grow",type:"text"},null,8,["label","name"]),e("a",{href:"#",class:"ml-2 text-red-600 font-bold mt-8",onClick:I(X=>F(P.id),["prevent"])}," ✕ ",8,Yi)]))),128))])):_("",!0)]),e("div",Wi,[e("div",Zi,[A(Ke,{labeled:!0,name:"assigneetype",label:"Select Assignee Type",placeholder:"Select Assignee Type",options:o.value,onSelectedItem:m},null,8,["options"])]),e("div",Ji,[w.value==="all_members"?(t(),s("div",Xi,td)):_("",!0)])]),w.value==="individuals"?(t(),s("div",sd,[od,e("div",{class:H(["multiselect-container",{error:!!n($)}])},[A(n(We),{id:"pollassignees",modelValue:q.value,"onUpdate:modelValue":L[0]||(L[0]=P=>q.value=P),mode:"tags",required:"",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:ut.value,valueProp:"member_id",trackBy:"member_id",label:"full_name",class:H(["col-span-3",["multiselect-container",{error:!!n($)}]]),object:!0,onSelect:L[1]||(L[1]=P=>me()),onDeselect:L[2]||(L[2]=P=>ae())},null,8,["modelValue","options","class"]),n($)?(t(),s("div",ad,r(n($)),1)):_("",!0)],2)])):_("",!0),q.value&&q.value.length||w.value==="all_members"?(t(),s("div",nd,[e("button",ld,r(S.value=="create"?"Create Poll":"Edit Poll"),1)])):_("",!0)],32)])])])])],512)])])):(t(),s("div",id,rd))}});const pe=i(R=>(je("data-v-ab47f6a7"),R=R(),Oe(),R),"_withScopeId"),ud={key:0},md={class:"card h-full"},_d={class:"card-header flex items-center"},pd=pe(()=>e("div",{class:"flex items-center flex-1 w-full"},[e("h2",{class:"card-header-title h3"},"Board Tasks")],-1)),hd={key:0,class:"flex items-center space-x-2"},vd=pe(()=>e("i",{class:"far fa fa-plus mr-2"},null,-1)),bd=pe(()=>e("span",{class:"sr-only"},"Add task",-1)),fd={class:"card-container"},gd={key:0},yd={key:1},xd={class:"row overflow-auto p-4",style:{"max-height":"100vh"}},$d={class:"card card-outline card-primary h-100"},wd={class:"card-header"},kd={class:"card-tools"},Md=["onClick"],Cd=pe(()=>e("i",{class:"fas fa-edit"},null,-1)),Sd=[Cd],Td={class:"card-body"},Pd={class:"text-primary text-bold uppercase"},qd={class:"d-flex justify-content-between"},Dd=pe(()=>e("strong",null,"Due Date:",-1)),Id=pe(()=>e("strong",null,"Status:",-1)),Fd={key:0,class:"badge bg-warning"},Bd={key:1,class:"badge bg-info"},Ed={key:2,class:"badge bg-primary"},Ud={key:3,class:"badge bg-success"},Ad={class:""},Rd=pe(()=>e("strong",null,"Assignees:",-1)),Vd={class:"row"},Ld={class:"col-6"},jd={class:"list-unstyled"},Od={class:"col-6"},Nd={class:"list-unstyled"},Hd=pe(()=>e("strong",null,"Description:",-1)),Kd=["innerHTML"],zd={class:"flex justify-center col-md-6"},Gd={method:"dialog",class:"modal-box rounded-xl"},Qd={class:"font-bold text-lg justify-center flex"},Yd=pe(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Wd={class:"overflow-auto p-4",style:{"max-height":"80vh"}},Zd={class:"grid grid-cols-3 md:grid-cols-3 gap-2 p-2"},Jd={class:"col-span-3"},Xd={class:"flex flex-wrap -mx-2 mt-2"},er={class:"w-full md:w-1/2 px-1 md:px-2"},tr={class:"w-full md:w-1/2 px-1 md:px-2"},sr={class:"flex flex-wrap -mx-2 mt-2"},or={class:"w-full md:w-1/2 px-1 md:px-2"},ar={class:"w-full md:w-1/2 px-1 md:px-2"},nr={key:0},lr=pe(()=>e("h2",{class:"font-bold text-primary text-sm text-center"},"All Members Will be assigned this Task",-1)),ir=[lr],dr={key:0,class:"form-group col-span-3"},rr=pe(()=>e("label",{class:"text-bold font-medium tracking-wide"},"People to Assign",-1)),cr={key:0,class:"message"},ur={key:1},mr={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},_r={key:1},pr=pe(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),hr=[pr],vr=xe({__name:"Taskp",setup(R){const y=Ce(),V=De(),x=v(!1),S=v("create"),b=V.params.boardId,B=v(null),q=v([]),E=v(null),k=v(null),w=v("individuals"),j=v(""),ee=Ue();Te("duedate");const{errorMessage:U}=Te("taskassignees"),f=i(a=>{const F=new Date,C=new Date(a);return F>C},"hasDueDatePassed"),$=_e({id:p().nullable(),full_name:p().nullable()}),G=_e({id:p().nullable(),task_id:p().nullable(),member_id:p().nullable(),user:$}),te=_e({board_id:p().nullable(),title:p().required(),duedate:p().required(),description:p().required(),status:p().required(),assigneetype:p().required(),assigneestatus:p().required(),taskassignees:Le().of(G).nullable()}),{handleSubmit:le,setErrors:he,setFieldValue:D,values:ie}=Ae({validationSchema:te,initialValues:{board_id:b,title:"",duedate:"",description:"",status:"pending",assigneetype:"",assigneestatus:"",taskassignees:[]}}),M=i(()=>{var a;ae(),S.value="create",x.value=!0,(a=k.value)==null||a.showModal()},"openCreateTaskModal"),Z=i(a=>{var F;ae(),E.value=a,B.value=a.id,D("title",a.title),D("duedate",a.duedate),D("description",a.description),D("status",a.status),D("assigneetype",a.assigneetype),D("assigneestatus",a.assigneestatus),w.value=a.assigneestatus,ve(a.taskassignees),S.value="edit",x.value=!0,(F=k.value)==null||F.showModal()},"openEditTaskModal");function ve(a){q.value=a.map(F=>({id:F.id,full_name:F.user.full_name,task_id:F.task_id,member_id:F.member_id,user:F.user})),D("taskassignees",q.value)}i(ve,"maptaskassigneesToReactiveRef");const de=i(()=>{D("taskassignees",q.value)},"selectedMembers"),se=i(()=>{D("taskassignees",q.value)},"removeselectedUsers"),me=le(async(a,{resetForm:F})=>{var C;try{const ne={board_id:a.board_id,title:a.title,duedate:a.duedate,description:a.description,status:a.status,assigneetype:a.assigneetype,assigneestatus:a.assigneestatus,taskassignees:a.taskassignees};if(S.value==="create")await ds(ne,b);else{const W=B.value;await rs(ne,W)}(C=k.value)==null||C.close(),await m(),ae()}catch(ne){ne instanceof qe?he(ne.messages):ee(ne)}}),ae=i(()=>{S.value="create",x.value=!1,B.value=null,w.value="all_members",q.value=[],D("board_id",b),D("title",""),D("duedate",""),D("description","description ................"),D("status","pending"),D("assigneetype","all_members"),D("assigneestatus","all_members"),D("taskassignees",[])},"reset"),be=i(a=>{q.value=[],j.value=a,w.value=a,D("assigneetype",a),D("assigneestatus",a),D("taskassignees",[])},"handleAssigneeTypeChange"),re=[{name:"Individuals",value:"individuals"},{name:"Assign All Board Members",value:"all_members"}],ce=J(()=>re),g=i(()=>Me({queryKey:["getBoardMembersKey"],queryFn:async()=>(await Je(b,{paginate:"false"})).data.map(K())}),"getMembers"),{isLoading:O,data:u,refetch:h}=g(),K=i(()=>a=>({id:a.id,full_name:a.user.full_name,member_id:a.id,user:a.user}),"formatEvent"),d=J(()=>{var a;return!u.value||((a=u.value)==null?void 0:a.length)===0?[]:u.value}),T=i(()=>Me({queryKey:["getBoardTasksKey",b],queryFn:async()=>(await cs(b,{paginate:"false"})).data}),"getBoardTasks"),{isLoading:o,data:l,refetch:m}=T();return ke(async()=>{m(),h()}),(a,F)=>n(y).hasPermission(["view task"])?(t(),s("div",ud,[e("div",md,[e("div",_d,[pd,n(y).hasPermission(["create task"])?(t(),s("div",hd,[e("button",{type:"button",onClick:I(M,["prevent"]),class:"btn btn-tool"},[vd,N(),bd])])):_("",!0)]),e("div",fd,[n(o)?(t(),s("div",gd,"Loading Board Tasks...")):(t(),s("div",yd,[e("div",xd,[(t(!0),s(z,null,Y(n(l),(C,ne)=>(t(),s("div",{class:"col-lg-12 col-md-12 col-sm-12 mb-2",key:ne},[e("div",$d,[e("div",wd,[e("div",kd,[n(y).hasPermission(["edit task"])?(t(),s("button",{key:0,class:"btn btn-tool",onClick:I(W=>Z(C),["prevent"])},Sd,8,Md)):_("",!0)])]),e("div",Td,[e("div",Pd,r(C.title),1),e("div",qd,[e("div",null,[Dd,e("p",{class:H({"text-danger":f(C.duedate)&&C.status!=="completed","text-success":!f(C.duedate)||C.status==="completed"})},r(n(He)(C.duedate)),3)]),e("div",null,[Id,e("p",null,[C.status==="backlog"?(t(),s("span",Fd,"Backlog")):C.status==="pending"?(t(),s("span",Bd,"Pending")):C.status==="onprogress"?(t(),s("span",Ed,"On Progress")):C.status==="completed"?(t(),s("span",Ud,"Completed")):_("",!0)])])]),e("div",Ad,[Rd,e("div",Vd,[e("div",Ld,[e("ul",jd,[(t(!0),s(z,null,Y(C.taskassignees.slice(0,Math.ceil(C.taskassignees.length/2)),(W,ue)=>(t(),s("li",{key:W.id},r(ue+1)+". "+r(W.user.full_name),1))),128))])]),e("div",Od,[e("ul",Nd,[(t(!0),s(z,null,Y(C.taskassignees.slice(Math.ceil(C.taskassignees.length/2)),(W,ue)=>(t(),s("li",{key:W.id},r(ue+1+Math.ceil(C.taskassignees.length/2))+". "+r(W.user.full_name),1))),128))])])])]),e("div",null,[Hd,e("p",{innerHTML:C.description,class:"mt-2"},null,8,Kd)])])])]))),128))])]))])]),e("div",zd,[e("dialog",{id:"taskmodal",class:"modal",ref_key:"TaskModal",ref:k},[e("form",Gd,[e("h3",Qd,r(S.value=="create"?"Create Board Task":"Edit Board Task"),1),Yd,e("div",Wd,[e("div",Zd,[e("div",Jd,[e("form",{novalidate:"",onSubmit:F[3]||(F[3]=I((...C)=>n(me)&&n(me)(...C),["prevent"])),class:""},[e("div",Xd,[e("div",er,[A(Pe,{labeled:!0,label:"Task Title",name:"title",placeholder:"Enter Task Title",type:"text"})]),e("div",tr,[A(Ve,{label:"Task Due Date",name:"duedate",flow:["month"],placeholder:"Task Due Date"})])]),A(ze,{label:"Task Description",name:"description",theme:"snow",placeholder:"Enter Task Description",toolbar:"full",contentType:"html",class:"col-span-3"}),e("div",sr,[e("div",or,[A(Ke,{labeled:!0,name:"assigneetype",label:"Select Assignee Type",placeholder:"Select Assignee Type",options:ce.value,onSelectedItem:be},null,8,["options"])]),e("div",ar,[w.value==="all_members"?(t(),s("div",nr,ir)):_("",!0)])]),w.value==="individuals"?(t(),s("div",dr,[rr,e("div",{class:H(["multiselect-container",{error:!!n(U)}])},[A(n(We),{id:"taskassignees",modelValue:q.value,"onUpdate:modelValue":F[0]||(F[0]=C=>q.value=C),mode:"tags",required:"",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:d.value,valueProp:"member_id",trackBy:"member_id",label:"full_name",class:H(["col-span-3",["multiselect-container",{error:!!n(U)}]]),object:!0,onSelect:F[1]||(F[1]=C=>de()),onDeselect:F[2]||(F[2]=C=>se())},null,8,["modelValue","options","class"]),n(U)?(t(),s("div",cr,r(n(U)),1)):_("",!0)],2)])):_("",!0),q.value&&q.value.length||w.value==="all_members"?(t(),s("div",ur,[e("button",mr,r(S.value=="create"?"Create Task":"Edit Task"),1)])):_("",!0)],32)])])])])],512)])])):(t(),s("div",_r,hr))}});const br=Ee(vr,[["__scopeId","data-v-ab47f6a7"]]),fr={key:0},gr={class:"row"},yr={class:"col-md-6"},xr={class:"col-md-6"},$r={key:1},wr=e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1),kr=[wr],Mr=xe({__name:"TaskPolls",setup(R){const y=Ce();return(V,x)=>n(y).hasPermission(["view task","view poll"])?(t(),s("div",fr,[e("div",gr,[e("div",yr,[A(br)]),e("div",xr,[A(cd)])])])):(t(),s("div",$r,kr))}});const Cr={class:"col-md-12"},Sr={key:0,class:"card card-widget widget-user shadow-lg"},Tr=e("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)"}},null,-1),Pr=[Tr],qr={class:"card-footer"},Dr={class:""},Ir={class:"widget-user-image",style:{left:"4%","margin-left":"-45px",position:"absolute",top:"190px"}},Fr=["src"],Br={class:"ml-3 flex-1",style:{"margin-top":"-28px"}},Er=e("i",{class:"fas fa-chevron-left fa-xs"},null,-1),Ur={class:"h2 mb-2 lg:mb-0",style:{"margin-left":"150px"}},Ar={class:"card-outline card-outline-tabs"},Rr={class:"card-header p-0 border-bottom-0"},Vr={class:"nav nav-tabs",id:"custom-tabs-four-tab",role:"tablist"},Lr=["onClick"],jr={class:"card-body"},Or={class:"tab-content",id:"custom-tabs-four-tabContent"},Nr=["id"],mc=xe({__name:"BoardDetails",setup(R){const y=Ce(),V=v(),x=De(),S=Ye(),b=v("home"),B=v(""),q=[{id:"home",name:"Meeting Details",component:ol,permissions:["view meeting"]},{id:"documents",name:"Documents",component:Wa,permissions:["view documents"]},{id:"tasks",name:"Task & Polls",component:Mr,permissions:["view task","view poll"]},{id:"members",name:"Members",component:Hl,permissions:["view meeting memberships"]},{id:"committees",name:"Committees",component:_o,permissions:["view committee"]}],E=J(()=>q.filter(U=>U.permissions?U.permissions.every(f=>y.hasPermission([f])):!0)),k=i(U=>{B.value=b.value,b.value=U},"setActiveTab"),w=i(()=>{B.value==="agenda"&&(k("agenda"),window.dispatchEvent(new CustomEvent("refetchMemberships")))},"handleMembershipsUpdated");yt(()=>{x.query.previousTab&&(B.value=x.query.previousTab),x.query.currentTab&&(b.value=x.query.currentTab)});function j(){S.push({name:$t})}i(j,"goBack");const ee=x.params.boardId;return ke(async()=>{try{const f=(await wt(ee)).data;V.value=f,window.dispatchEvent(new CustomEvent("updateTitle",{detail:f.name}))}catch(U){console.error("Error fetching board data:",U)}}),(U,f)=>(t(),s("div",Cr,[V.value?(t(),s("div",Sr,[e("div",{class:"widget-user-header text-white",style:it([{backgroundImage:`url(${n(Vt)(V.value.cover)})`,backgroundPosition:"center center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},{height:"250px",width:"100%",position:"relative"}])},Pr,4),e("div",qr,[e("div",Dr,[e("div",Ir,[e("img",{class:"img-circle elevation-2",src:n(dt)(V.value.icon),alt:"User Avatar",style:{width:"128px",height:"128px"}},null,8,Fr)]),e("div",Br,[e("a",{href:"",onClick:f[0]||(f[0]=I($=>j(),["prevent"])),class:"mb-2 lg:mb-0 text-blue-primary",style:{"margin-left":"140px","margin-top":"-44px"}},[Er,N(" Boards ")]),e("h3",Ur,r(V.value.name),1),e("div",Ar,[e("div",Rr,[e("ul",Vr,[(t(!0),s(z,null,Y(E.value,$=>(t(),s("li",{class:"nav-item",key:$.id},[e("a",{class:H(["nav-link",{active:b.value===$.id}]),onClick:G=>k($.id)},r($.name),11,Lr)]))),128))])]),e("div",jr,[e("div",Or,[(t(!0),s(z,null,Y(E.value,$=>(t(),s("div",{key:$.id,class:H(["tab-pane fade",{"show active":b.value===$.id}]),id:$.id,role:"tabpanel"},[(t(),ye(xt($.component),{onChangeTab:k,onMembershipsUpdated:w},null,32))],10,Nr))),128))])])])])])])])):_("",!0)]))}});export{mc as default};
