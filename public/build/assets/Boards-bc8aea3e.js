var de=Object.defineProperty;var d=(f,v)=>de(f,"name",{value:v,configurable:!0});import{d as ce,i as me,r as _,V as G,C as ue,P as pe,b as K,u as o,o as l,c as n,e,T as x,g as E,F as he,R as _e,t as p,f as y,U as F,h as w,w as O,l as ve,W as fe,X as be,Y as ge,_ as xe}from"./main-a9f2cfe9.js";import{u as ye,d as we,c as Be,a as Q,b as ke,e as Ce}from"./useUnexpectedErrorHandler-16280be0.js";import{u as Me,a as Ie,b as Se,c as qe,d as Ee,e as Fe}from"./useStaffRequest-1867f353.js";import{F as Ue}from"./FormInput-139a23bd.js";import{F as Ve}from"./FormQuillEditor-778f598f.js";import{F as Y}from"./FormUpload-276fcdbd.js";import{r as Ne,a as De,s as z,i as $e,u as W,c as Pe,b as X}from"./Breadcrumb-7a663afc.js";import{u as Re}from"./useQuery-e9652e60.js";import"./index-66c2f00f.js";import"./staff_routes-0c3f8bda.js";import"./useQueryClient-1703431f.js";const r=d(f=>(fe("data-v-a0610431"),f=f(),be(),f),"_withScopeId"),Te={key:0,class:"container-fluid"},je={class:"row"},Ae={class:"col-12"},Le={class:""},He={class:"card-header"},Ge=r(()=>e("div",{class:"float-left"},[e("h1",{class:"h2 mb-2 lg:mb-0"},"Boards & Boards")],-1)),Ke={class:"float-right"},Oe=r(()=>e("i",{class:"far fa fa-plus mr-2"},null,-1)),Qe={class:"card-body"},Ye={class:"row"},ze={key:0,class:"col-md-12 col-12"},We={class:"info-box-icon bg-danger"},Xe={class:"ml-3 flex-1"},Je={class:"h2 mb-2 lg:mb-0"},Ze={class:"grid grid-cols-1 lg:grid-cols-12 gap-0 lg:gap-2"},es={class:"text-gray-900 m-0 col-span-1 lg:col-span-2"},ss={key:0,class:"text-gray-900 m-0 col-span-1 lg:col-span-1"},ts={key:0},as={key:1},os={key:2},ls=r(()=>e("br",null,null,-1)),ns=["onClick"],rs=r(()=>e("i",{class:"far fa fa-plus mr-2"},null,-1)),is=["innerHTML"],ds={class:"flex justify-end space-x-2 col-span-1 lg:col-span-2"},cs=["onClick"],ms=r(()=>e("i",{class:"far fa-edit"},null,-1)),us=[ms],ps=["onClick"],hs=r(()=>e("i",{class:"fas fa-trash-alt"},null,-1)),_s=[hs],vs=r(()=>e("i",{class:"far fa-eye"},null,-1)),fs={key:1,class:"col-md-12 col-12"},bs=ge('<div class="info-box shadow-lg p-6" data-v-a0610431><span class="info-box-icon bg-danger" data-v-a0610431><i class="far fa-star" data-v-a0610431></i></span><div class="ml-3 flex-1" data-v-a0610431><h3 class="h2 mb-2 lg:mb-0" data-v-a0610431><a href="" data-v-a0610431> create Board </a></h3></div></div>',1),gs=[bs],xs={class:"flex justify-center items-center min-h-screen"},ys={method:"dialog",class:"modal-box rounded-xl relative bg-white shadow-xl"},ws={class:"font-bold text-lg text-center"},Bs=r(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),ks={class:"overflow-auto p-4",style:{"max-height":"80vh"}},Cs={class:"grid grid-cols-1 md:grid-cols-2 gap-4 p-2"},Ms={class:"col-span-2"},Is={class:"flex flex-wrap -mx-2"},Ss={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},qs={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Es=["src"],Fs={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Us=["src"],Vs={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},Ns={class:"flex justify-center col-md-6"},Ds={method:"dialog",class:"modal-box rounded-xl"},$s=r(()=>e("h3",{class:"font-bold text-lg justify-center flex"},p("Add Members"),-1)),Ps=r(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Rs={class:"w-full mt-6 p-2"},Ts={class:"font-thin text-sm flex flex-col items-center gap-6"},js={key:0,class:"message"},As=r(()=>e("button",{type:"submit",class:"btn btn-md mb-1 w-full pt-1 text-red-600 mt-6 bg-primary"},p("Add Members"),-1)),Ls={key:1,class:"container-fluid"},Hs=r(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),Gs=[Hs],Ks=ce({__name:"Boards",setup(f){const v=me(),b=_(!1),c=_("create"),B=_(null),S=_(""),g=_([]),k=_(null),C=_(null),M=_([]),U=ye(),V=we().test("fileOrString","Must be a file or a string",s=>s instanceof File||typeof s=="string"),J=Be({name:Q().required("Name is required"),description:Q().required("Description is required"),icon:V.required("Icon is required"),cover:V.required("Cover is required")}),{handleSubmit:Z,setErrors:N,setFieldValue:h,values:D}=ke({validationSchema:J,initialValues:{name:"",description:"",icon:"",cover:""}}),$=Z(async s=>{var t,i,m;try{if(c.value==="create"||c.value==="edit"){const u={name:s.name,description:s.description,icon:s.icon,cover:s.cover};c.value==="create"?await Me(u):c.value==="edit"&&(t=B.value)!=null&&t.id&&(console.log("Selected Board ID:",B.value.id),await Ie(u,B.value.id))}(i=k.value)==null||i.close(),(m=C.value)==null||m.close(),await q(),Ne(),De(),P(),g.value=[],b.value=!1}catch(u){u instanceof G?N(u.messages):U(u)}}),ee=d(async()=>{var s;try{if(S.value){const t={members:g.value};await qe(t,S.value)}(s=C.value)==null||s.close(),await q(),P(),g.value=[],b.value=!1}catch(t){t instanceof G?N(t.messages):U(t)}},"onSubmitMembers"),{errorMessage:I}=Ce("members"),se=d(()=>{var s;c.value="create",b.value=!0,(s=k.value)==null||s.showModal()},"openCreateModal"),te=d(s=>{var t;B.value=s,h("name",s.name),h("description",s.description),h("icon",s.icon),h("cover",s.cover),X(s.cover),W(s.icon),c.value="edit",b.value=!0,(t=k.value)==null||t.showModal()},"openEditModal"),P=d(()=>{h("name",""),h("description",""),h("icon",""),h("cover",""),c.value="create",b.value=!0},"resetBoardForm"),ae=d(s=>{var i;S.value=s.id;const t=s.members.map(m=>m.user.id.toString());g.value=t,c.value="members",b.value=!0,(i=C.value)==null||i.showModal()},"openEditMembersModal"),oe=d(()=>{},"selectedUsers"),le=d(async s=>{await Ee(s.id),await q()},"deleteBoard"),ne=ue(()=>{var t;const s=[];return M.value&&((t=M.value)==null?void 0:t.length)>0&&M.value.reduce((i,m)=>(i.push({id:m.id,name:`${m.full_name}`}),i),s),s}),re=d(async()=>{const s=await Se({paginate:"false"});M.value=s.data},"getUsers");pe(async()=>{window.dispatchEvent(new CustomEvent("updateTitle",{detail:"Boards & Boards"})),re()});const ie=d(()=>Re({queryKey:["getBoardsKey"],queryFn:async()=>(await Fe({paginate:"false"})).data}),"getBoards"),{isLoading:Os,data:R,refetch:q}=ie();return(s,t)=>{var u;const i=K("router-link"),m=K("Multiselect");return o(v).hasPermission(["view board"])?(l(),n("div",Te,[e("div",je,[e("div",Ae,[e("div",Le,[e("div",He,[Ge,e("div",Ke,[e("button",{onClick:x(se,["prevent"]),type:"submit",class:"btn btn-secondary bg-primary"},[Oe,E("New Board ")])])]),e("div",Qe,[e("div",Ye,[o(R)?(l(),n("div",ze,[(l(!0),n(he,null,_e(o(R),a=>{var T,j,A,L;return l(),n("div",{class:"info-box shadow-lg p-6",key:a.id},[e("span",We,[e("i",{class:F(a.icon)},null,2)]),e("div",Xe,[e("h3",Je,[y(i,{to:{name:"BoardDetails",params:{boardId:a.id}}},{default:O(()=>[E(p(a.name),1)]),_:2},1032,["to"])]),e("div",Ze,[e("p",es," Owner: "+p(a.owner),1),a.members?(l(),n("p",ss,[((T=a.members)==null?void 0:T.length)>1?(l(),n("span",ts,p((j=a.members)==null?void 0:j.length)+" Members ",1)):((A=a.members)==null?void 0:A.length)===1?(l(),n("span",as,p((L=a.members)==null?void 0:L.length)+" Member ",1)):(l(),n("span",os,"No Members, Add")),ls,o(v).hasPermission(["add member to board","edit board member","remove board member"])?(l(),n("a",{key:3,href:"",onClick:x(H=>ae({id:a.id,members:a.members?a.members:[]}),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},[rs,E(" Members ")],8,ns)):w("",!0)])):w("",!0),e("div",{class:"text-muted m-0 col-span-1 lg:col-span-7 truncate",innerHTML:a.description},null,8,is),e("div",ds,[o(v).hasPermission(["edit board"])?(l(),n("a",{key:0,href:"",onClick:x(H=>te(a),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},us,8,cs)):w("",!0),o(v).hasPermission(["delete board"])?(l(),n("a",{key:1,href:"",onClick:x(H=>le(a),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},_s,8,ps)):w("",!0),o(v).hasPermission(["view board"])?(l(),ve(i,{key:2,to:{name:"BoardDetails",params:{boardId:a.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:O(()=>[vs]),_:2},1032,["to"])):w("",!0)])])])])}),128))])):(l(),n("div",fs,gs))])])])])]),e("div",xs,[e("dialog",{id:"boardModal",class:"modal w-full max-w-4xl mx-auto p-0",ref_key:"BoardModal",ref:k},[e("form",ys,[e("h3",ws,p(c.value=="create"?"Create Board":"Edit Board"),1),Bs,e("div",ks,[e("div",Cs,[e("div",Ms,[e("form",{novalidate:"",onSubmit:t[2]||(t[2]=x((...a)=>o($)&&o($)(...a),["prevent"])),class:""},[e("div",Is,[e("div",Ss,[y(Ue,{labeled:!0,label:"Board/Board Name",name:"name",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter Board/Board Name",type:"text"})]),e("div",qs,[y(Y,{labeled:!0,label:"Upload icon Image for the Board",name:"icon",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter icon Image of the Board",type:"file",accept:o(z).join(", "),onChange:t[0]||(t[0]=a=>o($e)(a))},null,8,["accept"]),e("img",{src:o(W)((u=o(D))==null?void 0:u.icon),class:"file_attachment"},null,8,Es)]),e("div",Fs,[y(Y,{labeled:!0,label:"Upload Cover Image for the Board",name:"cover",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter Cover Image of the Board",type:"file",accept:o(z).join(", "),onChange:t[1]||(t[1]=a=>o(Pe)(a))},null,8,["accept"]),e("img",{src:o(X)(o(D).cover),class:"file_attachment"},null,8,Us)])]),y(Ve,{label:"Description",name:"description",theme:"snow",placeholder:"Enter Board Description",toolbar:"full",contentType:"html",class:"col-span-3 mb-4"}),e("button",Vs,p(c.value=="create"?"Create Board":"Edit Board"),1)],32)])])])])],512)]),e("div",Ns,[e("dialog",{id:"membersmodal",class:"modal",ref_key:"membersmodal",ref:C},[e("form",Ds,[$s,Ps,e("div",Rs,[e("div",Ts,[e("form",{novalidate:"",onSubmit:x(ee,["prevent"]),class:"w-full rounded-xl mx-auto p-1 custom-modal"},[e("div",{class:F(["multiselect-container",{error:!!o(I)}])},[y(m,{id:"members",modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=a=>g.value=a),mode:"tags",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:ne.value,valueProp:"id",trackBy:"id",label:"name",class:F(["multiselect-container",{error:!!o(I)}]),onSelect:t[4]||(t[4]=a=>oe()),onDeselect:t[5]||(t[5]=a=>s.removeselectedUsers())},null,8,["modelValue","options","class"]),o(I)?(l(),n("div",js,p(o(I)),1)):w("",!0)],2),As],32)])])])],512)])])):(l(),n("div",Ls,Gs))}}});const lt=xe(Ks,[["__scopeId","data-v-a0610431"]]);export{lt as default};
