var ds=Object.defineProperty;var n=(o,c)=>ds(o,"name",{value:c,configurable:!0});import{aa as B,q as S,d as cs,i as rs,r as i,C as w,P,o as f,c as m,e as s,t as u,F as g,R as _,T as b,af as G,U as ls,g as us,W as ps,X as fs,_ as ms}from"./main-9b499219.js";import{u as vs,e as T,c as x,a as d,f as hs,b as gs,V as _s}from"./useUnexpectedErrorHandler-f37df04f.js";import{Q as bs}from"./index-df77389a.js";import{d as ys}from"./useBoardRequest-2247a6a5.js";import{c as ws}from"./useCommitteeRequest-f6f4ffc4.js";import{a as xs}from"./useUserRequest-dfc5ef80.js";import{u as Ss}from"./useQuery-7facd994.js";import"./useQueryClient-0be5c548.js";const D=B("api/v1/discussions");B("api/v1/discussions/members");async function Ds(o,c){const r=S(),v=bs.stringify(c,{arrayFormat:"brackets"});return await r.get(D()+"/"+o+"?"+v).json()}n(Ds,"useGetUserDiscussionsRequest");async function ks(o,c){return(await S().post(D()+"/"+c,{json:o})).json()}n(ks,"useCreateDiscussionRequest");async function qs(o,c,r){return(await S().patch(D()+"/update/"+c+"/"+r,{json:o})).json()}n(qs,"useUpdateDiscussionRequest");const p=n(o=>(ps("data-v-5af6260f"),o=o(),fs(),o),"_withScopeId"),Cs={class:"row"},Vs={class:"col-lg-4"},Is={class:"card"},Ps=p(()=>s("div",{class:"card-header bg-primary"},[s("h3",{class:"card-title"},"Search Discussions")],-1)),Ts={class:"card-body"},Bs=G('<div class="input-group mb-3" data-v-5af6260f><div class="input-group-prepend" data-v-5af6260f><button class="btn btn-outline-secondary" type="button" data-v-5af6260f><i class="fas fa-search" data-v-5af6260f></i></button></div><input type="text" class="form-control rounded-end" placeholder="Search discussions" aria-label="Search discussions" data-v-5af6260f></div>',1),Gs={class:"flex gap-x-2"},Ms={class:"dropdown"},Us={class:"nav-link dropdown-toggle btn-sm btn btn-secondary btn-block p-1",href:"#",id:"sortDropdown",type:"button",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},As={class:"dropdown-menu","aria-labelledby":"navbarDropdown"},Fs=["onClick"],Es={class:"dropdown"},Ns={class:"nav-link dropdown-toggle btn-sm btn btn-secondary btn-block p-1",href:"#",id:"sortGroupDropdown",type:"button",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},Rs={class:"dropdown-menu","aria-labelledby":"navbarDropdown"},Ls=["onClick"],$s=p(()=>s("div",{class:"dropdown-divider"},null,-1)),js={class:"card-body p-0",style:{height:"500px","overflow-y":"auto"}},Os={class:"card-body d-flex align-items-center"},zs=p(()=>s("i",{class:"fas fa-user-circle fa-2x me-3"},null,-1)),Js={class:"flex-grow-1"},Qs={class:"mb-0"},Ks=p(()=>s("small",{class:"text-muted"},"Nyariki Felix",-1)),Hs={class:"mb-0"},Ws={class:"text-muted"},Xs=p(()=>s("a",{href:"#",class:"btn btn-sm btn-outline-secondary"},[s("i",{class:"far fa-star"})],-1)),Ys={class:"col-lg-8"},Zs={class:"card"},se={class:"flex items-center bg-success"},ee=p(()=>s("h3",{class:"ml-2 card-title"},"Discussion",-1)),ae={class:"ml-auto flex self-end"},te=p(()=>s("a",{class:"nav-link",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[s("i",{class:"fas fa-ellipsis-v"})],-1)),ie={class:"dropdown-menu dropdown-menu-end","aria-labelledby":"navbarDropdown"},ne=["onClick"],oe=p(()=>s("i",{class:"fas fa-users"},null,-1)),de=[oe],ce=G('<div class="card-header" data-v-5af6260f><h5 data-v-5af6260f>Topic testing</h5><span class="badge bg-secondary" data-v-5af6260f>Board</span></div><div class="card-body" data-v-5af6260f><div class="flex-1 mb-8" data-v-5af6260f><div class="bg-gray-200 text-gray-700 rounded-lg px-4 pt-1 pb-1" data-v-5af6260f><div class="text-xs font-medium subpixel-antialiased mb-2 text-gray-900" data-v-5af6260f><a href="#" class="text-gray-800" data-bs-original-title="" title="" data-v-5af6260f> Nyariki Felix </a> created this discussion on June 29, 2024 </div><div data-v-5af6260f><p data-v-5af6260f> testing  testing  testing  </p></div></div></div><div class="direct-chat-messages" data-v-5af6260f><div class="direct-chat-msg" data-v-5af6260f><div class="direct-chat-infos clearfix" data-v-5af6260f><span class="direct-chat-name float-left" data-v-5af6260f>Alexander Pierce</span><span class="direct-chat-timestamp float-right" data-v-5af6260f>23 Jan 2:00 pm</span></div><i class="fas fa-user-circle fa-2x me-3" data-v-5af6260f></i><div class="direct-chat-text" data-v-5af6260f> Is this template really for free? That&#39;s unbelievable! </div></div><div class="direct-chat-msg right" data-v-5af6260f><div class="direct-chat-infos clearfix" data-v-5af6260f><span class="direct-chat-name float-right" data-v-5af6260f>Sarah Bullock</span><span class="direct-chat-timestamp float-left" data-v-5af6260f>23 Jan 2:05 pm</span></div><i class="fas fa-user-circle fa-2x me-3" data-v-5af6260f></i><div class="direct-chat-text" data-v-5af6260f> You better believe it! </div></div></div></div><div class="card-footer" data-v-5af6260f><div class="input-group" data-v-5af6260f><input type="text" class="form-control" placeholder="Leave a comment" data-v-5af6260f><button class="btn btn-primary" type="button" data-v-5af6260f>Send</button></div></div>',3),re=cs({__name:"discussions",setup(o){var V;const c=rs();c.initialize();const r=i("latest"),v=i("board"),k=i(!1),q=i("create"),h=(V=c.user)==null?void 0:V.id,M=i(null);i([]),i([]),i([]),i(null);const U=i(null),A=i("individuals");i("");const F=i([]),E=i([]),N=i([]),R=vs();T("duedate"),T("discussionassignees");const L=x({id:d().required(),full_name:d().required()}),$=x({id:d().required(),discussion_id:d().nullable(),assignee_id:d().required(),user:L}),j=x({id:d().nullable(),topic:d().required(),description:d().required(),closestatus:d().required(),archivestatus:d().required(),assigneetype:d().required(),assigneestatus:d().required(),discussionassignees:hs().of($).nullable()}),{handleSubmit:O,setErrors:z,setFieldValue:l,values:le}=gs({validationSchema:j,initialValues:{id:"",topic:"",description:"",closestatus:"opened",archivestatus:"none",assigneetype:"",assigneestatus:"",discussionassignees:[]}});O(async e=>{var t;try{const a={id:e.id,topic:e.topic,description:e.description,closestatus:e.closestatus,archivestatus:e.archivestatus,assigneetype:e.assigneetype,assigneestatus:e.assigneestatus,discussionassignees:e.discussionassignees};q.value==="create"?await ks(a,h):await qs(a,h,a.id),(t=U.value)==null||t.close(),await C(),J()}catch(a){a instanceof _s?z(a.messages):R(a)}});const J=n(()=>{q.value="create",k.value=!1,M.value=null,A.value="all_members",selectedAssigneeIds.value=[],l("id",""),l("topic",""),l("description","description ................"),l("closestatus","opened"),l("archivestatus","none"),l("assigneetype","all_members"),l("assigneestatus","all_members"),l("discussionassignees",[])},"reset"),Q=[{id:"all-groups",name:"All Groups"},{id:"board",name:"Board"}],y=[{id:"latest",name:"Latest"},{id:"starred",name:"Starred"},{id:"unread",name:"Unread"},{id:"mentions",name:"Mentions"},{id:"archived",name:"Archived"}],K=[{id:"leave",name:"Leave Discussion",icon:"fas fa-sign-out-alt"},{id:"unread",name:"Mark as Unread",icon:"fas fa-envelope-open-text"},{id:"print",name:"Print",icon:"fas fa-print"},{id:"edit",name:"Edit Description",icon:"fas fa-edit"},{id:"close",name:"Close Discussion",icon:"fas fa-times"},{id:"delete",name:"Delete Discussion",icon:"far fa-trash-alt text-danger"}],H=i([{id:1,topic:"Vue 3 Composition API",content:"testing testing testing",lastPost:"7:57am"},{id:2,topic:"TypeScript in Vue",content:"testing testing testing",lastPost:"7:57am"},{id:2,topic:"TypeScript in Vue",content:"testing testing testing",lastPost:"7:57am"},{id:2,topic:"TypeScript in Vue",content:"testing testing testing",lastPost:"7:57am"},{id:2,topic:"TypeScript in Vue",content:"testing testing testing",lastPost:"7:57am"},{id:2,topic:"TypeScript in Vue",content:"testing testing testing",lastPost:"7:57am"}]),W=[{name:"Individuals",value:"individuals"},{name:"Assign All Meeting Members",value:"all_members"}];function X(e){r.value=e}n(X,"applySort");const Y=w(()=>{const e=y.find(t=>t.id===r.value);return e?e.name:"Latest"});function Z(e){v.value=e}n(Z,"applyGroupSort");const ss=w(()=>{const e=y.find(t=>t.id===r.value);return e?e.name:"Board"});function es(e){console.log("optionId",e)}n(es,"handleDiscussionOption"),P(()=>{window.dispatchEvent(new CustomEvent("updateTitle",{detail:"Discussions"}))}),w(()=>W);const as=n(()=>Ss({queryKey:["getDiscussionsKey",h],queryFn:async()=>(await Ds(h,{paginate:"false"})).data}),"getDiscussions"),{isLoading:ue,data:pe,refetch:C}=as(),ts=n(async()=>{const e=await ys({paginate:"false"});F.value=e.data.map(t=>({id:t.id,name:t.name,class:"board"}))},"getBoards"),is=n(async()=>{const e=await ws({paginate:"false"});E.value=e.data.map(t=>({id:t.id,name:t.name,class:"committee"}))},"getCommittees"),ns=n(async()=>{const e=await xs({paginate:"false"});N.value=e.data.map(t=>({id:t.id,name:t.full_name,class:"user"}))},"fetchUsers"),os=n(async()=>{await ns(),await ts(),await is()},"getAllMembers");return P(async()=>{os(),c.initialize(),C()}),(e,t)=>(f(),m("div",Cs,[s("div",Vs,[s("div",Is,[Ps,s("div",Ts,[Bs,s("div",Gs,[s("div",Ms,[s("button",Us,[s("span",null,u(Y.value),1)]),s("div",As,[(f(),m(g,null,_(y,a=>s("a",{key:a.id,href:"#",class:"dropdown-item",onClick:b(I=>X(a.id),["prevent"])},u(a.name),9,Fs)),64))])]),s("div",Es,[s("button",Ns,[s("span",null,u(ss.value),1)]),s("div",Rs,[(f(),m(g,null,_(Q,a=>s("a",{key:a.id,href:"#",class:"dropdown-item",onClick:b(I=>Z(a.id),["prevent"])},u(a.name),9,Ls)),64))])])]),$s,s("div",js,[(f(!0),m(g,null,_(H.value,a=>(f(),m("div",{key:a.id,class:"card mb-2 border border-primary hover:cursor-pointer"},[s("div",Os,[zs,s("div",Js,[s("h6",Qs,u(a.topic),1),Ks,s("p",Hs,u(a.content),1),s("small",Ws,u(a.lastPost),1)]),Xs])]))),128))])])])]),s("div",Ys,[s("div",Zs,[s("div",se,[ee,s("div",ae,[te,s("div",ie,[(f(),m(g,null,_(K,a=>s("a",{key:a.id,class:"dropdown-item",href:"#",onClick:b(I=>es(a.id),["prevent"])},[s("i",{class:ls(a.icon)},null,2),us(" "+u(a.name),1)],8,ne)),64))]),s("button",{class:"btn btn-sm text-white mr-2",onClick:t[0]||(t[0]=b(a=>e.openMemberModal(),["prevent"]))},de)])]),ce])])]))}});const xe=ms(re,[["__scopeId","data-v-5af6260f"]]);export{xe as default};
