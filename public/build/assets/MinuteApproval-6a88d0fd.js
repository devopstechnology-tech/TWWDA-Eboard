var ge=Object.defineProperty;var y=(k,I)=>ge(k,"name",{value:I,configurable:!0});import{d as fe,k as ye,j as xe,i as ke,n as Ae,r as p,V as Me,C as v,P as Se,H as we,o as s,c as a,e as t,a1 as ae,g as C,u as d,h as c,t as n,F as _,T as m,$ as Ee,a0 as Ce,_ as Ie}from"./main-d97516e2.js";import{u as Te,c as qe,d as Re,a as g,b as Le}from"./useUnexpectedErrorHandler-01ee037e.js";import{i as Ne,j as Fe,k as He,l as Pe,h as Oe,s as Ve,r as Be}from"./useMinuteRequest-40fb106c.js";import{B as De,f as Ge,C as le,D}from"./Breadcrumb-62de853f.js";import{u as Ue}from"./useQuery-f8736dfe.js";import"./index-a4206e89.js";import"./useQueryClient-99479e2d.js";const x=y(k=>(Ee("data-v-02a32e98"),k=k(),Ce(),k),"_withScopeId"),$e={class:"card card-widget shadow-lg"},je={class:"card-footer"},Ke={class:"d-flex align-items-center"},We={class:"ml-3 flex-1"},Ye=x(()=>t("i",{class:"fas fa-chevron-left"},null,-1)),ze={key:0,class:"ml-auto flex self-end"},Qe={key:0,type:"button",class:"btn btn-sm mr-1 btn-success btn-lg"},Je=x(()=>t("i",{class:"fas fa-door-closed mr-1"},null,-1)),Xe={key:1,type:"button",class:"btn btn-sm mr-1 btn-warning btn-lg"},Ze=x(()=>t("i",{class:"fa fa-check mr-1"},null,-1)),et=x(()=>t("i",{class:"fa fa-check mr-1"},null,-1)),tt={key:0,class:"card"},st={class:"card-body"},at=x(()=>t("span",{class:"info-box-icon",style:{left:"4%","margin-left":"-45px",position:"absolute",top:"88px"}},[t("div",{class:"h3 text-bold font-bold uppercase text-primary"}," Confidential")],-1)),lt={class:"text-center logo-container"},nt=["src"],it={class:"h3 text-center text-primary text-bold font-bold uppercase"},ot=x(()=>t("hr",{class:"thick-line"},null,-1)),rt={class:"text-center text-primary text-bold uppercase h4"},dt={class:"text-center text-primary text-bold uppercase h4"},ut={key:0,class:"mt-1 text-primary text-bold uppercase"},ct={key:1,class:"table table-borderless"},_t={class:"p-0"},pt={class:"p-0 text-primary text-bold uppercase"},mt={key:2,class:"mt-2 text-primary text-bold uppercase"},ht={key:3,class:"table table-borderless"},bt={class:"p-0"},vt={class:"p-0 text-primary text-bold uppercase"},gt={key:4,class:"mt-2 text-primary text-bold uppercase"},ft={key:5,class:"table table-borderless"},yt={class:"p-0"},xt={class:"p-0 text-primary text-bold uppercase"},kt={key:6,class:"mt-2 text-primary text-bold uppercase"},At={key:7,class:"table table-borderless"},Mt={class:"p-0"},St={class:"p-0 text-primary text-bold uppercase"},wt=x(()=>t("h5",{class:"mt-2 text-primary text-bold uppercase"},"Agenda",-1)),Et={class:"list-unstyled"},Ct={class:"list-unstyled ml-4"},It={id:"MinutesEditor",class:"container"},Tt={class:"codex-editor"},qt={class:"codex-editor__redactor",style:{"padding-bottom":"300px"}},Rt={class:"ce-block"},Lt={class:"flex w-full"},Nt={class:"flex-1"},Ft={key:0,"data-list_format":"num_la_lr",class:"agenda-list mb-0"},Ht={class:"rounded-lg border border-transparent hover:cursor-pointer border-blue -ml-7 p-2 pl-7 relative border-blue"},Pt={class:"flex gap-2 items-start"},Ot={class:"font-medium flex-1"},Vt={class:"font-bold text-primary"},Bt=["innerHTML"],Dt={key:0,class:"min-h-6"},Gt={class:"rounded-lg border border-transparent hover:cursor-pointer border-blue -ml-7 p-2 pl-7 relative border-blue"},Ut={class:"flex gap-2 items-start"},$t={class:"font-medium flex-1"},jt={class:"font-bold text-primary"},Kt=["innerHTML"],Wt=fe({__name:"MinuteApproval",setup(k){const I=ye();function ne(){I.back()}y(ne,"goBack");const S=xe();ke();const ie=Ae(),T=S.params.committeeId;S.params.meetingId;const b=S.params.scheduleId;S.params.minutesId;const A=p(null),w=p("create"),E=p(!1),G=p([]),U=p(null),oe=p(null),q=p(-1),R=p(-1),$=p(!1),L=p(!1),re=p([{text:""}]),de=Te(),ue=qe({schedule_id:Re().required(),committee_id:g().nullable(),membership_id:g().nullable(),minute_id:g().nullable(),agenda_id:g().required(),detail_minute_id:g().nullable(),subdetailminute_id:g().nullable(),subagenda_id:g().nullable(),description:g().required(),status:g().required()}),{handleSubmit:ce,setErrors:_e,setFieldValue:h,values:Yt}=Le({validationSchema:ue,initialValues:{schedule_id:b,committee_id:T,membership_id:null,minute_id:A.value,agenda_id:"",detail_minute_id:null,subdetailminute_id:null,subagenda_id:null,description:"",status:"unpublished"}});ce(async(e,{resetForm:i})=>{try{const o={schedule_id:e.schedule_id,committee_id:T,membership_id:null,minute_id:A.value?A.value.toString():null,agenda_id:e.agenda_id.toString(),detail_minute_id:e.detail_minute_id?e.detail_minute_id.toString():null,subdetailminute_id:e.subdetailminute_id?e.subdetailminute_id.toString():null,subagenda_id:e.subagenda_id?e.subagenda_id.toString():null,description:e.description,status:e.status};w.value==="create"?E.value?await Ne(o,b):L.value&&await Fe(o,b):q.value!==-1?(await He(o,b),console.log("payload",o)):R.value!==-1&&await Pe(o,b),await N(),pe()}catch(o){o instanceof Me?_e(o.messages):de(o)}});const pe=y(()=>{w.value="create",E.value=!1,U.value=null,oe.value=null,q.value=-1,R.value=-1,$.value=!1,L.value=!1,h("schedule_id",b),h("committee_id",T),h("membership_id",null),h("minute_id",A.value),h("agenda_id",""),h("detail_minute_id",null),h("subdetailminute_id",null),h("subagenda_id",null),h("description",""),h("status","unpublished")},"reset");v(()=>{const e=E.value&&U.value===agenda.id&&R.value===pIndex&&q.value===cIndex&&w.value==="create";return console.log("isAddingChild computed:",e),e}),v(()=>{const e=$.value&&!L.value&&!E.value&&w.value==="edit";return console.log("isEditing computed:",e),e});const me=y(()=>Ue({queryKey:["getMinutesKey",b],queryFn:async()=>{const e=await Be(b,{paginate:"false"});return A.value=e.data.id,e.data},onSuccess:e=>{},onError:e=>{console.error("Failed to fetch minutes:",e)}}),"getMinutes"),{isLoading:zt,data:r,refetch:N}=me(),F=v(()=>{var e;return((e=r.value)==null?void 0:e.attendances.filter(i=>i.rsvp_status==="Yes"&&i.attendance_status==="Attended"))||[]}),H=v(()=>{var e;return((e=r.value)==null?void 0:e.attendances.filter(i=>i.rsvp_status==="Online"&&i.attendance_status==="Attended"))||[]}),P=v(()=>{var e;return((e=r.value)==null?void 0:e.attendances.filter(i=>["Yes","No","Maybe"].includes(i.rsvp_status)&&i.attendance_status==="Absent"))||[]}),O=v(()=>{var e;return((e=r.value)==null?void 0:e.attendances.filter(i=>i.rsvp_status==="Pending"&&i.attendance_status==="Absent"))||[]}),he=y(async()=>{const e=await Oe(b,{paginate:"false"});G.value=e.data},"getmeetingagendas"),V=v(()=>G.value);Se(async()=>{await N(),he()}),we(()=>re.value,e=>{e&&(A.value=e)},{deep:!0});const B=v(()=>{const e={};return r.value&&r.value.detailminutes&&r.value.detailminutes.forEach(i=>{e[i.agenda_id]||(e[i.agenda_id]=[]),e[i.agenda_id].push(i),i.subdetailminutes.forEach(o=>{e[o.subagenda_id]||(e[o.subagenda_id]=[]),e[o.subagenda_id].push(o)})}),e}),j=v(()=>ie.getSettings()),be=y(async e=>{await Ve(e),await N()},"onAcceptCEOApproval");return(e,i)=>{var o,K,W,Y,z,Q,J,X,Z,ee,te;return s(),a(_,null,[t("div",$e,[t("div",je,[t("div",Ke,[t("div",We,[t("a",{href:"",onClick:ae(ne,["prevent"]),class:"text-blue-primary"},[Ye,C(" Go back To Meeting ")])]),d(r)?(s(),a("div",ze,[((o=d(r).schedule)==null?void 0:o.closestatus)==="closed"?(s(),a("button",Qe,[Je,C(" Meeting Closed ")])):c("",!0),d(r).approvalstatus==="approved"?(s(),a("button",Xe,[Ze,C(" This Minutes are Approved ")])):(s(),a("button",{key:2,type:"button",class:"btn btn-sm mr-1 btn-warning btn-lg",onClick:i[0]||(i[0]=ae(l=>be(d(r).id),["prevent"]))},[et,C(" Click here to Approve This Minutes ")]))])):c("",!0)])])]),d(r)?(s(),a("div",tt,[t("div",st,[at,t("div",lt,[t("img",{src:d(De)((K=j.value)==null?void 0:K.logo),alt:"Organization Logo",class:"img-fluid logo"},null,8,nt)]),t("div",it,n((W=j.value)==null?void 0:W.name),1),ot,t("h4",rt,"MINUTES OF THE "+n((z=(Y=d(r))==null?void 0:Y.meeting)==null?void 0:z.title),1),t("p",dt," HELD AT "+n((J=(Q=d(r))==null?void 0:Q.meeting)==null?void 0:J.location)+" ON "+n(d(Ge)((Z=(X=d(r))==null?void 0:X.schedule)==null?void 0:Z.date))+" STARTING AT "+n((te=(ee=d(r))==null?void 0:ee.schedule)==null?void 0:te.start_time),1),F.value.length?(s(),a("h5",ut,"Present")):c("",!0),F.value.length?(s(),a("table",ct,[t("tbody",null,[(s(!0),a(_,null,m(F.value,(l,u)=>(s(),a("tr",{key:l.id},[t("td",_t,n(u+1)+". "+n(l.membership.user.full_name),1),t("td",pt," - "+n(l.membership.position.name),1)]))),128))])])):c("",!0),H.value.length?(s(),a("h5",mt,"Present on E-platform ")):c("",!0),H.value.length?(s(),a("table",ht,[t("tbody",null,[(s(!0),a(_,null,m(H.value,(l,u)=>(s(),a("tr",{key:l.id},[t("td",bt,n(u+1)+". "+n(l.membership.user.full_name),1),t("td",vt," - "+n(l.membership.position.name),1)]))),128))])])):c("",!0),P.value.length?(s(),a("h5",gt,"Absent With Apology ")):c("",!0),P.value.length?(s(),a("table",ft,[t("tbody",null,[(s(!0),a(_,null,m(P.value,(l,u)=>(s(),a("tr",{key:l.id},[t("td",yt,n(u+1)+". "+n(l.membership.user.full_name),1),t("td",xt," - "+n(l.membership.position.name),1)]))),128))])])):c("",!0),O.value.length?(s(),a("h5",kt," Absent ")):c("",!0),O.value.length?(s(),a("table",At,[t("tbody",null,[(s(!0),a(_,null,m(O.value,(l,u)=>(s(),a("tr",{key:l.id},[t("td",Mt,n(u+1)+". "+n(l.membership.user.full_name),1),t("td",St," - "+n(l.membership.position.name),1)]))),128))])])):c("",!0),wt,t("ul",Et,[(s(!0),a(_,null,m(V.value,(l,u)=>(s(),a(_,{key:l.id},[t("li",null,n(u+1)+". "+n(l.title),1),t("ul",Ct,[(s(!0),a(_,null,m(l.children,(f,M)=>(s(),a("li",{key:f.id},n(u+1)+"."+n(M+1)+" "+n(f.title),1))),128))])],64))),128))])]),t("div",It,[t("div",Tt,[t("div",qt,[t("div",Rt,[t("div",Lt,[t("div",Nt,[V.value?(s(),a("ol",Ft,[(s(!0),a(_,null,m(V.value,(l,u)=>(s(),a("li",{class:"mb-2 hover:border-gray-400",key:u},[t("div",Ht,[t("div",Pt,[t("div",Ot,[(s(!0),a(_,null,m(B.value[l.id],(f,M)=>(s(),a("div",{key:M},[t("div",Vt,n(d(le)(d(D)(u),l.title)),1),t("div",{innerHTML:f.description},null,8,Bt)]))),128))])])]),l.children?(s(),a("ol",Dt,[(s(!0),a(_,null,m(l.children,(f,M)=>(s(),a("li",{class:"mb-2 hover:border-gray-400",draggable:"false",key:M},[t("div",Gt,[t("div",Ut,[t("div",$t,[t("div",jt,n(d(le)(d(D)(u),f.title,void 0,void 0,void 0,d(D)(M))),1),(s(!0),a(_,null,m(B.value[l.id],(Qt,ve)=>(s(),a("div",{key:ve},[(s(!0),a(_,null,m(B.value[f.id],se=>(s(),a("div",{key:se.id},[t("div",{innerHTML:se.description},null,8,Kt)]))),128))]))),128))])])])]))),128))])):c("",!0)]))),128))])):c("",!0)])])])])])])])):c("",!0)],64)}}});const ns=Ie(Wt,[["__scopeId","data-v-02a32e98"]]);export{ns as default};
