var mt=Object.defineProperty;var h=(y,f)=>mt(y,"name",{value:f,configurable:!0});import{u as ft,a as vt}from"./useAlmanacRequest-a5bd94bd.js";import{u as pt}from"./useBoardRequest-eb8bdd66.js";import{u as gt}from"./useCommitteeRequest-787b5c72.js";import{u as bt}from"./useMeetingRequest-eac1459b.js";import{u as yt}from"./usePollRequest-97611322.js";import{u as wt}from"./useTaskRequest-3c5f3f5d.js";import{a as xt}from"./useUserRequest-19f3a11e.js";import{d as J,i as tt,r as _,H as Ct,P as st,o,c as r,e as t,f as m,w as d,R as kt,t as i,u as l,h as g,_ as et,C as k,b as At,g as p,F as L,T as S,U as Y,W as Z,X as R,Y as j,l as W,Z as $t,$ as qt,a0 as Lt}from"./main-d97516e2.js";import{l as St,f as Kt}from"./Breadcrumb-62de853f.js";import{i as Pt,F as Mt}from"./FullCalendar-41f8ba0b.js";import{u as Tt}from"./useScheduleRequest-76e80e8c.js";import{u as b}from"./useQuery-f8736dfe.js";import"./index-a4206e89.js";import"./useQueryClient-99479e2d.js";const Bt={class:"card"},Dt={class:"card-body"},Ft={key:0},It=J({__name:"calendar",setup(y){tt();const f=_({plugins:[Pt],initialView:"dayGridMonth",editable:!0,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:!0,events:[]}),T=h(()=>b({queryKey:["getCalendarAlmanacsKey"],queryFn:async()=>(await ft({paginate:"false"})).data.map(K("almanac"))}),"getAlmanacs"),{isLoading:B,data:G,refetch:D}=T(),V=h(()=>b({queryKey:["getCalendarSchedulesKey"],queryFn:async()=>(await Tt({paginate:"false"})).data.map(K("meeting"))}),"getSchedules"),{isLoading:F,data:N,refetch:I}=V();function K(c){return s=>{var v,x;return{id:s.id,title:c==="meeting"?(v=s.meeting)==null?void 0:v.title:s.type,start:w(c==="meeting"?`${s.date} ${s.start_time}`:`${s.start}`),end:w(c==="meeting"?`${s.date} ${s.end_time}`:`${s.end}`),description:c==="meeting"?(x=s.meeting)==null?void 0:x.title:s.purpose,color:U(s,c),textColor:"#fff"}}}h(K,"formatEvent");function w(c){const s=c.split(/[- :\.]/);if(s.length===3)return s[0].length===4?`${s[0]}-${s[1]}-${s[2]}`:`${s[2]}-${s[1]}-${s[0]}`;if(s.length>=5){const[v,x,P,C,A]=s.slice(0,5).map(Number),$=s[5]?s[5].toLowerCase():"";let q=C;return $==="pm"&&C<12?q+=12:$==="am"&&C===12&&(q=0),s[0].length===4?`${s[0]}-${s[1]}-${s[2]}T${String(q).padStart(2,"0")}:${String(A).padStart(2,"0")}`:`${s[2]}-${s[1]}-${s[0]}T${String(q).padStart(2,"0")}:${String(A).padStart(2,"0")}`}return c}h(w,"convertToISOFormat");function U(c,s){var $;const v=new Date,x=new Date(s==="meeting"?`${c.date} ${c.start_time}`:c.start),P={almanac:{base:"bg-warning text-dark",approved:"bg-success text-white",upcoming:"bg-primary text-white",past:"bg-secondary text-white"},meeting:{base:"bg-info text-white",published:"bg-success text-white",unpublished:"bg-warning text-dark",past:"bg-secondary text-white"}},C={published:"published",unpublished:"unpublished"};if(x<v)return P[s].past;const A=s==="meeting"?C[($=c.meeting)==null?void 0:$.status]:c.status;return P[s][A]||P[s].base}return h(U,"determineColor"),Ct([G,N],([c,s])=>{c&&s&&(f.value.events=[...c,...s])},{immediate:!0}),st(()=>{D(),I()}),(c,s)=>(o(),r("div",Bt,[t("div",Dt,[m(l(Mt),{options:f.value},{eventContent:d(v=>[t("div",{class:kt([v.event.extendedProps.color,"p-1 rounded"])},[t("b",null,i(v.timeText),1),t("i",null,i(v.event.title),1)],2)]),_:1},8,["options"]),l(B)||l(F)?(o(),r("div",Ft,"Loading...")):g("",!0)])]))}});const Ut=et(It,[["__scopeId","data-v-8677ebbe"]]),n=h(y=>(qt("data-v-30d4f344"),y=y(),Lt(),y),"_withScopeId"),Rt={class:"content"},Gt={class:"container-fluid"},Vt={class:"row"},Nt={class:"col-lg-3 col-6"},Et={class:"small-box bg-primary"},Ot={class:"inner"},Ht=n(()=>t("p",null,"Tasks",-1)),zt=n(()=>t("div",{class:"icon"},[t("i",{class:"fas fa-shopping-bag"})],-1)),Qt=n(()=>t("i",{class:"fas fa-arrow-circle-right"},null,-1)),Wt={class:"col-lg-3 col-6"},Xt={class:"small-box bg-primary"},Yt={class:"inner"},Zt=n(()=>t("p",null,"Polls",-1)),jt=n(()=>t("div",{class:"icon"},[t("i",{class:"fas fa-chart-bar"})],-1)),Jt=n(()=>t("i",{class:"fas fa-arrow-circle-right"},null,-1)),ts={class:"col-lg-3 col-6"},ss={class:"small-box bg-primary"},es={class:"inner"},as=n(()=>t("p",null,"Almanacs",-1)),os=n(()=>t("div",{class:"icon"},[t("i",{class:"fas fa-user-plus"})],-1)),ns=n(()=>t("i",{class:"fas fa-arrow-circle-right"},null,-1)),ls={class:"col-lg-3 col-6"},cs={class:"small-box bg-primary"},rs={class:"inner"},is=n(()=>t("p",null,"Users",-1)),ds=n(()=>t("div",{class:"icon"},[t("i",{class:"fas fa-chart-pie"})],-1)),us=n(()=>t("i",{class:"fas fa-arrow-circle-right"},null,-1)),_s={class:"row"},hs={key:0,class:"col-lg-6 col-6"},ms={class:"card"},fs=n(()=>t("div",{class:"card-header border-transparent"},[t("h3",{class:"card-title"},"Latest Boards")],-1)),vs={class:"card-body p-0"},ps={class:"table-responsive"},gs={class:"table m-0"},bs=n(()=>t("thead",null,[t("tr",null,[t("th",null,"Board Name"),t("th",null,"Members Count"),t("th",null,"Actions")])],-1)),ys={class:"mb-2"},ws=n(()=>t("i",{class:"fa fa-eye"},null,-1)),xs={key:0,class:"card-footer clearfix"},Cs={key:1,class:"col-lg-6 col-6"},ks={class:"card"},As=n(()=>t("div",{class:"card-header border-transparent"},[t("h3",{class:"card-title"},"Latest Committees")],-1)),$s={class:"card-body p-0"},qs={class:"table-responsive"},Ls={class:"table m-0"},Ss=n(()=>t("thead",null,[t("tr",null,[t("th",null,"Committee Name"),t("th",null,"Members Count"),t("th",null,"Actions")])],-1)),Ks={class:"mb-2"},Ps=n(()=>t("i",{class:"fa fa-eye"},null,-1)),Ms={class:"row"},Ts={key:0,class:"col-lg-9 col-6"},Bs={class:"card"},Ds=n(()=>t("div",{class:"card-header border-transparent"},[t("h3",{class:"card-title"},"Latest Almanacs")],-1)),Fs={class:"card-body p-0"},Is={class:"table-responsive"},Us={class:"table m-0"},Rs=n(()=>t("thead",null,[t("tr",null,[t("th",null,"Type"),t("th",null,"Budget"),t("th",null,"Held"),t("th",null,"Actions")])],-1)),Gs={class:"mb-2"},Vs=n(()=>t("i",{class:"fa fa-eye"},null,-1)),Ns={key:0,class:"card-footer clearfix"},Es={class:"col-lg-3 col-6"},Os={class:"row"},Hs={class:"col-lg-4 col-6"},zs={class:"card"},Qs=n(()=>t("div",{class:"card-header"},[t("h3",{class:"card-title"},"My Tasks")],-1)),Ws={class:"card-body p-0 m-1"},Xs=n(()=>t("span",{class:"info-box-icon"},[t("i",{class:"far fa-comment"})],-1)),Ys={class:"info-box-content"},Zs={class:"info-box-text"},js={class:"info-box-number"},Js={key:0,class:"card-footer text-center"},te={class:"col-lg-4 col-6"},se={class:"card"},ee={class:"card-header"},ae=n(()=>t("h3",{class:"card-title"},"Latest Users",-1)),oe={class:"card-tools"},ne={class:"badge badge-danger"},le={class:"card-body p-0"},ce={class:"users-list clearfix"},re=["src"],ie={class:"users-list-name",href:"#"},de={class:"users-list-date"},ue={key:0,class:"card-footer text-center"},_e={class:"col-lg-4 col-6"},he={class:"card"},me=n(()=>t("div",{class:"card-header"},[t("h3",{class:"card-title"},"My Polls")],-1)),fe={class:"card-body p-0 m-1"},ve=n(()=>t("span",{class:"info-box-icon"},[t("i",{class:"far fa-comment"})],-1)),pe={class:"info-box-content"},ge={class:"info-box-text"},be={class:"info-box-number"},ye={key:0,class:"card-footer text-center"},we=J({__name:"Dashboard",setup(y){const f=tt(),T=_(null),B=_([]),G=_(null),D=_([]),V=_(null),F=_([]),N=_(null),I=_([]),K=_(null),w=_([]),U=_(null),c=_([]),s=_(null),v=_([]),x=h(()=>b({queryKey:["getLatestBoardsKey"],queryFn:async()=>{const a=await pt({paginate:"false"});return G.value=a.data.count,D.value=a.data.boards,a.data}}),"getBoards"),{data:P,refetch:C}=x(),A=h(()=>b({queryKey:["getLatestCommitteesKey"],queryFn:async()=>{const a=await gt({paginate:"false"});return V.value=a.data.count,F.value=a.data.committees,a.data}}),"getCommittees"),{data:$,refetch:q}=A(),at=h(()=>b({queryKey:["getLatestMeetingsKey"],queryFn:async()=>{const a=await bt({paginate:"false"});return N.value=a.data.count,I.value=a.data.meetings,a.data}}),"getMeetings"),{data:xe,refetch:ot}=at(),nt=h(()=>b({queryKey:["getLatestTasksKey"],queryFn:async()=>{const a=await wt({paginate:"false"});return T.value=a.data.count,B.value=a.data.tasks,a.data}}),"getTasks"),{data:Ce,refetch:lt}=nt(),ct=h(()=>b({queryKey:["getLatestPollsKey"],queryFn:async()=>{const a=await yt({paginate:"false"});return K.value=a.data.count,w.value=a.data.polls,a.data}}),"getPolls"),{data:ke,refetch:rt}=ct(),it=h(()=>b({queryKey:["getLatestAlmanacsKey"],queryFn:async()=>{const a=await vt({paginate:"false"});return U.value=a.data.count,c.value=a.data.almanacs,a.data}}),"getAlmanacs"),{data:Ae,refetch:dt}=it(),ut=h(()=>b({queryKey:["getLatestUsersKey"],queryFn:async()=>{const a=await xt({paginate:"false"});return s.value=a.data.count,v.value=a.data.users,a.data}}),"getUsers"),{data:$e,refetch:_t}=ut(),E=k(()=>D.value),O=k(()=>B.value),ht=k(()=>F.value);k(()=>I.value);const H=k(()=>w.value),z=k(()=>c.value),Q=k(()=>v.value);return st(async()=>{window.dispatchEvent(new CustomEvent("updateTitle",{detail:"Dashboard"})),await C(),await q(),await ot(),await lt(),await rt(),await dt(),await _t()}),(a,qe)=>{const u=At("router-link");return o(),r("section",Rt,[t("div",Gt,[t("div",Vt,[t("div",Nt,[t("div",Et,[t("div",Ot,[t("h3",null,i(T.value),1),Ht]),zt,m(u,{to:{name:l(Y)},class:"small-box-footer"},{default:d(()=>[p(" More info "),Qt]),_:1},8,["to"])])]),t("div",Wt,[t("div",Xt,[t("div",Yt,[t("h3",null,i(K.value),1),Zt]),jt,m(u,{to:{name:l(Z)},class:"small-box-footer"},{default:d(()=>[p(" More info "),Jt]),_:1},8,["to"])])]),t("div",ts,[t("div",ss,[t("div",es,[t("h3",null,i(U.value),1),as]),os,m(u,{to:{name:l(R)},class:"small-box-footer"},{default:d(()=>[p(" More info "),ns]),_:1},8,["to"])])]),t("div",ls,[t("div",cs,[t("div",rs,[t("h3",null,i(s.value),1),is]),ds,m(u,{to:{name:l(j)},class:"small-box-footer"},{default:d(()=>[p(" More info "),us]),_:1},8,["to"])])])]),t("div",_s,[l(f).hasPermission(["view board"])?(o(),r("div",hs,[t("div",ms,[fs,t("div",vs,[t("div",ps,[t("table",gs,[bs,t("tbody",null,[(o(!0),r(L,null,S(E.value,e=>(o(),r("tr",{key:e.id},[t("td",null,[t("h3",ys,[m(u,{to:{name:"BoardDetails",params:{boardId:e.id}},class:"text-primary"},{default:d(()=>[p(i(e.name),1)]),_:2},1032,["to"])])]),t("td",null,i(e.members.length),1),t("td",null,[l(f).hasPermission(["view board"])?(o(),W(u,{key:0,to:{name:"BoardDetails",params:{boardId:e.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:d(()=>[ws]),_:2},1032,["to"])):g("",!0)])]))),128))])])])]),E.value&&E.value.length?(o(),r("div",xs,[m(u,{to:{name:l($t)},class:"btn btn-sm btn-secondary float-right"},{default:d(()=>[p(" View All Boards ")]),_:1},8,["to"])])):g("",!0)])])):g("",!0),l(f).hasPermission(["view committee"])?(o(),r("div",Cs,[t("div",ks,[As,t("div",$s,[t("div",qs,[t("table",Ls,[Ss,t("tbody",null,[(o(!0),r(L,null,S(ht.value,e=>{var M,X;return o(),r("tr",{key:e.id},[t("td",null,[t("h3",Ks,[m(u,{to:{name:"CommitteeDetails",params:{committeeId:e.id,boardId:(M=e.committeeable)==null?void 0:M.id}},class:"text-primary"},{default:d(()=>[p(i(e.name),1)]),_:2},1032,["to"])])]),t("td",null,i(e.members.length),1),t("td",null,[l(f).hasPermission(["view committee"])?(o(),W(u,{key:0,to:{name:"CommitteeDetails",params:{committeeId:e.id,boardId:(X=e.committeeable)==null?void 0:X.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:d(()=>[Ps]),_:2},1032,["to"])):g("",!0)])])}),128))])])])])])])):g("",!0)]),t("div",Ms,[l(f).hasPermission(["view almanac"])?(o(),r("div",Ts,[t("div",Bs,[Ds,t("div",Fs,[t("div",Is,[t("table",Us,[Rs,t("tbody",null,[(o(!0),r(L,null,S(z.value,e=>(o(),r("tr",{key:e.id},[t("td",null,[t("h3",Gs,[m(u,{to:{name:l(R)},class:"text-primary"},{default:d(()=>[p(i(e.type),1)]),_:2},1032,["to"])])]),t("td",null,"Kshs. "+i(e.budget),1),t("td",null,i(e.held),1),t("td",null,[l(f).hasPermission(["view almanac"])?(o(),W(u,{key:0,to:{name:l(R)},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:d(()=>[Vs]),_:1},8,["to"])):g("",!0)])]))),128))])])])]),l(f).hasPermission(["view almanac"])&&z.value&&z.value.length?(o(),r("div",Ns,[m(u,{to:{name:l(R)},class:"btn btn-sm btn-secondary float-right"},{default:d(()=>[p(" View All Almanacs ")]),_:1},8,["to"])])):g("",!0)])])):g("",!0),t("div",Es,[m(Ut)])]),t("div",Os,[t("div",Hs,[t("div",zs,[Qs,t("div",Ws,[(o(!0),r(L,null,S(O.value,e=>(o(),r("div",{class:"info-box mb-3 bg-primary",key:e.id},[Xs,t("div",Ys,[t("span",Zs,i(e.title),1),t("span",js,"Assingess: "+i(e.taskassignees.length),1)])]))),128))]),O.value&&O.value.length?(o(),r("div",Js,[m(u,{to:{name:l(Y)},class:"btn btn-sm btn-secondary float-right"},{default:d(()=>[p(" View All Tasks ")]),_:1},8,["to"])])):g("",!0)])]),t("div",te,[t("div",se,[t("div",ee,[ae,t("div",oe,[t("span",ne,i(s.value)+" New Users",1)])]),t("div",le,[t("ul",ce,[(o(!0),r(L,null,S(Q.value,e=>{var M;return o(),r("li",{key:e.id},[t("img",{src:l(St)((M=e.profile)==null?void 0:M.avatar),alt:"User Image"},null,8,re),t("a",ie,i(e.full_name),1),t("span",de,i(l(Kt)(e.created_at)),1)])}),128))])]),l(f).hasPermission(["view users"])&&Q.value&&Q.value.length?(o(),r("div",ue,[m(u,{to:{name:l(j)},class:"btn btn-sm btn-secondary float-right"},{default:d(()=>[p(" View All Users ")]),_:1},8,["to"])])):g("",!0)])]),t("div",_e,[t("div",he,[me,t("div",fe,[(o(!0),r(L,null,S(H.value,e=>(o(),r("div",{class:"info-box mb-3 bg-primary",key:e.id},[ve,t("div",pe,[t("span",ge,i(e.question),1),t("span",be,i(e.pollassignees.length),1)])]))),128))]),H.value&&H.value.length?(o(),r("div",ye,[m(u,{to:{name:l(Z)},class:"btn btn-sm btn-secondary float-right"},{default:d(()=>[p(" View All Polls ")]),_:1},8,["to"])])):g("",!0)])])])])])}}});const Ee=et(we,[["__scopeId","data-v-30d4f344"]]);export{Ee as default};
