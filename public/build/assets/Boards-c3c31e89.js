var ge=Object.defineProperty;var u=(k,v)=>ge(k,"name",{value:v,configurable:!0});import{d as xe,i as ye,r as f,V as O,C as Q,P as we,b as z,u as o,o as n,c,e,T as b,g as w,F as W,R as X,t as d,f as C,U as Y,h as _,w as q,l as J,W as Ce,X as ke,_ as Be}from"./main-451c20d4.js";import{u as Me,d as Ie,c as qe,a as Z,b as Se,e as Ue}from"./useUnexpectedErrorHandler-2f1b2730.js";import{a as Ee,b as Fe,c as ee,d as $e,e as De}from"./useBoardRequest-61ad7599.js";import{a as Pe,b as Re,c as Ve,d as Te}from"./useCommitteeRequest-fdd0f16f.js";import{u as je}from"./useStaffRequest-4d0920bc.js";import{F as Le}from"./FormInput-4bdc1ca0.js";import{F as Ne}from"./FormQuillEditor-e4b30354.js";import{F as te}from"./FormUpload-637793d3.js";import{r as Ae,a as He,l as se,s as ae,i as Ke,u as oe,c as Ge,b as ie}from"./Breadcrumb-ecf3abcd.js";import{u as le}from"./useQuery-64b3e593.js";import"./index-053adef9.js";import"./staff_routes-45a2bbdb.js";import"./useQueryClient-78663db9.js";const r=u(k=>(Ce("data-v-25b58cc6"),k=k(),ke(),k),"_withScopeId"),Oe={key:0,class:"container-fluid"},Qe={class:"row"},ze={class:"col-12"},We={class:"card"},Xe={class:"card-header d-flex justify-content-between"},Ye=r(()=>e("h1",{class:"h2 mb-2"},"Boards & Committees",-1)),Je=r(()=>e("i",{class:"fa fa-plus mr-2"},null,-1)),Ze={class:"card-body"},et={class:"row"},tt={class:"col-md-6 col-12"},st=["src"],at={class:"ml-3 flex-1"},ot={key:0,class:"h2 mb-2"},it={class:"text-gray-900 m-0"},lt={key:1},nt=r(()=>e("br",null,null,-1)),rt=["onClick"],ct=r(()=>e("i",{class:"fa fa-plus mr-2"},null,-1)),dt=["innerHTML"],mt={class:"d-flex justify-content-end mt-2"},ut=["onClick"],vt=r(()=>e("i",{class:"fa fa-edit"},null,-1)),ht=[vt],_t=["onClick"],ft=r(()=>e("i",{class:"fa fa-trash-alt"},null,-1)),pt=[ft],bt=r(()=>e("i",{class:"fa fa-eye"},null,-1)),gt=["onClick"],xt=r(()=>e("i",{class:"fa fa-plus mr-1"},null,-1)),yt={class:"col-md-6 col-12"},wt=["src"],Ct={class:"ml-3 flex-1"},kt={class:"h2 mb-2"},Bt={class:"mb-1"},Mt={class:"text-gray-900 m-0"},It={key:0},qt=r(()=>e("br",null,null,-1)),St=["onClick"],Ut=r(()=>e("i",{class:"fa fa-plus mr-2"},null,-1)),Et=["innerHTML"],Ft={class:"d-flex justify-content-end mt-2"},$t=["onClick"],Dt=r(()=>e("i",{class:"fa fa-edit"},null,-1)),Pt=[Dt],Rt=["onClick"],Vt=r(()=>e("i",{class:"fa fa-trash-alt"},null,-1)),Tt=[Vt],jt=r(()=>e("i",{class:"fa fa-eye"},null,-1)),Lt={class:"flex justify-center items-center min-h-screen"},Nt={method:"dialog",class:"modal-box rounded-xl relative bg-white shadow-xl"},At={class:"font-bold text-lg text-center"},Ht=r(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Kt={class:"overflow-auto p-4",style:{"max-height":"80vh"}},Gt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 p-2"},Ot={class:"col-span-2"},Qt={class:"flex flex-wrap -mx-2"},zt={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Wt={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Xt=["src"],Yt={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Jt=["src"],Zt={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},es={class:"flex justify-center col-md-6"},ts={method:"dialog",class:"modal-box rounded-xl"},ss=r(()=>e("h3",{class:"font-bold text-lg justify-center flex"},d("Add Members"),-1)),as=r(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),os={class:"w-full mt-6 p-2"},is={class:"font-thin text-sm flex flex-col items-center gap-6"},ls={key:0,class:"message"},ns=r(()=>e("button",{type:"submit",class:"btn btn-md mb-1 w-full pt-1 text-red-600 mt-6 bg-primary"},d("Add Members"),-1)),rs={key:1,class:"container-fluid"},cs=r(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),ds=[cs],ms=xe({__name:"Boards",setup(k){const v=ye(),B=f(!1),h=f("create"),i=f("board"),S=f(null),g=f(""),I=f(""),x=f([]),U=f(null),E=f(null),F=f([]);f([]);const R=Me(),V=Ie().test("fileOrString","Must be a file or a string",a=>a instanceof File||typeof a=="string"),ne=qe({name:Z().required("Name is required"),description:Z().required("Description is required"),icon:V.required("Icon is required"),cover:V.required("Cover is required")}),{handleSubmit:re,setErrors:T,setFieldValue:y,values:j}=Se({validationSchema:ne,initialValues:{name:"",description:"",icon:"",cover:""}}),L=re(async a=>{var s,l,p;try{const m={name:a.name,description:a.description,icon:a.icon,cover:a.cover};i.value==="board"?h.value==="create"?await Ee(m):h.value==="edit"&&(s=S.value)!=null&&s.id&&(console.log("Selected Board ID:",S.value.id),await Fe(m,S.value.id)):i.value==="committee"&&(h.value==="create"?await Pe(m,g.value):h.value==="edit"&&await Re(m,I.value)),(l=U.value)==null||l.close(),(p=E.value)==null||p.close(),i.value==="board"&&await D(),i.value==="committee"&&await P(),Ae(),He(),H(),x.value=[],B.value=!1}catch(m){m instanceof O?T(m.messages):R(m)}}),ce=u(async()=>{var a;try{if(g.value){const s={members:x.value};await ee(s,g.value)}if(i.value==="board"){const s={members:x.value};await ee(s,g.value)}else if(i.value==="committee"){const s={members:x.value};await Ve(s,g.value,I.value)}(a=E.value)==null||a.close(),i.value==="board"&&await D(),i.value==="committee"&&await P(),H(),x.value=[],B.value=!1}catch(s){s instanceof O?T(s.messages):R(s)}},"onSubmitMembers"),{errorMessage:$}=Ue("members"),N=u((a,s)=>{var l;s==="board"?i.value="board":s==="committee"&&(g.value=a,i.value="committee"),h.value="create",B.value=!0,(l=U.value)==null||l.showModal()},"openCreateModal"),A=u((a,s)=>{var l;S.value=a,y("name",a.name),y("description",a.description),y("icon",a.icon),y("cover",a.cover),ie(a.cover),oe(a.icon),s==="board"?i.value="board":s==="committee"&&(I.value=a.id,i.value="committee"),h.value="edit",B.value=!0,(l=U.value)==null||l.showModal()},"openEditModal"),H=u(()=>{y("name",""),y("description",""),y("icon",""),y("cover",""),h.value="create",i.value="board",B.value=!0,g.value="",I.value=""},"resetBoardForm"),K=u((a,s)=>{var p;console.log("ff",a);const l=a.members.map(m=>m.user.id.toString());x.value=l,h.value="members",s==="board"?(i.value="board",g.value=a.id):s==="committee"&&(I.value=a.id,g.value=a.committeeable.details.id,i.value="committee"),B.value=!0,(p=E.value)==null||p.showModal()},"openEditMembersModal"),de=u(()=>{},"selectedUsers"),me=u(()=>{},"removeSelectedUsers"),ue=u(async a=>{await $e(a.id),await D(),await P()},"deleteBoard"),ve=Q(()=>{var s;const a=[];return F.value&&((s=F.value)==null?void 0:s.length)>0&&F.value.reduce((l,p)=>(l.push({id:p.id,name:`${p.full_name}`}),l),a),a}),he=u(async()=>{const a=await je({paginate:"false"});F.value=a.data},"getUsers");we(async()=>{window.dispatchEvent(new CustomEvent("updateTitle",{detail:"Boards & Committees"})),he()});const _e=u(()=>le({queryKey:["getBoardsKey"],queryFn:async()=>(await De({paginate:"false"})).data}),"getBoards"),{isLoading:us,data:fe,refetch:D}=_e(),pe=u(()=>le({queryKey:["getCommitteesKey"],queryFn:async()=>(await Te({paginate:"false"})).data}),"getCommittees"),{isLoading:vs,data:be,refetch:P}=pe(),G=Q(()=>h.value==="create"&&i.value==="board"?"Create Board":h.value==="edit"&&i.value==="board"?"Edit Board":h.value==="create"&&i.value==="committee"?"Create Committee":h.value==="edit"&&i.value==="committee"?"Edit Committee":"");return(a,s)=>{var m;const l=z("router-link"),p=z("Multiselect");return o(v).hasPermission(["view board"])?(n(),c("div",Oe,[e("div",Qe,[e("div",ze,[e("div",We,[e("div",Xe,[Ye,e("button",{onClick:s[0]||(s[0]=b(t=>N("","board"),["prevent"])),class:"float-right btn btn-secondary bg-primary"},[Je,w("New Board ")])]),e("div",Ze,[e("div",et,[e("div",tt,[(n(!0),c(W,null,X(o(fe),t=>(n(),c("div",{class:"info-box shadow-lg p-4 mb-4",key:t.id},[e("img",{class:"img-circle elevation-2",src:o(se)(t.icon),alt:"User Avatar",style:{width:"128px",height:"128px"}},null,8,st),e("div",at,[o(v).hasPermission(["view board"])?(n(),c("h3",ot,[C(l,{to:{name:"BoardDetails",params:{boardId:t.id}},class:"badge badge-soft bg-primary"},{default:q(()=>[w(d(t.name),1)]),_:2},1032,["to"])])):_("",!0),e("p",it," Owner: "+d(t.owner),1),t.members?(n(),c("div",lt,[e("span",null,d(t.members.length)+" "+d(t.members.length===1?"Member":"Members"),1),nt,o(v).hasPermission(["add member to board"])?(n(),c("a",{key:0,href:"",onClick:b(M=>K(t,"board"),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},[ct,w(" Members ")],8,rt)):_("",!0)])):_("",!0),e("p",{class:"text-muted m-0 truncate",innerHTML:t.description},null,8,dt),e("div",mt,[o(v).hasPermission(["edit board"])?(n(),c("a",{key:0,href:"",onClick:b(M=>A(t,"board"),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out mr-2"},ht,8,ut)):_("",!0),o(v).hasPermission(["delete board"])?(n(),c("a",{key:1,href:"",onClick:b(M=>ue(t),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out mr-2"},pt,8,_t)):_("",!0),o(v).hasPermission(["view board"])?(n(),J(l,{key:2,to:{name:"BoardDetails",params:{boardId:t.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:q(()=>[bt]),_:2},1032,["to"])):_("",!0),e("button",{onClick:b(M=>N(t.id,"committee"),["prevent"]),class:"btn btn-sm btn-primary ml-2"},[xt,w(" Committee ")],8,gt)])])]))),128))]),e("div",yt,[(n(!0),c(W,null,X(o(be),t=>(n(),c("div",{class:"info-box shadow-lg p-4 mb-4",key:t.id},[e("img",{class:"img-circle elevation-2",src:o(se)(t.icon),alt:"User Avatar",style:{width:"128px",height:"128px"}},null,8,wt),e("div",Ct,[e("h3",kt,[C(l,{to:{name:"CommitteeDetails",params:{committeeId:t.id}},class:"badge badge-soft bg-primary"},{default:q(()=>[w(d(t.name),1)]),_:2},1032,["to"])]),e("h3",Bt,[w(" Board :"),C(l,{to:{name:"BoardDetails",params:{boardId:t.committeeable.details.id}},class:"badge badge-soft"},{default:q(()=>[w(d(t.committeeable.details.name),1)]),_:2},1032,["to"])]),e("p",Mt," Owner: "+d(t.owner),1),t.members?(n(),c("div",It,[e("span",null,d(t.members.length)+" "+d(t.members.length===1?"Member":"Members"),1),qt,o(v).hasPermission(["add member to committee"])?(n(),c("a",{key:0,href:"",onClick:b(M=>K(t,"committee"),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},[Ut,w(" Members ")],8,St)):_("",!0)])):_("",!0),e("p",{class:"text-muted m-0 truncate",innerHTML:t.description},null,8,Et),e("div",Ft,[o(v).hasPermission(["edit committee"])?(n(),c("a",{key:0,href:"",onClick:b(M=>A(t,"committee"),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out mr-2"},Pt,8,$t)):_("",!0),o(v).hasPermission(["delete committee"])?(n(),c("a",{key:1,href:"",onClick:b(M=>a.deleteCommittee(t),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out mr-2"},Tt,8,Rt)):_("",!0),o(v).hasPermission(["view committee"])?(n(),J(l,{key:2,to:{name:"CommitteeDetails",params:{committeeId:t.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:q(()=>[jt]),_:2},1032,["to"])):_("",!0)])])]))),128))])])])])])]),e("div",Lt,[e("dialog",{id:"boardModal",class:"modal w-full max-w-4xl mx-auto p-0",ref_key:"BoardModal",ref:U},[e("form",Nt,[e("h3",At,d(G.value),1),Ht,e("div",Kt,[e("div",Gt,[e("div",Ot,[e("form",{novalidate:"",onSubmit:s[3]||(s[3]=b((...t)=>o(L)&&o(L)(...t),["prevent"])),class:""},[e("div",Qt,[e("div",zt,[C(Le,{labeled:!0,label:"Name",name:"name",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter Name",type:"text"})]),e("div",Wt,[C(te,{labeled:!0,label:"Upload icon Image",name:"icon",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter icon Image",type:"file",accept:o(ae).join(", "),onChange:s[1]||(s[1]=t=>o(Ke)(t))},null,8,["accept"]),e("img",{src:o(oe)((m=o(j))==null?void 0:m.icon),class:"file_attachment"},null,8,Xt)]),e("div",Yt,[C(te,{labeled:!0,label:"Upload Cover Image",name:"cover",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter Cover Image",type:"file",accept:o(ae).join(", "),onChange:s[2]||(s[2]=t=>o(Ge)(t))},null,8,["accept"]),e("img",{src:o(ie)(o(j).cover),class:"file_attachment"},null,8,Jt)])]),C(Ne,{label:"Description",name:"description",theme:"snow",placeholder:"Enter Description",toolbar:"full",contentType:"html",class:"col-span-3 mb-4"}),e("button",Zt,d(G.value),1)],32)])])])])],512)]),e("div",es,[e("dialog",{id:"membersmodal",class:"modal",ref_key:"membersmodal",ref:E},[e("form",ts,[ss,as,e("div",os,[e("div",is,[e("form",{novalidate:"",onSubmit:b(ce,["prevent"]),class:"w-full rounded-xl mx-auto p-1 custom-modal"},[e("div",{class:Y(["multiselect-container",{error:!!o($)}])},[C(p,{id:"members",modelValue:x.value,"onUpdate:modelValue":s[4]||(s[4]=t=>x.value=t),mode:"tags",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:ve.value,valueProp:"id",trackBy:"id",label:"name",class:Y(["multiselect-container",{error:!!o($)}]),onSelect:s[5]||(s[5]=t=>de()),onDeselect:s[6]||(s[6]=t=>me())},null,8,["modelValue","options","class"]),o($)?(n(),c("div",ls,d(o($)),1)):_("",!0)],2),ns],32)])])])],512)])])):(n(),c("div",rs,ds))}}});const qs=Be(ms,[["__scopeId","data-v-25b58cc6"]]);export{qs as default};
