var Re=Object.defineProperty;var k=(F,j)=>Re(F,"name",{value:j,configurable:!0});import{d as Ne,i as Fe,n as Ge,k as Le,j as De,r as S,V as Oe,C as q,P as Ve,H as Be,u as o,o as i,c as a,e,a1 as N,g as M,h as p,t as u,F as A,T as w,f as pe,$ as Ue,a0 as Ye,_ as je}from"./main-d97516e2.js";import{u as Ke,c as Qe,d as We,a as H,g as ze,b as Je}from"./useUnexpectedErrorHandler-01ee037e.js";import{i as Xe,j as Ze,k as Ie,l as et,h as tt,o as st,p as it,n as at,q as lt,r as nt}from"./useMinuteRequest-40fb106c.js";import{F as ge}from"./FormQuillEditor-3e5c8bfd.js";import{B as ot,f as dt,C as L,D as E}from"./Breadcrumb-62de853f.js";import{u as rt}from"./useQuery-f8736dfe.js";import"./index-a4206e89.js";import"./useQueryClient-99479e2d.js";const v=k(F=>(Ue("data-v-a0182950"),F=F(),Ye(),F),"_withScopeId"),ut={key:0},ct={class:"card card-widget shadow-lg"},_t={key:0,class:"card-footer"},vt={class:"d-flex align-items-center"},bt={class:"ml-3 flex-1"},mt=v(()=>e("i",{class:"fas fa-chevron-left"},null,-1)),ht={key:0,class:"ml-auto flex self-end"},pt={key:0,type:"button",class:"btn btn-sm mr-1 btn-success btn-lg"},gt=v(()=>e("i",{class:"fas fa-door-closed mr-1"},null,-1)),ft=v(()=>e("i",{class:"fas fa-door-closed mr-1"},null,-1)),yt={key:2,type:"button",class:"btn btn-sm mr-1 btn-warning btn-lg"},kt=v(()=>e("i",{class:"fa fa-check mr-1"},null,-1)),Ct=v(()=>e("i",{class:"fa fa-check mr-1"},null,-1)),xt=v(()=>e("i",{class:"fa fa-trash mr-1"},null,-1)),St=v(()=>e("i",{class:"fa fa-signature mr-1"},null,-1)),At=v(()=>e("i",{class:"fa fa-check mr-1"},null,-1)),wt={class:"card-body"},Et=v(()=>e("span",{class:"info-box-icon",style:{left:"4%","margin-left":"-45px",position:"absolute",top:"88px"}},[e("div",{class:"h3 text-bold font-bold uppercase text-primary"}," Confidential")],-1)),$t={class:"text-center logo-container"},Mt=["src"],Tt={class:"h3 text-center text-primary text-bold font-bold uppercase"},qt=v(()=>e("hr",{class:"thick-line"},null,-1)),Ht={class:"text-center text-primary text-bold uppercase h4"},Pt={class:"text-center text-primary text-bold uppercase h4"},Rt={key:0,class:"mt-2 text-primary text-bold uppercase"},Nt={key:1,class:"table table-borderless"},Ft={class:"p-0"},Gt={class:"p-0 text-primary text-bold uppercase"},Lt={key:2,class:"mt-2 text-primary text-bold uppercase"},Dt={key:3,class:"table table-borderless"},Ot={class:"p-0"},Vt={class:"p-0 text-primary text-bold uppercase"},Bt={key:4,class:"mt-2 text-primary text-bold uppercase"},Ut={key:5,class:"table table-borderless"},Yt={class:"p-0"},jt={class:"p-0 text-primary text-bold uppercase"},Kt={key:6,class:"mt-2 text-primary text-bold uppercase"},Qt={key:7,class:"table table-borderless"},Wt={class:"p-0"},zt={class:"p-0 text-primary text-bold uppercase"},Jt=v(()=>e("h5",{class:"mt-2 text-primary text-bold uppercase"},"Agenda",-1)),Xt={class:"list-unstyled"},Zt={class:"list-unstyled ml-4"},It={id:"MinutesEditor",class:"container"},es={class:"codex-editor"},ts={class:"codex-editor__redactor",style:{"padding-bottom":"300px"}},ss={class:"ce-block"},is={class:"flex w-full"},as={class:"flex-1"},ls={key:0,"data-list_format":"num_la_lr",class:"agenda-list mb-0 border-l border-blue"},ns={class:"rounded-lg border border-transparent hover:cursor-pointer border-blue -ml-7 p-2 pl-7 relative border-blue"},os={class:"flex gap-2 items-start"},ds={key:0,class:"font-medium flex-1"},rs={class:"text-sm text-gray-800 font-normal"},us={class:"flex gap-x-2"},cs=v(()=>e("button",{type:"submit",class:"btn btn-primary h-10 mt-12"}," Save ",-1)),_s={key:1,class:"font-medium flex-1"},vs=["onClick"],bs={class:"font-bold text-primary"},ms=["innerHTML"],hs=v(()=>e("div",{class:"font-medium"},[e("div",{class:"badge bg-warning text-bold"}," Click Here to Edit This Agenda Minute And Click save")],-1)),ps=["onClick"],gs={class:"font-bold text-primary"},fs=v(()=>e("div",{class:"font-medium"},[e("div",{class:"badge bg-info text-bold"}," Click Here to add Minutes for this Agenda and Click Save")],-1)),ys={key:0,class:"min-h-6 border-l border-blue"},ks={class:"rounded-lg border border-transparent hover:cursor-pointer border-blue -ml-7 p-2 pl-7 relative border-blue"},Cs={class:"flex gap-2 items-start"},xs={key:0,class:"font-medium flex-1"},Ss={class:"text-sm text-gray-800 font-normal"},As={class:"flex gap-x-2"},ws=v(()=>e("button",{type:"submit",class:"btn btn-primary h-10 mt-12"}," Save ",-1)),Es={key:1,class:"font-medium flex-1"},$s={class:"font-bold text-primary"},Ms=["onClick"],Ts=["innerHTML"],qs=v(()=>e("div",{class:"font-medium"},[e("div",{class:"badge bg-warning text-bold"}," Click Here to Edit This Agenda Minute And Click save")],-1)),Hs={key:0},Ps=["onClick"],Rs=v(()=>e("div",{class:"font-medium"},[e("div",{class:"badge bg-success text-bold"}," Click Here to add Minutes for this SubAgenda and Click Save")],-1)),Ns=[Rs],Fs={key:1},Gs={key:2},Ls=["onClick"],Ds=v(()=>e("div",{class:"badge bg-success text-bold"}," Click Here to add Minutes for this SubAgenda and Click Save",-1)),Os=[Ds],Vs={key:2},Bs={key:0},Us=["onClick"],Ys={class:"font-bold text-primary"},js=v(()=>e("div",{class:"font-medium"},[e("div",{class:"badge bg-success text-bold"}," Click Here to add Minutes for this SubAgenda and Click Savexx")],-1)),Ks={key:1},Qs=["onClick"],Ws=v(()=>e("div",{class:"badge bg-warning text-bold"}," Create Minute for main Agenda before Sub Agenda First",-1)),zs=[Ws],Js={key:1},Xs={key:2},Zs=["onClick"],Is={class:"font-bold text-primary"},ei=v(()=>e("div",{class:"font-medium"},[e("div",{class:"badge bg-success text-bold"}," Click Here to add Minutes for this SubAgenda and Click Savevv")],-1)),ti={key:1},si=["onClick"],ii=v(()=>e("div",{class:"badge bg-warning text-bold"}," Create Minute for main Agenda before Sub Agenda First",-1)),ai=[ii],li={key:1},ni=v(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),oi=[ni],di=Ne({__name:"Minute",props:{defaultMinutes:Boolean},setup(F){const j=Fe(),fe=Ge(),ye=Le(),K=F;function ke(){ye.back()}k(ke,"goBack");const Q=De(),te=Q.params.boardId;Q.params.meetingId;const T=Q.params.scheduleId;K.defaultMinutes,S(null);const D=S(null),C=S("create"),f=S(!1),se=S([]),P=S(null),ie=S(null),y=S(-1),g=S(-1),G=S(!1),R=S(!1),W=S([{text:""}]),Ce=Ke(),xe=Qe({schedule_id:We().required(),board_id:H().nullable(),committee_id:ze().nullable(),membership_id:H().nullable(),minute_id:H().nullable(),agenda_id:H().required(),detail_minute_id:H().nullable(),subdetailminute_id:H().nullable(),subagenda_id:H().nullable(),description:H().required(),status:H().required()}),{handleSubmit:Se,setErrors:Ae,setFieldValue:b,values:ri}=Je({validationSchema:xe,initialValues:{schedule_id:T,board_id:te,committee_id:null,membership_id:null,minute_id:D.value,agenda_id:"",detail_minute_id:null,subdetailminute_id:null,subagenda_id:null,description:"",status:"unpublished"}}),V=Se(async(t,{resetForm:d})=>{try{const r={schedule_id:t.schedule_id,committee_id:null,membership_id:null,minute_id:D.value?D.value.toString():null,agenda_id:t.agenda_id.toString(),detail_minute_id:t.detail_minute_id?t.detail_minute_id.toString():null,subdetailminute_id:t.subdetailminute_id?t.subdetailminute_id.toString():null,subagenda_id:t.subagenda_id?t.subagenda_id.toString():null,description:t.description,status:t.status};C.value==="create"?f.value?await Xe(r,T):R.value&&await Ze(r,T):y.value!==-1?(await Ie(r,T),console.log("payload",r)):g.value!==-1&&await et(r,T),await O(),B()}catch(r){r instanceof Oe?Ae(r.messages):Ce(r)}}),B=k(()=>{C.value="create",f.value=!1,P.value=null,ie.value=null,y.value=-1,g.value=-1,G.value=!1,R.value=!1,b("schedule_id",T),b("board_id",te),b("committee_id",null),b("membership_id",null),b("minute_id",D.value),b("agenda_id",""),b("detail_minute_id",null),b("subdetailminute_id",null),b("subagenda_id",null),b("description",""),b("status","unpublished")},"reset"),z=k(t=>{B(),R.value=!0,P.value=t.id,G.value=!1,f.value=!1,g.value=-1,y.value=-1,C.value="create",b("agenda_id",t.id)},"enableAddingNewParent"),U=k((t,d,r,_)=>{B(),f.value=!0,P.value=r.id,g.value=t,y.value=d,b("agenda_id",r.id),b("subagenda_id",_.id),G.value=!1,C.value="create",ie.value=_.id},"enableAddingChild");q(()=>{const t=f.value&&P.value===agenda.id&&g.value===pIndex&&y.value===cIndex&&C.value==="create";return console.log("isAddingChild computed:",t),t}),q(()=>{const t=G.value&&!R.value&&!f.value&&C.value==="edit";return console.log("isEditing computed:",t),t});const ae=k((t,d,r,_,c)=>{B(),G.value=!0,R.value=!1,f.value=!1,g.value=t,y.value=d,C.value="edit",console.log("pIndex: number, cIndex:",t,d),console.log("States after enabling adding child:",{is_editing:G.value,isAddingNewParent:R.value,addingChild:f.value,editingParentIndex:g.value,editingChildIndex:y.value,action:C.value}),b("agenda_id",r.id),y.value!==-1?(b("subdetailminute_id",c.id),b("detail_minute_id",c.detail_minute_id),b("subagenda_id",c.subagenda_id),b("description",c.description)):g.value!==-1&&(b("detail_minute_id",_.id),b("description",_.description))},"enableEditing"),we=k(()=>rt({queryKey:["getEditMinutesKey",T],queryFn:async()=>{const t=await nt(T,{paginate:"false"});return D.value=t.data.id,console.log("response.data",t.data),t.data}}),"getMinutes"),{isLoading:ui,data:s,refetch:O}=we(),J=q(()=>{var t,d,r,_;return(t=s==null?void 0:s.value)!=null&&t.attendances&&((r=(d=s==null?void 0:s.value)==null?void 0:d.attendances)==null?void 0:r.length)>0?((_=s==null?void 0:s.value)==null?void 0:_.attendances.filter(c=>c.rsvp_status==="Yes"&&c.attendance_status==="Attended"))||[]:[]}),X=q(()=>{var t,d,r,_;return(t=s==null?void 0:s.value)!=null&&t.attendances&&((r=(d=s==null?void 0:s.value)==null?void 0:d.attendances)==null?void 0:r.length)>0?((_=s==null?void 0:s.value)==null?void 0:_.attendances.filter(c=>c.rsvp_status==="Online"&&c.attendance_status==="Attended"))||[]:[]}),Z=q(()=>{var t,d,r,_;return(t=s==null?void 0:s.value)!=null&&t.attendances&&((r=(d=s==null?void 0:s.value)==null?void 0:d.attendances)==null?void 0:r.length)>0?((_=s==null?void 0:s.value)==null?void 0:_.attendances.filter(c=>["Yes","No","Maybe"].includes(c.rsvp_status)&&c.attendance_status==="Absent"))||[]:[]}),I=q(()=>{var t,d,r,_;return(t=s==null?void 0:s.value)!=null&&t.attendances&&((r=(d=s==null?void 0:s.value)==null?void 0:d.attendances)==null?void 0:r.length)>0?((_=s==null?void 0:s.value)==null?void 0:_.attendances.filter(c=>c.rsvp_status==="Pending"&&c.attendance_status==="Absent"))||[]:[]}),Ee=k(async()=>{const t=await tt(T,{paginate:"false"});se.value=t.data},"getmeetingagendas"),ee=q(()=>{if(K.defaultMinutes)return se.value});Ve(async()=>{await O(),K.defaultMinutes&&Ee()}),Be(()=>W==null?void 0:W.value,t=>{t&&(D.value=t)},{deep:!0});const x=q(()=>{var d;const t={};return s!=null&&s.value&&(s!=null&&s.value.detailminutes)&&((d=s==null?void 0:s.value.detailminutes)==null||d.forEach(r=>{var _;t[r.agenda_id]||(t[r.agenda_id]=[]),t[r.agenda_id].push(r),(_=r.subdetailminutes)==null||_.forEach(c=>{t[c.subagenda_id]||(t[c.subagenda_id]=[]),t[c.subagenda_id].push(c)})})),t}),le=q(()=>fe.getSettings()),$e=k(async t=>{await st(t),await O()},"onDeleteMinutes"),Me=k(async t=>{await it(t),await O()},"onGetMinutesSignatures"),Te=k(async t=>{await at(t),await O()},"onCEOApproval"),qe=k(async t=>{await lt(t),await O()},"onGetPublishMinutes"),He=k(async t=>{console.log("Minutes?.schedule?.id",t)},"onCloseMeeting");return(t,d)=>{var r,_,c,ne,oe,de,re,ue,ce,_e,ve,be,me,he;return o(j).hasPermission(["create minutes","edit minutes","create minutes"])?(i(),a("div",ut,[e("div",ct,[o(s)?(i(),a("div",_t,[e("div",vt,[e("div",bt,[e("a",{href:"",onClick:N(ke,["prevent"]),class:"text-blue-primary"},[mt,M(" Go back To Meeting ")])]),o(s)?(i(),a("div",ht,[((_=(r=o(s))==null?void 0:r.schedule)==null?void 0:_.closestatus)==="closed"?(i(),a("button",pt,[gt,M(" Meeting Closed ")])):(i(),a("button",{key:1,type:"button",class:"btn btn-sm mr-1 btn-success btn-lg",onClick:d[0]||(d[0]=N(l=>He(o(s)),["prevent"]))},[ft,M(" Close Meeting ")])),((c=o(s))==null?void 0:c.approvalstatus)==="approved"?(i(),a("button",yt,[kt,M(" This Minutes are Approved ")])):(i(),a("button",{key:3,type:"button",class:"btn btn-sm mr-1 btn-warning btn-lg",onClick:d[1]||(d[1]=N(l=>{var n;return Te((n=o(s))==null?void 0:n.id)},["prevent"]))},[Ct,M(" Send Approval to CEO ")])),(ne=o(s))!=null&&ne.detailminutes?(i(),a("button",{key:4,type:"button",class:"btn btn-sm mr-1 btn-danger btn-lg",onClick:d[2]||(d[2]=N(l=>{var n;return $e((n=o(s))==null?void 0:n.id)},["prevent"]))},[xt,M(" Delete Minutes ")])):p("",!0),e("button",{type:"button",class:"btn btn-sm mr-1 btn-primary btn-lg",onClick:d[3]||(d[3]=N(l=>{var n;return Me((n=o(s))==null?void 0:n.id)},["prevent"]))},[St,M(" Get Signatures ")]),e("button",{type:"button",class:"btn btn-sm mr-1 btn-success btn-lg",onClick:d[4]||(d[4]=N(l=>{var n;return qe((n=o(s))==null?void 0:n.id)},["prevent"]))},[At,M(" Publish Minutes ")])])):p("",!0)])])):p("",!0),e("div",wt,[Et,e("div",$t,[e("img",{src:o(ot)((oe=le.value)==null?void 0:oe.logo),alt:"Organization Logo",class:"img-fluid logo"},null,8,Mt)]),e("div",Tt,u((de=le.value)==null?void 0:de.name),1),qt,e("h4",Ht,"MINUTES OF THE "+u((ue=(re=o(s))==null?void 0:re.meeting)==null?void 0:ue.title),1),e("p",Pt," HELD AT "+u((_e=(ce=o(s))==null?void 0:ce.meeting)==null?void 0:_e.location)+" ON "+u(o(dt)((be=(ve=o(s))==null?void 0:ve.schedule)==null?void 0:be.date))+" STARTING AT "+u((he=(me=o(s))==null?void 0:me.schedule)==null?void 0:he.start_time),1),J.value.length?(i(),a("h5",Rt,"Present")):p("",!0),J.value.length?(i(),a("table",Nt,[e("tbody",null,[(i(!0),a(A,null,w(J.value,(l,n)=>(i(),a("tr",{key:l.id},[e("td",Ft,u(n+1)+". "+u(l.membership.user.full_name),1),e("td",Gt," - "+u(l.membership.position.name),1)]))),128))])])):p("",!0),X.value.length?(i(),a("h5",Lt,"Present on E-platform ")):p("",!0),X.value.length?(i(),a("table",Dt,[e("tbody",null,[(i(!0),a(A,null,w(X.value,(l,n)=>(i(),a("tr",{key:l.id},[e("td",Ot,u(n+1)+". "+u(l.membership.user.full_name),1),e("td",Vt," - "+u(l.membership.position.name),1)]))),128))])])):p("",!0),Z.value.length?(i(),a("h5",Bt,"Absent With Apology ")):p("",!0),Z.value.length?(i(),a("table",Ut,[e("tbody",null,[(i(!0),a(A,null,w(Z.value,(l,n)=>(i(),a("tr",{key:l.id},[e("td",Yt,u(n+1)+". "+u(l.membership.user.full_name),1),e("td",jt," - "+u(l.membership.position.name),1)]))),128))])])):p("",!0),I.value.length?(i(),a("h5",Kt," Absent ")):p("",!0),I.value.length?(i(),a("table",Qt,[e("tbody",null,[(i(!0),a(A,null,w(I.value,(l,n)=>(i(),a("tr",{key:l.id},[e("td",Wt,u(n+1)+". "+u(l.membership.user.full_name),1),e("td",zt," - "+u(l.membership.position.name),1)]))),128))])])):p("",!0),Jt,e("ul",Xt,[(i(!0),a(A,null,w(ee.value,(l,n)=>(i(),a(A,{key:l.id},[e("li",null,u(n+1)+". "+u(l.title),1),e("ul",Zt,[(i(!0),a(A,null,w(l.children,(m,h)=>(i(),a("li",{key:m.id},u(n+1)+"."+u(h+1)+" "+u(m.title),1))),128))])],64))),128))]),e("div",It,[e("div",es,[e("div",ts,[e("div",ss,[e("div",is,[e("div",as,[ee.value?(i(),a("ol",ls,[(i(!0),a(A,null,w(ee.value,(l,n)=>(i(),a("li",{class:"mb-2 hover:border-gray-400",key:n},[e("div",ns,[e("div",os,[g.value===n&&y.value===-1&&C.value==="edit"||R.value&&P.value===l.id&&y.value===-1&&C.value==="create"?(i(),a("div",ds,[e("div",rs,[e("form",{novalidate:"",onSubmit:d[5]||(d[5]=N((...m)=>o(V)&&o(V)(...m),["prevent"]))},[e("div",us,[pe(ge,{label:`${o(L)(o(E)(n),l.title)}`,name:"description",theme:"snow",placeholder:"Enter minute description and hit save",toolbar:"full",contentType:"html",class:"minute-input"},null,8,["label"]),cs])],32)])])):(i(),a("div",_s,[(i(!0),a(A,null,w(x.value[l.id],(m,h)=>(i(),a("div",{key:h,onClick:$=>ae(n,-1,l,m,void 0)},[e("div",bs,u(o(L)(o(E)(n),l.title)),1),e("div",{innerHTML:m.description},null,8,ms),hs],8,vs))),128)),x.value[l.id]?p("",!0):(i(),a("div",{key:0,onClick:m=>z(l)},[e("div",gs,u(o(L)(o(E)(n),l.title)),1),fs],8,ps))]))])]),l.children?(i(),a("ol",ys,[(i(!0),a(A,null,w(l.children,(m,h)=>(i(),a("li",{class:"mb-2 hover:border-gray-400",draggable:"false",key:h},[e("div",ks,[e("div",Cs,[f.value&&P.value===l.id&&g.value===n&&y.value===h&&C.value==="create"||G.value&&!R.value&&!f.value&&g.value===n&&y.value===h&&C.value==="edit"?(i(),a("div",xs,[e("div",Ss,[e("form",{novalidate:"",onSubmit:d[6]||(d[6]=N((...$)=>o(V)&&o(V)(...$),["prevent"]))},[e("div",As,[pe(ge,{label:`${o(L)(o(E)(n),m.title,void 0,void 0,void 0,o(E)(h))}`,name:"description",theme:"snow",placeholder:"Enter minute description and hit save",toolbar:"full",contentType:"html",class:"minute-input"},null,8,["label"]),ws])],32)])])):(i(),a("div",Es,[e("div",$s,u(o(L)(o(E)(n),m.title,void 0,void 0,void 0,o(E)(h))),1),(i(!0),a(A,null,w(x.value[l.id],($,Pe)=>(i(),a("div",{key:Pe},[(i(!0),a(A,null,w(x.value[m.id],Y=>(i(),a("div",{key:Y.id},[Y.subagenda_id===m.id?(i(),a("div",{key:0,onClick:ci=>ae(n,h,l,$,Y)},[e("div",{innerHTML:Y.description},null,8,Ts),qs],8,Ms)):p("",!0)]))),128))]))),128)),x.value[m.id]?p("",!0):(i(),a("div",Hs,[g.value!==n&&!f.value?(i(),a("div",{key:0,onClick:$=>U(n,h,l,m)},Ns,8,Ps)):f.value&&P.value===l.id&&g.value===n&&y.value===h?(i(),a("div",Fs)):(i(),a("div",Gs,[e("div",{class:"font-medium",onClick:$=>U(n,h,l,m)},Os,8,Ls)]))]))])),M(),x.value[l.id]?p("",!0):(i(),a("div",Vs,[g.value!==n&&!f.value?(i(),a("div",Bs,[x.value&&x.value[l.id]&&x.value[l.id].length>0?(i(),a("div",{key:0,onClick:$=>U(n,h,l,m)},[e("div",Ys,u(o(L)(o(E)(n),m.title,void 0,void 0,void 0,o(E)(h))),1),js],8,Us)):(i(),a("div",Ks,[e("div",{class:"font-medium",onClick:$=>z(l)},zs,8,Qs)]))])):f.value&&P.value===l.id&&g.value===n&&y.value===h?(i(),a("div",Js)):(i(),a("div",Xs,[x.value&&x.value[l.id]&&x.value[l.id].length>0?(i(),a("div",{key:0,onClick:$=>U(n,h,l,m)},[e("div",Is,u(o(L)(o(E)(n),m.title,void 0,void 0,void 0,o(E)(h))),1),ei],8,Zs)):(i(),a("div",ti,[e("div",{class:"font-medium",onClick:$=>z(l)},ai,8,si),M("> ")]))]))]))])])]))),128))])):p("",!0)]))),128))])):p("",!0)])])])])])])])])])):(i(),a("div",li,oi))}}});const ki=je(di,[["__scopeId","data-v-a0182950"]]);export{ki as default};
