var tt=Object.defineProperty;var u=(c,e)=>tt(c,"name",{value:e,configurable:!0});import{d as C,j,r as k,H as A,b as N,o,c as i,e as t,t as w,f as n,w as l,g as p,_ as H,q as D,a5 as et,i as U,V as st,C as V,U as I,T as L,F as O,R as at,l as F,h as _,u as s,W as ot,X as nt,n as it,a as q,L as M,D as G,aq as ct,ar as lt,as as rt,at as dt,au as ut,av as _t,aw as mt,ax as vt,ay as ft,P as ht,Q as pt}from"./main-73cc7250.js";import{$ as bt,a0 as gt,a1 as yt,D as kt}from"./Breadcrumb-3c2060aa.js";import{b as wt}from"./staff_routes-2856961c.js";import{u as Q,c as xt,a as $t,b as St}from"./useUnexpectedErrorHandler-2f351290.js";import{Q as Ct}from"./index-dc8fc598.js";import{u as Nt}from"./useQuery-1e54e0ce.js";import"./useQueryClient-0fa55727.js";const Et={class:"content-header"},Bt={class:"container-fluid"},It={class:"row mb-2"},Lt={class:"col-sm-6"},At={class:"col-sm-6"},Dt={class:"breadcrumb float-sm-right"},Ut={class:"breadcrumb-item"},Pt={class:"breadcrumb-item text-primary"},Rt=C({__name:"Breadcrumb",setup(c){const e=j(),m=k(""),v=k("");return A(gt,a=>{v.value=a}),window.addEventListener("updateTitle",a=>{bt(a.detail)}),A(()=>e.path,()=>{m.value=e.meta.title||""},{immediate:!0}),(a,h)=>{const g=N("router-link");return o(),i("div",null,[t("section",Et,[t("div",Bt,[t("div",It,[t("div",Lt,[t("h1",null,w(v.value),1)]),t("div",At,[t("ol",Dt,[t("li",Ut,[n(g,{to:"/"},{default:l(()=>[p("Home")]),_:1})]),t("li",Pt,w(m.value),1)])])])])])])}}}),Tt={},Vt=t("footer",{class:"main-footer"},[t("div",{class:"float-right d-none d-sm-block"},[t("b",null,"Version"),p(" 3.0.5 ")]),t("strong",null,[p("Copyright Â© 2014-2019 "),t("a",{href:"/"},"EBoard"),p(".")]),p(" All rights reserved. ")],-1),Ft=[Vt];function qt(c,e){return o(),i("div",null,Ft)}u(qt,"_sfc_render");const Mt=H(Tt,[["render",qt]]);async function jt(c={}){await D(c).post(wt()).json()}u(jt,"useStaffLogoutRequest");const K=et("api/v1/notifications");async function Ht(c,e){const m=D(),v=Ct.stringify(e,{arrayFormat:"brackets"});return await m.get(K()+"/"+c+"?"+v).json()}u(Ht,"useGetNotificationsRequest");async function Ot(c){return(await D().post(K()+"/update/"+c.id,{json:c})).json()}u(Ot,"useUpdateNotificationRequest");const B=u(c=>(ot("data-v-787c9fdb"),c=c(),nt(),c),"_withScopeId"),Gt={class:"dropdown-menu dropdown-menu-end dropdown-menu-card z-[1046] show custom-drop","data-popper-placement":"bottom-end"},Qt={class:"card-header flex items-center"},Kt=B(()=>t("div",{class:"flex items-center flex-1 w-full"},[t("h2",{class:"card-header-title text-base mr-auto font-extrabold"},"Notifications")],-1)),zt={class:"flex items-center space-x-2"},Wt={key:0},Xt={class:"py-2"},Jt=B(()=>t("div",{class:"relative text-right"},[t("button",{type:"button",class:"ml-auto text-primary hover:bg-primary-100 bg-transparent py-1 px-2 rounded-[4px] text-sm flex gap-1 items-center justify-center min-w-fit"}," Mark all as read ")],-1)),Yt=["onClick"],Zt=B(()=>t("div",{class:"avatar avatar-sm mr-4"},[t("div",{class:"avatar-title bg-primary-soft rounded-full text-primary"},[t("i",{class:"far fa-calendar fa-sm"})])],-1)),te={class:"flex-1"},ee={class:"text-muted mb-0 text-break text-sm"},se={class:"flex items-center space-x-2"},ae={class:"text-danger text-sm"},oe=B(()=>t("hr",null,null,-1)),ne={key:1,class:"p-3 text-center text-muted"},ie=C({__name:"Notifications",emits:["updateCount"],setup(c,{emit:e}){var T;j(),k(!1),k("create"),k(null);const m=Q(),v=U(),a=e,h=(T=v.user)==null?void 0:T.id,g=xt({id:$t().required()}),{handleSubmit:f,setErrors:x,setFieldValue:E,values:_s}=St({validationSchema:g,initialValues:{id:""}}),z=u(async r=>{E("id",r.id),await W()},"updateNotification"),W=f(async(r,{resetForm:y})=>{try{const b={id:r.id};await Ot(b,h,b.id),await Y(),X()}catch(b){b instanceof st?x(b.messages):m(b)}}),X=u(()=>{E("id","")},"reset"),J=u(()=>Nt({queryKey:["getNotificationsKey",h],queryFn:async()=>(await Ht(h.toString(),{paginate:"false"})).data}),"getNotifications"),{isLoading:ms,data:$,refetch:Y}=J(),S=k("unread"),P=V(()=>$.value?S.value==="unread"?$.value.filter(r=>r.read_at===null):$.value:[]),Z=V(()=>{const r=$.value?$.value.filter(y=>y.read_at===null).length:0;return a("updateCount",r),r}),R=u(r=>{S.value=r,console.log("we",r,S.value)},"filterNotifications");return A(Z,r=>{a("updateCount",r)}),(r,y)=>{const b=N("router-link");return o(),i("div",Gt,[t("div",Qt,[Kt,t("div",zt,[t("button",{type:"button",class:I(["btn btn-tool",{"btn-info":S.value==="unread"}]),onClick:y[0]||(y[0]=L(d=>R("unread"),["prevent","stop"]))}," Unread ",2),t("button",{type:"button",class:I(["btn btn-tool",{"btn-info":S.value==="all"}]),onClick:y[1]||(y[1]=L(d=>R("all"),["prevent","stop"]))}," All ",2)])]),P.value.length>0?(o(),i("div",Wt,[t("div",Xt,[Jt,(o(!0),i(O,null,at(P.value,d=>(o(),i("a",{key:d.id,href:"",onClick:L(vs=>z(d),["prevent","stop"]),class:"p-3 block flex text-gray-800"},[Zt,t("div",te,[t("h5",{class:I({"text-info font-semibold":d.read_at===null,"text-black font-semibold":d.read_at!==null})},w(d.data.message),3),t("div",ee,[t("div",se,[d.data.board_id?(o(),F(b,{key:0,class:"text-primary font-bold",to:{name:"BoardDetails",params:{boardId:d.data.board_id}}},{default:l(()=>[p(" View the Board ")]),_:2},1032,["to"])):_("",!0),d.data.meeting_id?(o(),F(b,{key:1,class:"text-success font-bold",to:{name:"BoardDetails",params:{boardId:d.data.meeting_id}}},{default:l(()=>[p(" View the Meeting ")]),_:2},1032,["to"])):_("",!0)])]),t("div",ae,w(s(yt)(d.created_at)),1)])],8,Yt))),128)),oe])])):(o(),i("div",ne," No notifications to show. "))])}}});const ce=H(ie,[["__scopeId","data-v-787c9fdb"]]),le={class:"main-header navbar navbar-expand navbar-white"},re={class:"navbar-nav"},de=t("li",{class:"nav-item"},[t("a",{class:"nav-link","data-widget":"pushmenu",href:"#",role:"button"},[t("i",{class:"fas fa-bars"})])],-1),ue={class:"nav-item d-none d-sm-inline-block"},_e={class:"navbar-nav ml-auto"},me={class:"nav-item dropdown"},ve={class:"nav-link","data-toggle":"dropdown",href:"#"},fe=t("i",{class:"far fa-bell fa-lg mr-2"},null,-1),he={class:"badge bg-danger navbar-badge"},pe={class:"dropdown-menu dropdown-menu-lg dropdown-menu-right"},be=t("li",{class:"nav-item"},[t("a",{class:"nav-link","data-widget":"fullscreen",href:"#",role:"button"},[t("i",{class:"fas fa-expand-arrows-alt"})])],-1),ge=t("a",{class:"nav-link",href:"#",role:"button"}," Logout ",-1),ye=[ge],ke=t("li",{class:"nav-item"},[t("a",{class:"nav-link","data-widget":"control-sidebar","data-slide":"true",href:"#",role:"button"},[t("i",{class:"fas fa-th-large"})])],-1),we=C({__name:"Header",setup(c){const e=k(0),m=U(),v=it(),a=Q();async function h(){try{await jt(),m.setUser(void 0),v.resetSettings(),await q.push({name:M});const f=q.resolve({name:M});window.location.href=f.href}catch(f){a(f)}}u(h,"onLogout");function g(f){e.value=f}return u(g,"updateUnreadCount"),(f,x)=>{const E=N("router-link");return o(),i("nav",le,[t("ul",re,[de,t("li",ue,[n(E,{to:{name:s(G)},class:"nav-link"},{default:l(()=>[p("Home")]),_:1},8,["to"])])]),t("ul",_e,[t("li",me,[t("a",ve,[fe,t("span",he,w(e.value),1)]),t("div",pe,[n(ce,{onUpdateCount:g})])]),be,t("li",{onClick:h,class:"nav-item"},ye),ke])])}}}),xe={class:"main-sidebar sidebar-dark-primary elevation-4"},$e=t("span",{class:"brand-text font-weight-light"},"Eboard",-1),Se={class:"sidebar"},Ce={key:0,class:"user-panel mt-3 pb-3 mb-3 d-flex"},Ne={class:"image"},Ee=["src"],Be={class:"info"},Ie={class:"mt-2"},Le={class:"nav nav-pills nav-sidebar flex-column","data-widget":"treeview",role:"menu","data-accordion":"false"},Ae={class:"nav-item"},De=t("i",{class:"nav-icon fas fa-tachometer-alt"},null,-1),Ue=t("p",null," Dashboard ",-1),Pe={key:0,class:"nav-item"},Re=t("i",{class:"nav-icon fas fa-th"},null,-1),Te=t("p",null," Board & Committee ",-1),Ve={key:1,class:"nav-item"},Fe=t("i",{class:"nav-icon fas fa-copy"},null,-1),qe=t("p",null," Meetings ",-1),Me={key:2,class:"nav-item"},je=t("i",{class:"nav-icon fas fa-chart-pie"},null,-1),He=t("p",null," Almanac ",-1),Oe={key:3,class:"nav-item"},Ge=t("i",{class:"nav-icon fas fa-tree"},null,-1),Qe=t("p",null," Discussions ",-1),Ke={key:4,class:"nav-item"},ze=t("i",{class:"nav-icon fas fa-edit"},null,-1),We=t("p",null," Polls ",-1),Xe={key:5,class:"nav-item"},Je=t("i",{class:"nav-icon fas fa-table"},null,-1),Ye=t("p",null," Tasks ",-1),Ze={key:6,class:"nav-item"},ts=t("i",{class:"nav-icon far fa-calendar-alt"},null,-1),es=t("p",null," Users ",-1),ss={key:7,class:"nav-item"},as=t("i",{class:"nav-icon fas fa-tree"},null,-1),os=t("p",null," Calendar ",-1),ns={key:8,class:"nav-item"},is=t("i",{class:"nav-icon fas fa-tree"},null,-1),cs=t("p",null," Settings ",-1),ls=C({__name:"Sidebar",setup(c){const e=U();return(m,v)=>{var h,g,f,x;const a=N("router-link");return o(),i("div",null,[t("aside",xe,[n(a,{to:"/",class:"brand-link"},{default:l(()=>[$e]),_:1}),t("div",Se,[s(e).user?(o(),i("div",Ce,[t("div",Ne,[t("img",{src:s(kt)((h=s(e).user.profile)==null?void 0:h.avatar),class:"img-circle elevation-2",alt:"User Image"},null,8,Ee)]),t("div",Be,[n(a,{to:{name:"ProfileDetails",params:{userId:(f=(g=s(e))==null?void 0:g.user)==null?void 0:f.id,profileId:(x=s(e).user.profile)==null?void 0:x.id}},class:"d-block"},{default:l(()=>[p(w(s(e).user.full_name),1)]),_:1},8,["to"])])])):_("",!0),t("nav",Ie,[t("ul",Le,[t("li",Ae,[n(a,{to:{name:s(G)},class:"nav-link","active-class":"active"},{default:l(()=>[De,Ue]),_:1},8,["to"])]),s(e).hasPermission(["view committee","view board"])?(o(),i("li",Pe,[n(a,{to:{name:s(ct)},class:"nav-link","active-class":"active"},{default:l(()=>[Re,Te]),_:1},8,["to"])])):_("",!0),s(e).hasPermission(["view meeting"])?(o(),i("li",Ve,[n(a,{to:{name:s(lt)},class:"nav-link","active-class":"active"},{default:l(()=>[Fe,qe]),_:1},8,["to"])])):_("",!0),s(e).hasPermission(["view almanac"])?(o(),i("li",Me,[n(a,{to:{name:s(rt)},class:"nav-link","active-class":"active"},{default:l(()=>[je,He]),_:1},8,["to"])])):_("",!0),s(e).hasPermission(["view discussion"])?(o(),i("li",Oe,[n(a,{to:{name:s(dt)},class:"nav-link","active-class":"active"},{default:l(()=>[Ge,Qe]),_:1},8,["to"])])):_("",!0),s(e).hasPermission(["view poll"])?(o(),i("li",Ke,[n(a,{to:{name:s(ut)},class:"nav-link","active-class":"active"},{default:l(()=>[ze,We]),_:1},8,["to"])])):_("",!0),s(e).hasPermission(["view task"])?(o(),i("li",Xe,[n(a,{to:{name:s(_t)},class:"nav-link","active-class":"active"},{default:l(()=>[Je,Ye]),_:1},8,["to"])])):_("",!0),s(e).hasPermission(["view users"])?(o(),i("li",Ze,[n(a,{to:{name:s(mt)},class:"nav-link","active-class":"active"},{default:l(()=>[ts,es]),_:1},8,["to"])])):_("",!0),s(e).hasPermission(["view calendar"])?(o(),i("li",ss,[n(a,{to:{name:s(vt)},class:"nav-link","active-class":"active"},{default:l(()=>[as,os]),_:1},8,["to"])])):_("",!0),s(e).hasPermission(["view settings"])?(o(),i("li",ns,[n(a,{to:{name:s(ft)},class:"nav-link","active-class":"active"},{default:l(()=>[is,cs]),_:1},8,["to"])])):_("",!0)])])])])])}}}),rs={class:"content-wrapper"},ds={class:"content"},us={class:"container-fluid"},xs=C({__name:"Main",setup(c){return ht(()=>{const e=document.getElementById("app");document.body.classList.add("hold-transition","sidebar-mini","layout-fixed","layout-navbar-fixed","layout-footer-fixed"),e&&e.classList.add("wrapper")}),pt(()=>{document.body.classList.remove("hold-transition","sidebar-mini","layout-fixed","layout-navbar-fixed","layout-footer-fixed");const e=document.getElementById("app");e&&e.classList.remove("wrapper")}),(e,m)=>{const v=N("RouterView");return o(),i(O,null,[p(" ddd "),n(we),n(ls),t("div",rs,[n(Rt),t("section",ds,[t("div",us,[n(v)])])]),n(Mt)],64)}}});export{xs as default};
