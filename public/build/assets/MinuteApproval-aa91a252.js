var ge=Object.defineProperty;var y=(k,I)=>ge(k,"name",{value:I,configurable:!0});import{d as fe,k as ye,j as xe,i as ke,n as Ae,r as m,V as Me,C as v,P as Se,H as we,o as s,c as a,e as t,a1 as ae,g as C,u as d,h as c,t as n,F as _,T as h,$ as Ee,a0 as Ce,_ as Ie}from"./main-d97516e2.js";import{u as Te,c as qe,d as Re,a as g,g as Le,b as Ne}from"./useUnexpectedErrorHandler-01ee037e.js";import{i as Fe,j as He,k as Pe,l as Oe,h as Ve,s as $e,r as Be}from"./useMinuteRequest-40fb106c.js";import{B as De,f as Ge,C as le,D as $}from"./Breadcrumb-62de853f.js";import{u as Ue}from"./useQuery-f8736dfe.js";import"./index-a4206e89.js";import"./useQueryClient-99479e2d.js";const x=y(k=>(Ee("data-v-16456a85"),k=k(),Ce(),k),"_withScopeId"),je={class:"card card-widget shadow-lg"},Ke={class:"card-footer"},We={class:"d-flex align-items-center"},Ye={class:"ml-3 flex-1"},ze=x(()=>t("i",{class:"fas fa-chevron-left"},null,-1)),Qe={key:0,class:"ml-auto flex self-end"},Je={key:0,type:"button",class:"btn btn-sm mr-1 btn-success btn-lg"},Xe=x(()=>t("i",{class:"fas fa-door-closed mr-1"},null,-1)),Ze={key:1,type:"button",class:"btn btn-sm mr-1 btn-warning btn-lg"},et=x(()=>t("i",{class:"fa fa-check mr-1"},null,-1)),tt=x(()=>t("i",{class:"fa fa-check mr-1"},null,-1)),st={key:0,class:"card"},at={class:"card-body"},lt=x(()=>t("span",{class:"info-box-icon",style:{left:"4%","margin-left":"-45px",position:"absolute",top:"88px"}},[t("div",{class:"h3 text-bold font-bold uppercase text-primary"}," Confidential")],-1)),nt={class:"text-center logo-container"},it=["src"],ot={class:"h3 text-center text-primary text-bold font-bold uppercase"},rt=x(()=>t("hr",{class:"thick-line"},null,-1)),dt={class:"text-center text-primary text-bold uppercase h4"},ut={class:"text-center text-primary text-bold uppercase h4"},ct={key:0,class:"mt-1 text-primary text-bold uppercase"},_t={key:1,class:"table table-borderless"},pt={class:"p-0"},mt={class:"p-0 text-primary text-bold uppercase"},ht={key:2,class:"mt-2 text-primary text-bold uppercase"},bt={key:3,class:"table table-borderless"},vt={class:"p-0"},gt={class:"p-0 text-primary text-bold uppercase"},ft={key:4,class:"mt-2 text-primary text-bold uppercase"},yt={key:5,class:"table table-borderless"},xt={class:"p-0"},kt={class:"p-0 text-primary text-bold uppercase"},At={key:6,class:"mt-2 text-primary text-bold uppercase"},Mt={key:7,class:"table table-borderless"},St={class:"p-0"},wt={class:"p-0 text-primary text-bold uppercase"},Et=x(()=>t("h5",{class:"mt-2 text-primary text-bold uppercase"},"Agenda",-1)),Ct={class:"list-unstyled"},It={class:"list-unstyled ml-4"},Tt={id:"MinutesEditor",class:"container"},qt={class:"codex-editor"},Rt={class:"codex-editor__redactor",style:{"padding-bottom":"300px"}},Lt={class:"ce-block"},Nt={class:"flex w-full"},Ft={class:"flex-1"},Ht={key:0,"data-list_format":"num_la_lr",class:"agenda-list mb-0"},Pt={class:"rounded-lg border border-transparent hover:cursor-pointer border-blue -ml-7 p-2 pl-7 relative border-blue"},Ot={class:"flex gap-2 items-start"},Vt={class:"font-medium flex-1"},$t={class:"font-bold text-primary"},Bt=["innerHTML"],Dt={key:0,class:"min-h-6"},Gt={class:"rounded-lg border border-transparent hover:cursor-pointer border-blue -ml-7 p-2 pl-7 relative border-blue"},Ut={class:"flex gap-2 items-start"},jt={class:"font-medium flex-1"},Kt={class:"font-bold text-primary"},Wt=["innerHTML"],Yt=fe({__name:"MinuteApproval",setup(k){const I=ye();function ne(){I.back()}y(ne,"goBack");const S=xe();ke();const ie=Ae(),B=S.params.boardId;S.params.meetingId;const b=S.params.scheduleId;S.params.minutesId;const A=m(null),w=m("create"),E=m(!1),D=m([]),G=m(null),oe=m(null),T=m(-1),q=m(-1),U=m(!1),R=m(!1),re=m([{text:""}]),de=Te(),ue=qe({schedule_id:Re().required(),board_id:g().nullable(),committee_id:Le().nullable(),membership_id:g().nullable(),minute_id:g().nullable(),agenda_id:g().required(),detail_minute_id:g().nullable(),subdetailminute_id:g().nullable(),subagenda_id:g().nullable(),description:g().required(),status:g().required()}),{handleSubmit:ce,setErrors:_e,setFieldValue:p,values:zt}=Ne({validationSchema:ue,initialValues:{schedule_id:b,board_id:B,committee_id:null,membership_id:null,minute_id:A.value,agenda_id:"",detail_minute_id:null,subdetailminute_id:null,subagenda_id:null,description:"",status:"unpublished"}});ce(async(e,{resetForm:i})=>{try{const o={schedule_id:e.schedule_id,committee_id:null,membership_id:null,minute_id:A.value?A.value.toString():null,agenda_id:e.agenda_id.toString(),detail_minute_id:e.detail_minute_id?e.detail_minute_id.toString():null,subdetailminute_id:e.subdetailminute_id?e.subdetailminute_id.toString():null,subagenda_id:e.subagenda_id?e.subagenda_id.toString():null,description:e.description,status:e.status};w.value==="create"?E.value?await Fe(o,b):R.value&&await He(o,b):T.value!==-1?(await Pe(o,b),console.log("payload",o)):q.value!==-1&&await Oe(o,b),await L(),pe()}catch(o){o instanceof Me?_e(o.messages):de(o)}});const pe=y(()=>{w.value="create",E.value=!1,G.value=null,oe.value=null,T.value=-1,q.value=-1,U.value=!1,R.value=!1,p("schedule_id",b),p("board_id",B),p("committee_id",null),p("membership_id",null),p("minute_id",A.value),p("agenda_id",""),p("detail_minute_id",null),p("subdetailminute_id",null),p("subagenda_id",null),p("description",""),p("status","unpublished")},"reset");v(()=>{const e=E.value&&G.value===agenda.id&&q.value===pIndex&&T.value===cIndex&&w.value==="create";return console.log("isAddingChild computed:",e),e}),v(()=>{const e=U.value&&!R.value&&!E.value&&w.value==="edit";return console.log("isEditing computed:",e),e});const me=y(()=>Ue({queryKey:["getMinutesKey",b],queryFn:async()=>{const e=await Be(b,{paginate:"false"});return A.value=e.data.id,e.data},onSuccess:e=>{},onError:e=>{console.error("Failed to fetch minutes:",e)}}),"getMinutes"),{isLoading:Qt,data:r,refetch:L}=me(),N=v(()=>{var e;return((e=r.value)==null?void 0:e.attendances.filter(i=>i.rsvp_status==="Yes"&&i.attendance_status==="Attended"))||[]}),F=v(()=>{var e;return((e=r.value)==null?void 0:e.attendances.filter(i=>i.rsvp_status==="Online"&&i.attendance_status==="Attended"))||[]}),H=v(()=>{var e;return((e=r.value)==null?void 0:e.attendances.filter(i=>["Yes","No","Maybe"].includes(i.rsvp_status)&&i.attendance_status==="Absent"))||[]}),P=v(()=>{var e;return((e=r.value)==null?void 0:e.attendances.filter(i=>i.rsvp_status==="Pending"&&i.attendance_status==="Absent"))||[]}),he=y(async()=>{const e=await Ve(b,{paginate:"false"});D.value=e.data},"getmeetingagendas"),O=v(()=>D.value);Se(async()=>{await L(),he()}),we(()=>re.value,e=>{e&&(A.value=e)},{deep:!0});const V=v(()=>{const e={};return r.value&&r.value.detailminutes&&r.value.detailminutes.forEach(i=>{e[i.agenda_id]||(e[i.agenda_id]=[]),e[i.agenda_id].push(i),i.subdetailminutes.forEach(o=>{e[o.subagenda_id]||(e[o.subagenda_id]=[]),e[o.subagenda_id].push(o)})}),e}),j=v(()=>ie.getSettings()),be=y(async e=>{await $e(e),await L()},"onAcceptCEOApproval");return(e,i)=>{var o,K,W,Y,z,Q,J,X,Z,ee,te;return s(),a(_,null,[t("div",je,[t("div",Ke,[t("div",We,[t("div",Ye,[t("a",{href:"",onClick:ae(ne,["prevent"]),class:"text-blue-primary"},[ze,C(" Go back To Meeting ")])]),d(r)?(s(),a("div",Qe,[((o=d(r).schedule)==null?void 0:o.closestatus)==="closed"?(s(),a("button",Je,[Xe,C(" Meeting Closed ")])):c("",!0),d(r).approvalstatus==="approved"?(s(),a("button",Ze,[et,C(" This Minutes are Approved ")])):(s(),a("button",{key:2,type:"button",class:"btn btn-sm mr-1 btn-warning btn-lg",onClick:i[0]||(i[0]=ae(l=>be(d(r).id),["prevent"]))},[tt,C(" Click here to Approve This Minutes ")]))])):c("",!0)])])]),d(r)?(s(),a("div",st,[t("div",at,[lt,t("div",nt,[t("img",{src:d(De)((K=j.value)==null?void 0:K.logo),alt:"Organization Logo",class:"img-fluid logo"},null,8,it)]),t("div",ot,n((W=j.value)==null?void 0:W.name),1),rt,t("h4",dt,"MINUTES OF THE "+n((z=(Y=d(r))==null?void 0:Y.meeting)==null?void 0:z.title),1),t("p",ut," HELD AT "+n((J=(Q=d(r))==null?void 0:Q.meeting)==null?void 0:J.location)+" ON "+n(d(Ge)((Z=(X=d(r))==null?void 0:X.schedule)==null?void 0:Z.date))+" STARTING AT "+n((te=(ee=d(r))==null?void 0:ee.schedule)==null?void 0:te.start_time),1),N.value.length?(s(),a("h5",ct,"Present")):c("",!0),N.value.length?(s(),a("table",_t,[t("tbody",null,[(s(!0),a(_,null,h(N.value,(l,u)=>(s(),a("tr",{key:l.id},[t("td",pt,n(u+1)+". "+n(l.membership.user.full_name),1),t("td",mt," - "+n(l.membership.position.name),1)]))),128))])])):c("",!0),F.value.length?(s(),a("h5",ht,"Present on E-platform ")):c("",!0),F.value.length?(s(),a("table",bt,[t("tbody",null,[(s(!0),a(_,null,h(F.value,(l,u)=>(s(),a("tr",{key:l.id},[t("td",vt,n(u+1)+". "+n(l.membership.user.full_name),1),t("td",gt," - "+n(l.membership.position.name),1)]))),128))])])):c("",!0),H.value.length?(s(),a("h5",ft,"Absent With Apology ")):c("",!0),H.value.length?(s(),a("table",yt,[t("tbody",null,[(s(!0),a(_,null,h(H.value,(l,u)=>(s(),a("tr",{key:l.id},[t("td",xt,n(u+1)+". "+n(l.membership.user.full_name),1),t("td",kt," - "+n(l.membership.position.name),1)]))),128))])])):c("",!0),P.value.length?(s(),a("h5",At," Absent ")):c("",!0),P.value.length?(s(),a("table",Mt,[t("tbody",null,[(s(!0),a(_,null,h(P.value,(l,u)=>(s(),a("tr",{key:l.id},[t("td",St,n(u+1)+". "+n(l.membership.user.full_name),1),t("td",wt," - "+n(l.membership.position.name),1)]))),128))])])):c("",!0),Et,t("ul",Ct,[(s(!0),a(_,null,h(O.value,(l,u)=>(s(),a(_,{key:l.id},[t("li",null,n(u+1)+". "+n(l.title),1),t("ul",It,[(s(!0),a(_,null,h(l.children,(f,M)=>(s(),a("li",{key:f.id},n(u+1)+"."+n(M+1)+" "+n(f.title),1))),128))])],64))),128))])]),t("div",Tt,[t("div",qt,[t("div",Rt,[t("div",Lt,[t("div",Nt,[t("div",Ft,[O.value?(s(),a("ol",Ht,[(s(!0),a(_,null,h(O.value,(l,u)=>(s(),a("li",{class:"mb-2 hover:border-gray-400",key:u},[t("div",Pt,[t("div",Ot,[t("div",Vt,[(s(!0),a(_,null,h(V.value[l.id],(f,M)=>(s(),a("div",{key:M},[t("div",$t,n(d(le)(d($)(u),l.title)),1),t("div",{innerHTML:f.description},null,8,Bt)]))),128))])])]),l.children?(s(),a("ol",Dt,[(s(!0),a(_,null,h(l.children,(f,M)=>(s(),a("li",{class:"mb-2 hover:border-gray-400",draggable:"false",key:M},[t("div",Gt,[t("div",Ut,[t("div",jt,[t("div",Kt,n(d(le)(d($)(u),f.title,void 0,void 0,void 0,d($)(M))),1),(s(!0),a(_,null,h(V.value[l.id],(Jt,ve)=>(s(),a("div",{key:ve},[(s(!0),a(_,null,h(V.value[f.id],se=>(s(),a("div",{key:se.id},[t("div",{innerHTML:se.description},null,8,Wt)]))),128))]))),128))])])])]))),128))])):c("",!0)]))),128))])):c("",!0)])])])])])])])):c("",!0)],64)}}});const is=Ie(Yt,[["__scopeId","data-v-16456a85"]]);export{is as default};
