var vt=Object.defineProperty;var d=(R,y)=>vt(R,"name",{value:y,configurable:!0});import{d as xe,i as Ce,j as De,k as Qe,r as h,V as qe,C as Z,P as ke,b as Ne,u as n,o as t,c as s,e,T as I,F as G,R as Q,f as A,w as we,g as H,t as r,h as _,l as ye,U as K,W as je,X as Oe,_ as Ee,H as lt,Y as bt,Z as ft,$ as it,a0 as gt,a1 as We,a2 as yt,a3 as xt,a4 as $t}from"./main-dbb1f149.js";import{f as wt}from"./useBoardRequest-ccde2887.js";import{r as kt,a as Mt,l as dt,s as et,i as Ct,u as tt,c as St,b as st,d as Tt,e as Pt,g as qt,f as ot,h as He,j as Dt,k as It,m as Fe,n as Ft,o as Bt,p as Et,q as Ut,t as At,v as at,F as nt,w as Rt,x as Vt}from"./Breadcrumb-e536828e.js";import{u as Ue,d as Ze,c as he,a as p,b as Ae,e as Te,f as Le}from"./useUnexpectedErrorHandler-4e609aa9.js";import{a as Lt,b as jt,c as Ot,d as Nt}from"./useCommitteeRequest-2bb6c0bc.js";import{u as rt}from"./useStaffRequest-461467c3.js";import{F as Pe}from"./FormInput-9ec9e7b2.js";import{F as ze}from"./FormQuillEditor-4b336791.js";import{F as Ye}from"./FormUpload-23b8c503.js";import{u as Me}from"./useQuery-c5d8918e.js";import{u as Ht,a as Kt,b as zt,c as Gt,d as Yt,v as Be,e as Qt,f as Wt,g as Zt,F as Ke,h as Jt,i as Xt,j as es,k as ts,l as Je,m as ss,n as os}from"./FormDynamicInput-e310363d.js";import{_ as Ve}from"./FormDateTimeInput.vue_vue_type_style_index_0_lang-d918e2dc.js";import{F as as}from"./FormRadioInput-9dcce75e.js";import{u as ns,a as ls,b as is}from"./usePollRequest-5f714ee2.js";import{u as ds,a as rs,b as cs}from"./useTaskRequest-6eb4f483.js";import"./index-78587978.js";import"./staff_routes-69f96f4b.js";import"./useQueryClient-785d5088.js";import"./folder_routes-739dd8fe.js";const ge=d(R=>(je("data-v-ba6babd4"),R=R(),Oe(),R),"_withScopeId$4"),us={key:0,class:"container-fluid"},ms={class:"row"},_s={class:"col-12"},ps={class:"card"},hs={class:"card-header d-flex justify-content-between"},vs=ge(()=>e("h2",{class:"card-header-title h3"},"Committee",-1)),bs={class:"ml-auto flex items-center space-x-2"},fs={class:"card-body"},gs={class:"row"},ys={class:"info-box shadow-lg p-4 mb-4 d-flex flex-column flex-grow-1"},xs={class:"d-flex flex-column flex-grow-1 align-items-center"},$s=["src"],ws={class:"ml-3 flex-1 w-100"},ks={class:"h2 mb-2"},Ms={class:"mb-1"},Cs={class:"text-gray-900 m-0"},Ss={key:0},Ts=ge(()=>e("br",null,null,-1)),Ps=["onClick"],qs=ge(()=>e("i",{class:"fa fa-plus mr-2"},null,-1)),Ds=["innerHTML"],Is={class:"d-flex justify-content-end mt-2 w-100"},Fs=["onClick"],Bs=ge(()=>e("i",{class:"fa fa-edit"},null,-1)),Es=[Bs],Us=["onClick"],As=ge(()=>e("i",{class:"fa fa-trash-alt"},null,-1)),Rs=[As],Vs=ge(()=>e("i",{class:"fa fa-eye"},null,-1)),Ls={class:"flex justify-center items-center min-h-screen"},js={method:"dialog",class:"modal-box rounded-xl relative bg-white shadow-xl"},Os={class:"font-bold text-lg text-center"},Ns=ge(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Hs={class:"overflow-auto p-4",style:{"max-height":"80vh"}},Ks={class:"grid grid-cols-1 md:grid-cols-2 gap-4 p-2"},zs={class:"col-span-2"},Gs={class:"flex flex-wrap -mx-2"},Ys={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Qs={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Ws=["src"],Zs={class:"w-full md:w-1/3 px-1 md:px-2 mb-4"},Js=["src"],Xs={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},eo={class:"flex justify-center col-md-6"},to={method:"dialog",class:"modal-box rounded-xl"},so=ge(()=>e("h3",{class:"font-bold text-lg justify-center flex"},r("Add Members"),-1)),oo=ge(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),ao={class:"w-full mt-6 p-2"},no={class:"font-thin text-sm flex flex-col items-center gap-6"},lo={key:0,class:"message"},io=ge(()=>e("button",{type:"submit",class:"btn btn-md mb-1 w-full pt-1 text-red-600 mt-6 bg-primary"},r("Add Members"),-1)),ro={key:1,class:"container-fluid"},co=ge(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),uo=[co],mo=xe({__name:"Committees",setup(R){const y=Ce(),L=De();Qe();const x=h(!1),M=h("create"),m=h("board"),j=L.params.boardId,P=h(""),F=h([]),C=h(null),w=h(null),V=h([]),ee=Ue(),E=Ze().test("fileOrString","Must be a file or a string",v=>v instanceof File||typeof v=="string"),b=he({name:p().required("Name is required"),description:p().required("Description is required"),icon:E.required("Icon is required"),cover:E.required("Cover is required")}),{handleSubmit:$,setErrors:ae,setFieldValue:z,values:ie}=Ae({validationSchema:b,initialValues:{name:"",description:"",icon:"",cover:""}}),ue=$(async v=>{var k,i;try{const g={name:v.name,description:v.description,icon:v.icon,cover:v.cover};m.value==="committee"&&(M.value==="create"?await Lt(g,j):M.value==="edit"&&await jt(g,P.value)),(k=C.value)==null||k.close(),(i=w.value)==null||i.close(),m.value==="committee"&&await N(),kt(),Mt(),me(),F.value=[],x.value=!1}catch(g){g instanceof qe?ae(g.messages):ee(g)}}),B=d(async()=>{var v;try{if(m.value==="committee"){const k={members:F.value};await Ot(k,j,P.value)}(v=w.value)==null||v.close(),m.value==="committee"&&await N(),me(),F.value=[],x.value=!1}catch(k){k instanceof qe?ae(k.messages):ee(k)}},"onSubmitMembers"),{errorMessage:te}=Te("members"),S=d((v,k)=>{var i;k==="committee"&&(m.value="committee"),M.value="create",x.value=!0,(i=C.value)==null||i.showModal()},"openCreateModal"),J=d((v,k)=>{var i;z("name",v.name),z("description",v.description),z("icon",v.icon),z("cover",v.cover),st(v.cover),tt(v.icon),k==="committee"&&(P.value=v.id,m.value="committee"),M.value="edit",x.value=!0,(i=C.value)==null||i.showModal()},"openEditModal"),me=d(()=>{z("name",""),z("description",""),z("icon",""),z("cover",""),M.value="create",m.value="board",x.value=!0,P.value=""},"resetBoardForm"),re=d((v,k)=>{var g;const i=v.members.map(l=>l.user.id.toString());F.value=i,M.value="members",k==="committee"&&(P.value=v.id,selectedBoardId.value=v.committeeable.details.id,m.value="committee"),x.value=!0,(g=w.value)==null||g.showModal()},"openEditMembersModal"),se=d(()=>{},"selectedUsers"),_e=d(()=>{},"removeSelectedUsers"),ne=Z(()=>{var k;const v=[];return V.value&&((k=V.value)==null?void 0:k.length)>0&&V.value.reduce((i,g)=>(i.push({id:g.id,name:`${g.full_name}`}),i),v),v}),be=d(async()=>{const v=await rt({paginate:"false"});V.value=v.data},"getUsers");ke(async()=>{window.dispatchEvent(new CustomEvent("updateTitle",{detail:"Committees"})),be()});const de=d(()=>Me({queryKey:["getCommitteesKey"],queryFn:async()=>(await Nt(j,{paginate:"false"})).data}),"getCommittees"),{isLoading:pe,data:f,refetch:N}=de(),q=Z(()=>M.value==="create"&&m.value==="board"?"Create Board":M.value==="edit"&&m.value==="board"?"Edit Board":M.value==="create"&&m.value==="committee"?"Create Committee":M.value==="edit"&&m.value==="committee"?"Edit Committee":"");return(v,k)=>{var l;const i=Ne("router-link"),g=Ne("Multiselect");return n(y).hasPermission(["view board"])?(t(),s("div",us,[e("div",ms,[e("div",_s,[e("div",ps,[e("div",hs,[vs,e("div",bs,[e("button",{class:"btn btn-primary btn-sm",onClick:k[0]||(k[0]=I(a=>S("","committee"),["prevent"]))}," New Comittee ")])]),e("div",fs,[e("div",gs,[(t(!0),s(G,null,Q(n(f),a=>(t(),s("div",{class:"col-md-4 col-12 d-flex",key:a.id},[e("div",ys,[e("div",xs,[e("img",{class:"img-circle elevation-2",src:n(dt)(a.icon),alt:"User Avatar",style:{width:"128px",height:"128px"}},null,8,$s),e("div",ws,[e("h3",ks,[A(i,{to:{name:"CommitteeDetails",params:{committeeId:a.id}},class:"badge badge-soft bg-primary text-wrap"},{default:we(()=>[H(r(a.name),1)]),_:2},1032,["to"])]),e("h3",Ms,[H(" Board: "),A(i,{to:{name:"BoardDetails",params:{boardId:a.committeeable.details.id}},class:"badge badge-soft text-wrap"},{default:we(()=>[H(r(a.committeeable.details.name),1)]),_:2},1032,["to"])]),e("p",Cs," Owner: "+r(a.owner),1),a.members?(t(),s("div",Ss,[e("span",null,r(a.members.length)+" "+r(a.members.length===1?"Member":"Members"),1),Ts,n(y).hasPermission(["add member to committee"])?(t(),s("a",{key:0,href:"",onClick:I(c=>re(a,"committee"),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},[qs,H(" Members ")],8,Ps)):_("",!0)])):_("",!0),e("p",{class:"text-muted m-0 truncate",innerHTML:a.description},null,8,Ds)])]),e("div",Is,[n(y).hasPermission(["edit committee"])?(t(),s("a",{key:0,href:"",onClick:I(c=>J(a,"committee"),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out mr-2"},Es,8,Fs)):_("",!0),n(y).hasPermission(["delete committee"])?(t(),s("a",{key:1,href:"",onClick:I(c=>v.deleteCommittee(a),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out mr-2"},Rs,8,Us)):_("",!0),n(y).hasPermission(["view committee"])?(t(),ye(i,{key:2,to:{name:"CommitteeDetails",params:{committeeId:a.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:we(()=>[Vs]),_:2},1032,["to"])):_("",!0)])])]))),128))])])])])]),e("div",Ls,[e("dialog",{id:"CommitteeModal",class:"modal w-full max-w-4xl mx-auto p-0",ref_key:"CommitteeModal",ref:C},[e("form",js,[e("h3",Os,r(q.value),1),Ns,e("div",Hs,[e("div",Ks,[e("div",zs,[e("form",{novalidate:"",onSubmit:k[3]||(k[3]=I((...a)=>n(ue)&&n(ue)(...a),["prevent"])),class:""},[e("div",Gs,[e("div",Ys,[A(Pe,{labeled:!0,label:"Name",name:"name",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter Name",type:"text"})]),e("div",Qs,[A(Ye,{labeled:!0,label:"Upload icon Image",name:"icon",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter icon Image",type:"file",accept:n(et).join(", "),onChange:k[1]||(k[1]=a=>n(Ct)(a))},null,8,["accept"]),e("img",{src:n(tt)((l=n(ie))==null?void 0:l.icon),class:"file_attachment"},null,8,Ws)]),e("div",Zs,[A(Ye,{labeled:!0,label:"Upload Cover Image",name:"cover",class:"w-full text-sm text-white tracking-wide",placeholder:"Enter Cover Image",type:"file",accept:n(et).join(", "),onChange:k[2]||(k[2]=a=>n(St)(a))},null,8,["accept"]),e("img",{src:n(st)(n(ie).cover),class:"file_attachment"},null,8,Js)])]),A(ze,{label:"Description",name:"description",theme:"snow",placeholder:"Enter Description",toolbar:"full",contentType:"html",class:"col-span-3 mb-4"}),e("button",Xs,r(q.value),1)],32)])])])])],512)]),e("div",eo,[e("dialog",{id:"membersmodal",class:"modal",ref_key:"membersmodal",ref:w},[e("form",to,[so,oo,e("div",ao,[e("div",no,[e("form",{novalidate:"",onSubmit:I(B,["prevent"]),class:"w-full rounded-xl mx-auto p-1 custom-modal"},[e("div",{class:K(["multiselect-container",{error:!!n(te)}])},[A(g,{id:"members",modelValue:F.value,"onUpdate:modelValue":k[4]||(k[4]=a=>F.value=a),mode:"tags",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:ne.value,valueProp:"id",trackBy:"id",label:"name",class:K(["multiselect-container",{error:!!n(te)}]),onSelect:k[5]||(k[5]=a=>se()),onDeselect:k[6]||(k[6]=a=>_e())},null,8,["modelValue","options","class"]),n(te)?(t(),s("div",lo,r(n(te)),1)):_("",!0)],2),io],32)])])])],512)])])):(t(),s("div",ro,uo))}}});const _o=Ee(mo,[["__scopeId","data-v-ba6babd4"]]),oe=d(R=>(je("data-v-455161d6"),R=R(),Oe(),R),"_withScopeId$3"),po={key:0},ho={class:"card"},vo={class:"card-header p-3"},bo={class:"row"},fo={class:"col-12"},go={class:"row"},yo={class:"col-lg-9 col-md-8 col-12 mt-2"},xo={"aria-label":"Breadcrumbs",class:"text-sm overflow-hidden"},$o={class:"breadcrumb mb-0 bg-warning"},wo=["onClick"],ko={class:"col-lg-3 col-md-4 col-12"},Mo={class:"row"},Co={class:"col-md-6 col-12 mt-2"},So={class:"dropdown"},To={class:"nav-link dropdown-toggle btn btn-secondary btn-block",href:"#",id:"navbarDropdown",type:"button",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},Po=oe(()=>e("span",{class:"text-warning mr-1"},"sort by:",-1)),qo={class:"dropdown-menu","aria-labelledby":"navbarDropdown"},Do=["onClick"],Io={class:"col-md-6 col-12 mt-2"},Fo={key:0,class:"dropdown"},Bo={key:0,class:"nav-link dropdown-toggle btn btn-primary btn-block",href:"#",id:"navbarDropdown",type:"button",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},Eo=oe(()=>e("i",{class:"fas fa-plus mr-2"},null,-1)),Uo={class:"dropdown-menu","aria-labelledby":"navbarDropdown"},Ao=oe(()=>e("i",{class:"fas fa-plus"},null,-1)),Ro=oe(()=>e("i",{class:"fas fa-file-upload"},null,-1)),Vo={key:0,class:"col-12 mt-3"},Lo={class:"input-group input-group-lg"},jo=oe(()=>e("div",{class:"input-group-append"},[e("button",{type:"submit",class:"btn btn-lg btn-default"},[e("i",{class:"fa fa-search"})])],-1)),Oo={class:"card-body py-0 px-4 min-h-[300px] relative -top-px z-10"},No={class:"table-responsive"},Ho={class:"table mb-0"},Ko={class:"w-28"},zo={key:0},Go=["onClick"],Yo=["src"],Qo={key:1},Wo=["src"],Zo={key:0},Jo={class:"font-weight-bold text-primary text-truncate"},Xo={class:"text-sm font-weight-bold text-primary"},ea=oe(()=>e("span",{class:"text-black"},"Folders",-1)),ta={class:"text-sm font-weight-bold text-primary"},sa=oe(()=>e("span",{class:"text-black"},"Files",-1)),oa={key:1},aa={key:0},na={class:"font-weight-bold text-primary text-truncate"},la={class:"text-sm font-weight-bold text-primary"},ia={class:"text-black"},da={class:"w-28"},ra={key:0},ca={class:"text-xs text-primary text-truncate"},ua={key:1},ma={key:0},_a={class:"text-xs text-primary text-truncate"},pa={class:"w-20 text-center"},ha={class:"flex justify-end space-x-2"},va={key:0},ba=["onClick"],fa=oe(()=>e("i",{class:"far fa-edit"},null,-1)),ga=[fa],ya={key:1},xa=["onClick"],$a=oe(()=>e("i",{class:"far fa-edit"},null,-1)),wa=[$a],ka=oe(()=>e("i",{class:"far fa-eye"},null,-1)),Ma={class:"flex justify-center col-md-6"},Ca={method:"dialog",class:"modal-box rounded-xl"},Sa={class:"font-bold text-lg justify-center flex"},Ta=oe(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Pa={class:"w-full mt-6 p-2"},qa={class:"font-thin text-sm flex flex-col items-center gap-6"},Da={class:"row"},Ia={key:0,class:"row mt-2 ml-2"},Fa={key:0,class:"row mt-2 ml-2"},Ba={class:"col-md-6"},Ea=["src"],Ua={class:"col-md-6"},Aa=oe(()=>e("strong",null,"File Name:",-1)),Ra={class:"text-bold text-primary"},Va=oe(()=>e("strong",null,"File Size:",-1)),La={class:"text-bold text-primary"},ja=oe(()=>e("strong",null,"Type:",-1)),Oa={class:"text-bold text-primary"},Na=oe(()=>e("strong",null,"Last Modified: ",-1)),Ha={class:"text-bold text-primary"},Ka={type:"submit",class:"btn btn-md mb-1 w-full pt-1 text-red-600 mt-6 bg-primary"},za={key:1},Ga=oe(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),Ya=[Ga],Qa=xe({__name:"Documents",setup(R){const y=Ce(),L=Ue(),x=De(),M=h("create"),m=h("folder"),j=h("name-asc"),P=h(""),F=h([]),C=x.params.boardId,w=h([{id:"1",name:"Folders"}]),V=h(null),ee=h(!1),E=h(null),b=h(null),$=[{id:"name-asc",name:"Name (A-Z)"},{id:"name-desc",name:"Name (Z-A)"},{id:"date-newest",name:"Newest to oldest"},{id:"date-oldest",name:"Oldest to newest"}];function ae(l){j.value=l}d(ae,"applySort");const z=Z(()=>{const l=$.find(a=>a.id===j.value);return l?l.name:"Unknown"});function ie(l){console.log("folder",l),w.value.push({id:l.id,name:l.name})}d(ie,"addToNavigationPath");function ue(l){const a=w.value.slice(0,l+1);if(a.length!==w.value.length){w.value=a;const c=B(w.value.at(-1).id,re.value);F.value=c?c.children||[]:[]}}d(ue,"navigateTo");function B(l,a){if(!Array.isArray(a))return null;for(const c of a){if(c.id===l)return c;if(c.children&&Array.isArray(c.children)){const o=B(l,c.children);if(o)return o}}return null}d(B,"findFolderById");function te(l){w.value.at(-1).id!==l.id&&(ie(l),console.log("folder",l.children),F.value=l.children||[])}d(te,"openFolder");function S(l){let a=0,c=0;return l.children&&l.children.length>0&&l.children.forEach(o=>{o.type==="folder"?a++:o.type==="file"&&c++}),{folderCount:a,fileCount:c}}d(S,"countChildrenTypes");const J=d(()=>Me({queryKey:["getBoardFoldersKey",C],queryFn:async()=>(await Yt(C,{paginate:"false"})).data}),"getBoardFolders"),{isLoading:me,data:re,refetch:se}=J();ke(async()=>{await se()}),lt(re,l=>{var a;if(l&&l.length>0)if(w.value.length===1&&(l[0],w.value[0].id="1",w.value[0].name="Documents"),w.value.length===1)F.value=l;else{const c=B((a=w.value.at(-1))==null?void 0:a.id,l);F.value=c?c.children||[]:[]}},{immediate:!0});const _e=Z(()=>P.value?ne.value.filter(l=>l.name.toLowerCase().includes(P.value.toLowerCase())):ne.value),ne=Z(()=>{const l=w.value.length>1?F.value:re.value;return Array.isArray(l)?[...l].sort((a,c)=>{switch(j.value){case"name-asc":return a.name.localeCompare(c.name);case"name-desc":return c.name.localeCompare(a.name);case"date-newest":return new Date(c.created_at).getTime()-new Date(a.created_at).getTime();case"date-oldest":return new Date(a.created_at).getTime()-new Date(c.created_at).getTime();default:return 0}}):[]}),be=he({name:p().required(),meeting_id:p().required(),board_id:p().required(),folder_id:p().nullable(),parent_id:p(),type:p().oneOf(["folder","file"]).required(),fileupload:Ze().nullable()}),{handleSubmit:de,setErrors:pe,setFieldValue:f,values:N}=Ae({validationSchema:be,initialValues:{name:"",meeting_id:C,board_id:C,folder_id:null,parent_id:"",type:"",fileupload:null}}),q=d(l=>{var o;const a=l.target;if(!((o=a.files)!=null&&o.length))return;const c=a.files[0];f("name",c.name),f("type","file")},"updateName"),v=d(l=>{var c;g(),M.value="create",m.value=l,ee.value=!0,(c=b.value)==null||c.showModal(),f("type",l);const a=w.value.at(-1);f("parent_id",a.id),console.log("parent",a)},"openCreateFolderModal"),k=de(async(l,{resetForm:a})=>{var c;try{if(M.value==="create")if(m.value==="folder"){const o={children:[],created_at:null,icon:null,id:null,meeting_id:l.meeting_id,board_id:l.board_id,folder_id:null,name:l.name,parent_id:l.parent_id.toString(),type:l.type,fileupload:null,media:[]};await Ht(o,C)}else{const o={children:[],created_at:null,icon:null,id:null,meeting_id:l.meeting_id,board_id:l.board_id,folder_id:null,name:l.name,parent_id:l.parent_id.toString(),type:l.type,fileupload:l.fileupload,media:[]};await Kt(o,C)}else if(m.value==="folder"){const o={children:[],created_at:null,folder_id:null,icon:null,id:null,meeting_id:l.meeting_id,board_id:l.board_id,name:l.name,parent_id:l.parent_id.toString(),type:l.type,fileupload:null,media:[]},U=E.value?E.value.toString():null;o.folder_id=U,await zt(o,C,o.folder_id)}else{const o={children:[],created_at:null,folder_id:null,icon:null,id:null,meeting_id:l.meeting_id,board_id:l.board_id,name:l.name,parent_id:l.parent_id.toString(),type:l.type,fileupload:l.fileupload,media:[]},U=E.value?E.value.toString():null;o.folder_id=U,await Gt(o,C,o.folder_id)}await se(),g(),(c=b.value)==null||c.close()}catch(o){o instanceof qe?pe(o.messages):L(o)}}),i=d((l,a)=>{var c;g(),V.value=l,E.value=l.id.toString(),M.value="edit",m.value=a,ee.value=!0,f("name",l.name),f("folder_id",l.id),f("type",a),a==="file"&&(f("fileupload",l.name),Bt(l.media[0])),f("parent_id",l.id),console.log("folder.media",l.name),(c=b.value)==null||c.showModal()},"openEditFolderModal"),g=d(()=>{f("name",""),f("folder_id",null),f("fileupload",""),f("parent_id",""),f("type",""),m.value="folder",M.value="create",ee.value=!1,V.value=null,E.value=null,Tt()},"resetFolder");return(l,a)=>{const c=Ne("router-link");return n(y).hasPermission(["view folders"])?(t(),s("div",po,[e("div",ho,[e("div",vo,[e("div",bo,[e("div",fo,[e("div",go,[e("div",yo,[e("nav",xo,[e("ol",$o,[(t(!0),s(G,null,Q(w.value,(o,U)=>(t(),s("li",{key:o.id,class:"breadcrumb-item"},[e("a",{href:"#",class:"text-gray-800 font-medium",onClick:I(T=>ue(U),["prevent"])},r(o.name),9,wo)]))),128))])])]),e("div",ko,[e("div",Mo,[e("div",Co,[e("div",So,[e("button",To,[Po,H(r(z.value),1)]),e("div",qo,[(t(),s(G,null,Q($,o=>e("a",{key:o.id,href:"#",class:"dropdown-item",onClick:I(U=>ae(o.id),["prevent"])},r(o.name),9,Do)),64))])])]),e("div",Io,[w.value.length>1?(t(),s("div",Fo,[n(y).hasPermission(["create folders","upload documents","create dropzone"])?(t(),s("button",Bo,[Eo,H(" New ")])):_("",!0),e("div",Uo,[n(y).hasPermission(["create folders","create dropzone"])?(t(),s("a",{key:0,href:"#",onClick:a[0]||(a[0]=I(o=>v("folder"),["prevent"])),class:"dropdown-item"},[Ao,H(" New folder ")])):_("",!0),n(y).hasPermission(["upload documents"])?(t(),s("a",{key:1,href:"#",onClick:a[1]||(a[1]=I(o=>v("file"),["prevent"])),class:"dropdown-item"},[Ro,H(" Upload a file ")])):_("",!0)])])):_("",!0)])])])])]),n(y).hasPermission(["search documents"])?(t(),s("div",Vo,[e("div",Lo,[bt(e("input",{type:"search",class:"form-control form-control-lg",placeholder:"Type your keywords here","onUpdate:modelValue":a[2]||(a[2]=o=>P.value=o)},null,512),[[ft,P.value]]),jo])])):_("",!0)])]),e("div",Oo,[e("div",No,[e("table",Ho,[e("tbody",null,[(t(!0),s(G,null,Q(_e.value,o=>{var U,T,le,W;return t(),s("tr",{key:o.id,class:"group bg-white hover:bg-gray-100 cursor-pointer"},[e("td",Ko,[o.type==="folder"?(t(),s("div",zo,[e("div",{onClick:I(ce=>te(o),["prevent"])},[e("img",{src:n(Pt)(o.icon),class:"img-fluid",alt:"Folder Icon"},null,8,Yo)],8,Go)])):(t(),s("div",Qo,[n(y).hasPermission(["view documents"])?(t(),ye(c,{key:0,to:{name:"BoardMediaDetails",params:{boardId:n(C),folderId:o.id,mediaId:(U=o==null?void 0:o.media[0])==null?void 0:U.uuid}},class:"d-block text-success hover:text-green-700 transition ease-in-out"},{default:we(()=>{var ce;return[e("img",{src:n(qt)((ce=o==null?void 0:o.media[0])==null?void 0:ce.mime_type),class:"img-fluid",alt:"File Icon"},null,8,Wo)]}),_:2},1032,["to"])):_("",!0)]))]),e("td",null,[o.type==="folder"?(t(),s("div",Zo,[e("p",Jo,r(o.name),1),e("p",Xo,[H(r(S(o).folderCount)+": ",1),ea]),e("p",ta,[H(r(S(o).fileCount)+": ",1),sa])])):(t(),s("div",oa,[n(y).hasPermission(["view documents"])?(t(),s("div",aa,[e("p",na,r((T=o==null?void 0:o.media[0])==null?void 0:T.file_name),1),e("p",la,[H(" Size: "),e("span",ia,r(n(ot)((le=o==null?void 0:o.media[0])==null?void 0:le.size)),1)])])):_("",!0)]))]),e("td",da,[o.type==="folder"?(t(),s("div",ra,[e("p",ca,r(n(He)(o.created_at,"")),1)])):(t(),s("div",ua,[n(y).hasPermission(["view documents"])?(t(),s("div",ma,[e("p",_a,r(n(He)(o.created_at,"")),1)])):_("",!0)]))]),e("td",pa,[e("div",ha,[o.type==="folder"?(t(),s("div",va,[n(y).hasPermission(["edit folders"])?(t(),s("a",{key:0,href:"#",onClick:I(ce=>i(o,"folder"),["prevent"]),class:"text-warning hover:text-blue-700 transition ease-in-out"},ga,8,ba)):_("",!0)])):(t(),s("div",ya,[n(y).hasPermission(["edit documents"])?(t(),s("a",{key:0,href:"#",onClick:I(ce=>i(o,"file"),["prevent"]),class:"text-warning hover:text-blue-700 transition ease-in-out"},wa,8,xa)):_("",!0),n(y).hasPermission(["view documents"])&&o.type==="file"?(t(),ye(c,{key:1,to:{name:"BoardMediaDetails",params:{boardId:n(C),folderId:o.id,mediaId:(W=o==null?void 0:o.media[0])==null?void 0:W.uuid}},class:"text-success hover:text-green-700 transition ease-in-out"},{default:we(()=>[ka]),_:2},1032,["to"])):_("",!0)]))])])])}),128))])])])])]),e("div",Ma,[e("dialog",{id:"foldermodal",class:"modal",ref_key:"FolderModal",ref:b},[e("form",Ca,[e("h3",Sa,r(M.value==="create"?m.value==="folder"?"Create Folder":"Upload File":m.value==="folder"?"Update Folder":"Update File"),1),Ta,e("div",Pa,[e("div",qa,[e("form",{novalidate:"",onSubmit:a[4]||(a[4]=I((...o)=>n(k)&&n(k)(...o),["prevent"])),class:"w-full rounded-xl mx-auto p-1 custom-modal"},[e("div",Da,[A(Pe,{labeled:!0,label:m.value==="folder"?"Folder name":"Upload File name",name:"name",class:"col-md-12 w-full text-sm text-white tracking-wide",placeholder:m.value==="folder"?"Folder name":"Upload File name",type:"text"},null,8,["label","placeholder"]),m.value==="file"?(t(),s("div",Ia,[A(Ye,{labeled:!0,label:"Upload Cover Image for the Board",name:"fileupload",class:"w-full text-sm text-white tracking-wide col-md-12",placeholder:"Enter Cover Image of the Board",type:"file",accept:n(Dt).join(", "),onChange:a[3]||(a[3]=o=>{n(It)(o),q(o)})},null,8,["accept"]),n(N).fileupload?(t(),s("div",Fa,[e("div",Ba,[n(Fe).previewUrl?(t(),s("img",{key:0,src:n(Fe).previewUrl,alt:"File Preview",class:"file_attachment"},null,8,Ea)):_("",!0)]),e("div",Ua,[e("p",null,[Aa,e("span",Ra,r(n(Fe).name),1)]),e("p",null,[Va,e("span",La,r(n(ot)(n(Fe).size)),1)]),e("p",null,[ja,e("span",Oa,r(n(Fe).type),1)]),e("p",null,[Na,e("span",Ha,r(n(Ft)(n(Fe).lastModifiedDate)),1)])])])):_("",!0)])):_("",!0)]),e("button",Ka,r(M.value==="create"?m.value==="folder"?"Create Folder":"Upload File":m.value==="folder"?"Update Folder":"Update File"),1)],32)])])])],512)])])):(t(),s("div",za,Ya))}}});const Wa=Ee(Qa,[["__scopeId","data-v-455161d6"]]),Ie=d(R=>(je("data-v-5ce0557a"),R=R(),Oe(),R),"_withScopeId$2"),Za={class:"row"},Ja={class:"col-md-12"},Xa={class:"card card-widget"},en={class:"card-header"},tn=Ie(()=>e("h1",{class:"h2 mb-2 lg:mb-0"},"Meetings",-1)),sn={class:"card-tools"},on=Ie(()=>e("i",{class:"far fa fa-plus mr-2"},null,-1)),an=[on],nn={key:0,class:"card-body"},ln={key:0,class:"products-list product-list-in-card pl-2 pr-2"},dn={class:"product-img meeting-custom-size mr-2"},rn={key:0,class:"calendar-icon w-full flex flex-col items-center justify-center mt-1 calendaheight"},cn={class:"month customonth"},un={class:"day font-medium customday"},mn={class:"year font-medium customyear"},_n=Ie(()=>e("div",null,[e("span",{class:"text-danger font-bold ml-2 mr-2"}," Upcoming ")],-1)),pn={class:"product-info"},hn={class:"text-primary text-bold"},vn={key:0,class:"badge float-right bg-white"},bn=["onClick"],fn={class:"badge float-right bg-white"},gn=Ie(()=>e("i",{class:"far fa-eye"},null,-1)),yn={class:"badge float-right bg-white"},xn=["onClick"],$n=Ie(()=>e("i",{class:"far fa-edit"},null,-1)),wn=[$n],kn={key:1,class:"product-description"},Mn=["innerHTML"],Cn={key:2,class:"row border-top border-bottom border-warning d-flex justify-content-between align-items-center bg-warning"},Sn={class:"text-primary bg-primary font-bold ml-2 mr-2"},Tn={class:"text-primary font-bold ml-2 mr-2"},Pn={key:0},qn=["onClick"],Dn={key:3,class:"text-bold text-red"},In={key:4,class:"text-bold text-red"},Fn={class:"text-primary font-bold ml-2 mr-2"},Bn={class:"text-primary font-bold ml-2 mr-2"},En=["onClick"],Un=Ie(()=>e("i",{class:"far fa-eye"},null,-1)),An={key:1},Rn={class:"flex justify-center col-md-6"},Vn={method:"dialog",class:"modal-box rounded-xl"},Ln={class:"font-bold text-lg justify-center flex"},jn=Ie(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),On={class:"grid grid-cols-3 md:grid-cols-3 gap-2 p-2"},Nn={class:"col-span-3"},Hn={key:0,class:"flex flex-wrap -mx-2 mt-2"},Kn={class:"w-full md:w-1/2 px-1 md:px-2"},zn={class:"w-full md:w-1/2 px-1 md:px-2"},Gn={key:1,class:"flex flex-wrap -mx-2 mt-2"},Yn={class:"w-full md:w-1/2 px-1 md:px-2"},Qn={key:2,class:"flex flex-wrap -mx-2 mt-2"},Wn={key:3,class:"flex flex-wrap -mx-2 mt-2"},Zn={class:"w-full md:w-1/3 px-1 md:px-2"},Jn={class:"w-full md:w-1/3 px-1 md:px-2"},Xn={class:"w-full md:w-1/3 px-1 md:px-2"},el=["onClick"],tl={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},sl=xe({__name:"HomeDashboard",setup(R){const y=Ce(),L=h(!1),x=h("create"),M=h(null),m=h(null);h(null);const j=Ue();h(1),h(15),h();const F=De().params.boardId,C=h(""),w=he({id:p().required(),date:p().required(),start_time:p().required(),end_time:p().required(),status:p().nullable(),heldstatus:p().nullable(),meeting_id:p().nullable()}),V=he({title:p().required(),conference:p().required(),location:p().required(),link:p().nullable(),description:p().required(),status:p().required(),board_id:p().required(),type:p().required(),schedules:Le().of(w).required()}),{handleSubmit:ee,setErrors:E,setFieldValue:b,values:$}=Ae({validationSchema:V,initialValues:{title:"",conference:"",location:"",description:"",link:null,board_id:F,status:"unpublished",type:"single",schedules:[{id:Be(),date:"",start_time:"",end_time:"",status:null,heldstatus:null,meeting_id:null}]}}),ae=d(()=>{var i;se(),x.value="create",L.value=!0,(i=m.value)==null||i.showModal()},"openCreateMeetingModal"),z=d(i=>{var l;se(),M.value=i,b("title",i.title),b("conference",i.conference),b("location",i.location),b("description",i.description),b("type",i.type),b("status",i.status),b("schedules",i.schedules);const g={id:i.nearestSchedule.id,date:i.nearestSchedule.date,start_time:i.nearestSchedule.start_time,end_time:i.nearestSchedule.end_time,status:i.nearestSchedule.status,heldstatus:i.nearestSchedule.heldstatus,meeting_id:i.nearestSchedule.meeting_id};b("schedules",[...$.schedules,g]),i.conference==="Custom 3rd party Links"&&(te(i.conference),b("link",i.link)),console.log("values",$),x.value="edit",L.value=!0,(l=m.value)==null||l.showModal()},"openEditMeetingModal"),ie=d((i,g)=>{var a;se(),M.value=i,b("title",i.title),b("conference",i.conference),b("location",i.location),b("description",i.description),b("type",i.type),b("status",i.status);const l={id:g.id,date:g.date,start_time:g.start_time,end_time:g.end_time,status:g.status,heldstatus:g.heldstatus,meeting_id:g.meeting_id};b("schedules",[l]),i.conference==="Custom 3rd party Links"&&(te(i.conference),b("link",i.link)),console.log("values",$),x.value="schedule",L.value=!0,(a=m.value)==null||a.showModal()},"openEditScheduleMeetingModal"),ue=[{name:"In Person",value:"No Vedio (Meeting in Person)"},{name:"3rd party",value:"Custom 3rd party Links"}],B=[{name:"Single",value:"single"},{name:"Find Date",value:"manual"}],te=d(i=>{C.value=i},"handleConferenceTypeChange");ke(async()=>{}),Z(()=>me);const S=Z(()=>ue),J=Z(()=>B),me=d(i=>Me({queryKey:["getBoardMeetingsKey"],queryFn:async()=>(await Qt(i,{paginate:"false"})).data}),"getMeetings"),re=ee(async i=>{var g,l,a;console.log("values",i),console.log("setErrors",E);try{x.value==="create"?await Wt(i):(g=M.value)!=null&&g.id&&await Zt(i,(l=M.value)==null?void 0:l.id),await pe(),se(),L.value=!1,(a=m.value)==null||a.close()}catch(c){c instanceof qe?E(c.messages):j(c)}});function se(){b("title",""),b("conference",""),b("location",""),b("description",""),b("link",null),b("type","single"),b("status","unpublished"),b("schedules",[{id:Be(),date:"",start_time:"",end_time:"",status:null,heldstatus:null,meeting_id:null}])}d(se,"reseting");const _e=d(()=>{Array.isArray($.schedules)||(console.error("Invalid state: values.schedules is not an array."),b("schedules",[]));const i={id:Be(),date:"",start_time:"",end_time:"",status:null,heldstatus:null,meeting_id:null};b("schedules",[...$.schedules,i])},"addEmptySchedule"),ne=d(i=>{if($.schedules.length===1){gt({title:"Error",text:"You need at least one date to schedule.",type:"error"});return}const g=$.schedules.filter((l,a)=>a!==i);b("schedules",g)},"removeSchedule"),{isLoading:be,data:de,refetch:pe}=me(F),f=h("published"),N=Z(()=>{if(!de.value)return[];const i=new Date;return de.value.filter(l=>f.value==="past"?new Date(l.created_at)<i:l.status.toLowerCase()===f.value).map(l=>{if(l.schedules&&l.schedules.length>0){const a=[...l.schedules].sort((T,le)=>{const W=new Date(T.date.split("-").reverse().join("-")),ce=new Date(le.date.split("-").reverse().join("-"));return W.getTime()-ce.getTime()});let c=a[0],o=1/0;return a.forEach(T=>{const W=new Date(T.date.split("-").reverse().join("-")).getTime()-i.getTime();Math.abs(W)<Math.abs(o)&&(o=W,c=T)}),{...l,nearestSchedule:c,schedules:a.filter(T=>T.id!==c.id)}}else return l})}),q=d(i=>{f.value=i},"filterMeetings"),v=d(i=>{switch(i){case"scheduled":return"text-primary";case"held":return"text-success";case"cancelled":return"text-danger";case"postponed":return"text-warning";default:return""}},"getHeldStatusClass"),k=d(async i=>{await Jt(i),await pe()},"onPublish");return(i,g)=>{const l=Ne("router-link");return t(),s(G,null,[e("div",Za,[e("div",Ja,[e("div",Xa,[e("div",en,[tn,e("div",sn,[e("button",{type:"button",class:K(["btn btn-tool",{"btn-info":f.value==="published"}]),onClick:g[0]||(g[0]=a=>q("published"))}," Published ",2),e("button",{type:"button",class:K(["btn btn-tool",{"btn-info":f.value==="unpublished"}]),onClick:g[1]||(g[1]=a=>q("unpublished"))}," UnPublished ",2),e("button",{type:"button",class:K(["btn btn-tool",{"btn-info":f.value==="past"}]),onClick:g[2]||(g[2]=a=>q("past"))}," Past ",2),n(y).hasPermission(["create meeting"])?(t(),s("button",{key:0,type:"button",onClick:I(ae,["prevent"]),class:"btn btn-tool"},an)):_("",!0)])]),n(y).hasPermission(["view meeting"])?(t(),s("div",nn,[N.value.length>0?(t(),s("ul",ln,[(t(!0),s(G,null,Q(N.value,a=>(t(),s("li",{class:"item",key:a.id},[e("div",dn,[a!=null&&a.nearestSchedule?(t(),s("div",rn,[e("div",cn,r(n(Et)(a.nearestSchedule.date)),1),e("div",un,[e("span",null,r(n(Ut)(a.nearestSchedule.date)),1)]),e("div",mn,[e("span",null,r(n(At)(a.nearestSchedule.date)),1)])])):_("",!0),_n]),e("div",pn,[n(y).hasPermission(["view meeting"])?(t(),ye(l,{key:0,to:{name:"BoardMeetingDetails",params:{boardId:n(F),meetingId:a.id,scheduleId:a.nearestSchedule.id}},class:"product-title"},{default:we(()=>[H(" Meeting: "),e("span",hn,r(a.title),1),f.value==="unpublished"?(t(),s("span",vn,[n(y).hasPermission(["publish meeting"])?(t(),s("a",{key:0,href:"",onClick:I(c=>k(a.id),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"}," Publish ",8,bn)):_("",!0)])):_("",!0),e("span",fn,[n(y).hasPermission(["view meeting"])?(t(),ye(l,{key:0,to:{name:"BoardMeetingDetails",params:{boardId:n(F),meetingId:a.id,scheduleId:a.nearestSchedule.id}},class:"text-green-500 hover:text-green-700 transition duration-150 ease-in-out"},{default:we(()=>[gn]),_:2},1032,["to"])):_("",!0)]),e("span",yn,[n(y).hasPermission(["edit meeting"])?(t(),s("a",{key:0,href:"",onClick:I(c=>z(a),["prevent"]),class:"text-blue-500 hover:text-blue-700 transition duration-150 ease-in-out"},wn,8,xn)):_("",!0)])]),_:2},1032,["to"])):_("",!0),n(y).hasPermission(["edit meeting"])?(t(),s("span",kn,[H(" Description: "),e("span",{class:"text-primary text-bold",innerHTML:a.description},null,8,Mn)])):_("",!0),a!=null&&a.nearestSchedule?(t(),s("div",Cn,[e("div",null,[e("span",Sn," Upcoming "+r(n(at)(a.nearestSchedule.date)),1),H(" || When: "),e("span",Tn,r(n(nt)(a.nearestSchedule.date)),1),H(" || Held Status: "),e("span",{class:K([v(a.nearestSchedule.heldstatus),"font-bold ml-2 mr-2"])},r(a.nearestSchedule.heldstatus),3)]),a!=null&&a.nearestSchedule?(t(),s("span",Pn,[a.nearestSchedule.heldstatus==="scheduled"?(t(),s("button",{key:0,class:"btn btn-sm btn-warning font-bold ml-2 mr-2 mt-1 mb-1",onClick:I(c=>ie(a,a.nearestSchedule),["prevent"])}," Postpone ",8,qn)):_("",!0)])):_("",!0)])):_("",!0),a.schedules.length?(t(),s("div",Dn,"Other Schedules")):(t(),s("div",In,"no Other Recuring Schdedules")),(t(!0),s(G,null,Q(a.schedules,c=>(t(),s("div",{class:K(["row","border-top","border-bottom","border-warning","d-flex","justify-content-between","align-items-center",n(Rt)(c.date)?"bg-gray":""]),key:c.id},[e("div",null,[H(" Day: "),e("span",Fn,r(n(at)(c.date)),1),H(" || When: "),e("span",Bn,r(n(nt)(c.date)),1),H(" || Held Status: "),e("span",{class:K([v(c.heldstatus),"font-bold ml-2 mr-2"])},r(c.heldstatus),3)]),e("span",null,[c.heldstatus==="scheduled"&&n(y).hasPermission(["edit meeting"])?(t(),s("button",{key:0,class:"btn btn-sm btn-warning font-bold ml-2 mr-2 mt-1 mb-1",onClick:I(o=>ie(a,c),["prevent"])}," Postpone ",8,En)):_("",!0),n(y).hasPermission(["view meeting"])?(t(),ye(l,{key:1,to:{name:"BoardMeetingDetails",params:{boardId:n(F),meetingId:a.id,scheduleId:c.id}},class:"mr-2 hover:text-info transition duration-150 ease-in-out"},{default:we(()=>[Un]),_:2},1032,["to"])):_("",!0)])],2))),128))])]))),128))])):(t(),s("div",An," No meetings found for "+r(f.value),1))])):_("",!0)])])]),e("div",Rn,[e("dialog",{id:"meetingmodal",class:"modal",ref_key:"MeetingModal",ref:m},[e("form",Vn,[e("h3",Ln,r(x.value=="create"?"Create Meeting":"Edit Meeting"),1),jn,e("div",{class:"overflow-auto p-4",style:it([{"max-height":"80vh"},x.value=="schedule"?"height:500px;":""])},[e("div",On,[e("div",Nn,[e("form",{novalidate:"",onSubmit:g[3]||(g[3]=I((...a)=>n(re)&&n(re)(...a),["prevent"])),class:""},[x.value=="create"||x.value=="edit"?(t(),s("div",Hn,[e("div",Kn,[A(Pe,{labeled:!0,label:"Meeting Title",name:"title",placeholder:"Enter Meeting Title",type:"text"})]),e("div",zn,[A(Ke,{labeled:!0,name:"conference",label:"Select Meeting Type",placeholder:"Select Meeting Type",options:S.value,onSelectedItem:te},null,8,["options"])])])):_("",!0),x.value=="create"||x.value=="edit"?(t(),s("div",Gn,[e("div",Yn,[C.value==="Custom 3rd party Links"?(t(),ye(Pe,{key:0,labeled:!0,label:"Meeting Link",name:"link",placeholder:"Enter Third Party Link",type:"text"})):_("",!0)]),e("div",{class:K(["w-full px-1 md:px-2",C.value==="Custom 3rd party Links"?"md:w-1/2":""])},[A(Pe,{labeled:!0,label:"Meeting Location",name:"location",placeholder:"e.g 'Conference Room 6'",type:"text"})],2)])):_("",!0),x.value=="create"||x.value=="edit"?(t(),s("div",Qn,[x.value=="create"||x.value=="edit"?(t(),ye(ze,{key:0,label:"Meeting Description",name:"description",theme:"snow",placeholder:"Enter Meeting Description",toolbar:"full",contentType:"html",class:"col-span-3"})):_("",!0)])):_("",!0),x.value=="create"||x.value=="edit"?(t(),s("div",Wn,[A(as,{name:"type",label:"Meeting Schedule Type",placeholder:"Select Meeting Schedule Type",inline:!0,options:J.value,checked:n($).type},null,8,["options","checked"])])):_("",!0),n($).schedules?(t(!0),s(G,{key:4},Q(n($).schedules,(a,c)=>(t(),s("div",{class:"flex flex-wrap -mx-2 mt-2 relative",key:c},[e("div",Zn,[A(Ve,{label:"Meeting Date "+(c+1),name:"schedules["+c+"].date",mode:"date-picker",modeltype:"dd-MM-yyyy",enabletimepicker:!1,placeholder:"Meeting Date"},null,8,["label","name"])]),e("div",Jn,[A(Ve,{label:"Meeting Start Time "+(c+1),name:"schedules["+c+"].start_time",mode:"time-picker",modeltype:"h:mm bbbb",is24:!1,enabletimepicker:!0,placeholder:"Select Start Time"},null,8,["label","name"])]),e("div",Xn,[A(Ve,{label:"Meeting End Time "+(c+1),name:"schedules["+c+"].end_time",mode:"time-picker",modeltype:"h:mm bbbb",is24:!1,enabletimepicker:!0,placeholder:"Select End Time"},null,8,["label","name"])]),x.value!=="schedule"?(t(),s("button",{key:0,type:"button",class:"absolute top-0 right-0 mt-2 mr-2 text-red-600 font-bold",onClick:I(o=>ne(c),["prevent"])}," ✕ ",8,el)):_("",!0)]))),128)):_("",!0),n($).type==="manual"&&x.value!=="schedule"?(t(),s("button",{key:5,type:"button",class:"btn btn-primary mt-4",onClick:_e}," Add Another Data ")):_("",!0),e("button",tl,r(x.value==="create"?"Create Meeting":"Edit Meeting"),1)],32)])])],4)])],512)])],64)}}});const ol=Ee(sl,[["__scopeId","data-v-5ce0557a"]]),al={class:"role-container w-100 d-flex justify-content-center"},nl=["aria-expanded"],ll={key:0,class:"dropdown-menu show justify-content","aria-labelledby":"role-status"},il=["onClick"],dl={key:1,class:"text-center"},rl=xe({__name:"MemberPosition",props:{member:{},positions:{},disableRemotePosition:{}},emits:["position-updated"],setup(R,{emit:y}){const L=R,x=y,M=h(null),m=h(!1),j=d(V=>{V.stopPropagation(),m.value=!m.value},"toggleDropdown"),P=d(V=>{x("position-updated",{memberId:L.member.id,positionId:V.id}),m.value=!1},"updateRole"),F=Z(()=>{var V;return`bg-${(V=L.member)==null?void 0:V.position.name.toLowerCase()} text-white`}),C=Z(()=>{var V;return(V=L.member)==null?void 0:V.position.name}),w=Z(()=>L.positions);return(V,ee)=>{var E,b,$,ae;return t(),s("div",al,[C.value?(t(),s("div",{key:0,class:"dropdown",ref_key:"dropdownRef",ref:M},[e("button",{class:K(["btn btn-primary dropdown-toggle text-truncate w-100",F.value]),type:"button",onClick:j,"aria-haspopup":"true","aria-expanded":m.value},[e("i",{class:K(["mr-2 fa "+((E=L.member)==null?void 0:E.position.icon),"mr-2"])},null,2),H(" "+r((b=L.member)==null?void 0:b.position.name),1)],10,nl),m.value?(t(),s("ul",ll,[(t(!0),s(G,null,Q(w.value,z=>(t(),s("li",{key:z.name},[e("a",{href:"#",class:"dropdown-item",onClick:I(ie=>P(z),["prevent"])},[e("i",{class:K(["mr-2 fa "+z.icon,"mr-2"])},null,2),H(" "+r(z.name),1)],8,il)]))),128))])):_("",!0)],512)):(t(),s("div",dl,[e("i",{class:K(["mr-2 fa "+(($=L.member)==null?void 0:$.position.icon),"mr-2"])},null,2),H(" "+r((ae=L.member)==null?void 0:ae.position.name),1)]))])}}});const cl=Ee(rl,[["__scopeId","data-v-c85c72a2"]]),Se=d(R=>(je("data-v-afd0c974"),R=R(),Oe(),R),"_withScopeId$1"),ul={class:"card"},ml={class:"card-header flex items-center"},_l=Se(()=>e("h2",{class:"card-header-title h3"},"Board Members",-1)),pl={class:"ml-auto flex items-center space-x-2"},hl={class:"container-fluid"},vl={class:"row"},bl={class:"card card-outline card-primary h-100"},fl={class:"card-body box-profile"},gl={class:"text-center"},yl={class:"profile-username text-center text-primary"},xl=["onClick"],$l=["onClick"],wl=Se(()=>e("i",{class:"far fa-eye"},null,-1)),kl=[wl],Ml={class:"text-muted text-center text-bold"},Cl={key:0,class:"mt-3"},Sl=Se(()=>e("div",{class:"text-bold text-danger text-center mb-1"}," Position ",-1)),Tl={class:"text-center"},Pl={key:1,class:"mt-3"},ql=Se(()=>e("div",{class:"text-bold text-danger text-center mb-1"}," Position ",-1)),Dl={class:"text-center"},Il={class:"mt-3"},Fl=Se(()=>e("div",{class:"text-bold text-danger text-center mb-1"}," Last Updated ",-1)),Bl={class:"text-center text-primary text-small"},El={class:"flex justify-center col-md-6"},Ul={method:"dialog",class:"modal-box rounded-xl"},Al=Se(()=>e("h3",{class:"font-bold text-lg justify-center flex"},r("Add Members"),-1)),Rl=Se(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Vl={class:"w-full mt-6 p-2"},Ll={class:"font-thin text-sm flex flex-col items-center gap-6"},jl={key:0,class:"message"},Ol=Se(()=>e("button",{type:"submit",class:"btn btn-md mb-1 w-full pt-1 text-red-600 mt-6 bg-primary"},r("Add Members"),-1)),Nl=xe({__name:"Members",setup(R){const y=Ce(),L=De(),x=Qe(),M=Ue(),m=h("create"),j=L.params.boardId,P=h(!1),F=h(null),C=h([]),w=h([]),{errorMessage:V}=Te("assignees"),ee=he({id:p().nullable(),position_id:p().nullable(),board_id:Ze().required(),members:Le().of(p()).nullable()}),{handleSubmit:E,setErrors:b,setFieldValue:$,values:ae}=Ae({validationSchema:ee,initialValues:{id:"",position_id:"",board_id:j,members:[]}}),z=d(()=>{$("members",C.value)},"selectedUsers"),ie=d(()=>{$("members",C.value)},"removeselectedUsers"),ue=d(f=>{var q;const N=f.members.map(v=>v.user.id.toString());C.value=N,$("members",C.value),m.value="edit",P.value=!0,(q=F.value)==null||q.showModal()},"openEditMembersModal"),B=E(async(f,{resetForm:N})=>{var q;try{$("members",C.value);const v={board_id:f.board_id,members:f.members};if(m.value==="create")await Xt(v,j);else if(m.value==="edit")await es(v,j);else if(m.value==="position"){const k={id:f.id,position_id:f.position_id};await ts(k,j)}await _e(),te(),(q=F.value)==null||q.close()}catch(v){v instanceof qe?b(v.messages):M(v)}}),te=d(()=>{m.value="create",P.value=!1,C.value=[],$("members",[]),$("position_id","")},"reset"),S=Z(()=>{var N;const f=[];return w.value&&((N=w.value)==null?void 0:N.length)>0&&w.value.reduce((q,v)=>(q.push({id:v.id,name:`${v.full_name}`}),q),f),f}),J=d(async()=>{const f=await rt({paginate:"false"});w.value=f.data},"getUsers");ke(async()=>{window.dispatchEvent(new CustomEvent("updateTitle",{detail:"Members"})),J()});const me=d(()=>Me({queryKey:["getBoardMembersKey",j],queryFn:async()=>(await Je(j,{paginate:"false"})).data}),"getBoardMembers"),{isLoading:re,data:se,refetch:_e}=me(),ne=h([]),be=d(async()=>{const f=await ss({paginate:"false"});ne.value=f.data},"getPositions");ke(async()=>{await be()});const de=d(f=>{te(),m.value="position",$("id",f.memberId),$("position_id",f.positionId),B()},"handlePositionUpdated"),pe=d(f=>{x.push({name:"ProfileDetails",params:{userId:f.id,profileId:f.profile.id}})},"openUserProfile");return(f,N)=>(t(),s(G,null,[e("div",ul,[e("div",ml,[_l,e("div",pl,[e("button",{class:"btn btn-secondary btn-sm",onClick:N[0]||(N[0]=I(q=>ue({members:n(se)}),["prevent"]))}," Update Members ")])]),e("div",hl,[e("div",vl,[(t(!0),s(G,null,Q(n(se),(q,v)=>(t(),s("div",{class:"col-lg-3 col-md-4 col-sm-6 mb-3",key:v},[e("div",bl,[e("div",fl,[e("div",gl,[e("h3",yl,[e("a",{href:"",onClick:I(k=>{var i,g;return((g=(i=n(y))==null?void 0:i.user)==null?void 0:g.id)===q.user.id?pe(q.user):""},["prevent"])},r(q.user.full_name),9,xl),n(y).hasPermission(["view board member profile"])?(t(),s("button",{key:0,type:"button",onClick:I(k=>pe(q.user),["prevent"]),title:"",class:"mx-2 btn btn-sm btn-primary"},kl,8,$l)):_("",!0)]),e("p",Ml,r(q.position.name),1)]),n(y).hasPermission(["assign board position"])?(t(),s("div",Cl,[Sl,e("div",Tl,[A(cl,{member:q,positions:ne.value,disableRemotePosition:0,onPositionUpdated:de},null,8,["member","positions"])])])):(t(),s("div",Pl,[ql,e("div",Dl,[e("i",{class:K(["mr-2 fa "+q.position.icon,"mr-2"])},null,2),H(" "+r(q.position.name),1)])])),e("div",Il,[Fl,e("p",Bl,r(n(He)(q.updated_at,null)),1)])])])]))),128))])])]),H("> "),e("div",El,[e("dialog",{id:"membersmodal",class:"modal",ref_key:"membersmodal",ref:F},[e("form",Ul,[Al,Rl,e("div",Vl,[e("div",Ll,[e("form",{novalidate:"",onSubmit:N[4]||(N[4]=I((...q)=>n(B)&&n(B)(...q),["prevent"])),class:"w-full rounded-xl mx-auto p-1 custom-modal"},[e("div",{class:K(["multiselect-container",{error:!!n(V)}])},[A(n(We),{id:"members",modelValue:C.value,"onUpdate:modelValue":N[1]||(N[1]=q=>C.value=q),mode:"tags",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:S.value,valueProp:"id",trackBy:"id",label:"name",class:K(["multiselect-container",{error:!!n(V)}]),onSelect:N[2]||(N[2]=q=>z()),onDeselect:N[3]||(N[3]=q=>ie())},null,8,["modelValue","options","class"]),n(V)?(t(),s("div",jl,r(n(V)),1)):_("",!0)],2),Ol],32)])])])],512)])],64))}});const Hl=Ee(Nl,[["__scopeId","data-v-afd0c974"]]),Kl={key:0},zl={class:"card h-full"},Gl={class:"card-header flex items-center"},Yl=e("div",{class:"flex items-center flex-1 w-full"},[e("h2",{class:"card-header-title h3"}," Board Polls ")],-1),Ql={key:0,class:"flex items-center space-x-2"},Wl=e("i",{class:"far fa fa-plus mr-2"},null,-1),Zl=e("span",{class:"sr-only"},"Add poll",-1),Jl={class:"card-container"},Xl={key:0},ei={key:1},ti={class:"row overflow-auto p-4",style:{"max-height":"100vh"}},si={class:"card card-outline card-primary h-100"},oi={class:"card-header"},ai={class:"card-tools"},ni=["onClick"],li=e("i",{class:"fas fa-edit"},null,-1),ii=[li],di={class:"card-body"},ri={class:"text-primary tex-bold uppercase"},ci=e("strong",{class:"text-primary"},"Question:",-1),ui={class:"mt-2 text-primary text-bold"},mi={class:""},_i=e("strong",null,"Answer Options:",-1),pi={class:"row"},hi={class:"col-6"},vi={class:"list-unstyled text-success"},bi={class:"col-6"},fi={class:"list-unstyled text-success"},gi={class:"d-flex justify-content-between"},yi=e("strong",null,"Due Date:",-1),xi=e("strong",null,"Status:",-1),$i=e("strong",null,"Vote:",-1),wi=["innerHTML"],ki={class:""},Mi=e("strong",null,"Assignees:",-1),Ci={class:"row"},Si={class:"col-6"},Ti={class:"list-unstyled"},Pi={class:"col-6"},qi={class:"list-unstyled"},Di=e("strong",null,"Description:",-1),Ii=["innerHTML"],Fi={class:"flex justify-center items-center min-h-screen"},Bi={method:"dialog",class:"modal-box rounded-xl relative bg-white shadow-xl"},Ei={class:"font-bold text-lg text-center"},Ui=e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1),Ai={class:"overflow-auto p-4",style:{"max-height":"80vh"}},Ri={class:"grid grid-cols-2 md:grid-cols-2 gap-4 p-2"},Vi={class:"col-span-2"},Li={class:"flex flex-wrap -mx-2 mt-2"},ji={class:"w-full md:w-1/2 px-1 md:px-2"},Oi={class:"w-full md:w-1/2 px-1 md:px-2"},Ni={class:"flex flex-wrap -mx-2 mt-2"},Hi={class:"w-full md:w-1/3 px-1 md:px-2 text-center"},Ki=e("h2",{class:"font-bold text-sm text-center"},"Click to Add Options",-1),zi=e("h4",{class:"text-info font-semibold"},"Your Options",-1),Gi={key:0},Yi={key:0,class:"w-full md:w-2/3 px-1 md:px-2 flex flex-col"},Qi=["onClick"],Wi={class:"flex flex-wrap -mx-2 mt-2"},Zi={class:"w-full md:w-1/2 px-1 md:px-2"},Ji={class:"w-full md:w-1/2 px-1 md:px-2"},Xi={key:0},ed=e("h2",{class:"font-bold text-primary text-sm text-center"}," All Members Will be assiged this Poll ",-1),td=[ed],sd={key:0,class:"form-group col-span-3"},od=e("label",{class:"text-bold font-medium tracking-wide"}," People To Vote ",-1),ad={key:0,class:"message"},nd={key:1},ld={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},id={key:1},dd=e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1),rd=[dd],cd=xe({__name:"Pollp",setup(R){const y=Ce(),L=De(),x=h(!1),M=h("create"),m=L.params.boardId,j=h(null),P=h([]),F=h(null),C=h("single"),w=h("individuals"),V=h([]),ee=h([]),E=h(""),b=Ue();Te("duedate");const{errorMessage:$}=Te("pollassignees"),ae=he({id:p().required(),title:p().required(),poll_id:p().nullable(),deleted_at:p().nullable(),created_at:p().nullable(),updated_at:p().nullable()}),z=he({id:p().required(),full_name:p().required()}),ie=he({id:p().required(),poll_id:p().nullable(),member_id:p().required(),user:z}),ue=he({board_id:p().nullable(),question:p().required(),description:p().required(),questionoptiontype:p().required(),optionstatus:p().required(),options:Le().of(ae).required(),duedate:p().required(),assigneetype:p().required(),assigneestatus:p().required(),pollassignees:Le().of(ie).nullable(),status:p().required()}),{handleSubmit:B,setErrors:te,setFieldValue:S,values:J}=Ae({validationSchema:ue,initialValues:{board_id:m,question:"",description:"",questionoptiontype:"",optionstatus:"",options:[{id:Be(),title:"",poll_id:null,deleted_at:null,created_at:null,updated_at:null}],duedate:"",assigneetype:"",assigneestatus:"",pollassignees:[],status:"inactive"}});Te("options");const me=d(()=>{var u;de(),M.value="create",x.value=!0,(u=F.value)==null||u.showModal()},"openCreatePollModal"),re=d(u=>{var O;de(),j.value=u.id,S("question",u.question),S("description",u.description),S("questionoptiontype",u.questionoptiontype),S("optionstatus",u.optionstatus),S("duedate",u.duedate),S("assigneetype",u.assigneetype),S("assigneestatus",u.assigneestatus),S("status",u.status),S("options",u.options),w.value=u.assigneestatus,se(u.pollassignees),M.value="edit",x.value=!0,(O=F.value)==null||O.showModal()},"openEditPollModal");function se(u){P.value=u.map(O=>({id:O.id,full_name:O.user.full_name,poll_id:O.poll_id,member_id:O.member_id,user:O.user})),S("pollassignees",P.value)}d(se,"mappollassigneesToReactiveRef");const _e=d(()=>{S("pollassignees",P.value)},"selectedMembers"),ne=d(()=>{S("pollassignees",P.value)},"removeselectedUsers"),be=B(async(u,{resetForm:O})=>{var D;try{console.log("dddd");const Y={board_id:u.board_id,question:u.question,description:u.description,questionoptiontype:u.questionoptiontype,optionstatus:u.optionstatus,options:u.options,duedate:u.duedate,assigneetype:u.assigneetype,assigneestatus:u.assigneestatus,pollassignees:u.pollassignees,status:u.status};if(M.value==="create")await ns(Y,m);else{const X=j.value;await ls(Y,X)}(D=F.value)==null||D.close(),await Xe(),de()}catch(Y){Y instanceof qe?te(Y.messages):b(Y)}}),de=d(()=>{M.value="create",x.value=!1,j.value=null,C.value="single",w.value="all_members",P.value=[],S("board_id",m),S("question",""),S("description",""),S("questionoptiontype","single"),S("optionstatus","single"),S("options",[{id:Be(),title:"",poll_id:null,deleted_at:null,created_at:null,updated_at:null}]),S("duedate",""),S("assigneetype","all_members"),S("assigneestatus","all_members"),S("pollassignees",[]),S("status","inactive")},"reset"),pe=d(u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),"formattedDateTime"),f=d(u=>N(u)?"bg-danger":"bg-success","dateBadgeClass"),N=d(u=>{const O=new Date,D=new Date(u);return O>D},"hasDueDatePassed"),q=d(u=>{if(!u.votes||u.votes.length===0)return"No votes yet";const O=u.votes.length,D=u.pollassignees.length;if(O>D)return console.error("Total votes exceed total members, which is unexpected."),"Voting data error";const Y=u.votes.reduce((fe,Re)=>{const Ge=JSON.parse(Re.option_id).id;return fe[Ge]=(fe[Ge]||0)+1,fe},{}),X=Object.keys(Y).reduce((fe,Re)=>Y[fe]>Y[Re]?fe:Re);if(!u.options.find(fe=>fe.id===X))return console.error("Most voted option not found in poll options."),"Voting data error";const ht=D-O;return(Y[X]/O*100).toFixed(1),`${u.options.map(fe=>`${((Y[fe.id]||0)/O*100).toFixed(1)}% voted for ${fe.title}`).join("<br>")}<br>Total votes: ${O} / ${ht} not yet`},"calculateVoteStats"),v=d(u=>{switch(u){case"Backlog":return"badge bg-warning";case"Pending":return"badge bg-info";case"On Progress":return"badge bg-primary";case"Completed":return"badge bg-success";default:return"badge"}},"statusClass"),k=[{name:"Single Answer",value:"single"},{name:"Multiple Answers: More than one",value:"multiple"}],i=[{name:"Individuals",value:"individuals"},{name:"Assign All Board Members",value:"all_members"}],g=Z(()=>k),l=Z(()=>i),a=d(u=>{ee.value=[],V.value=[],o(),C.value=u,S("questionoptiontype",u),S("optionstatus",u)},"handleQuestionOptionTypeChange"),c=d(u=>{P.value=[],E.value=u,w.value=u,S("assigneetype",u),S("assigneestatus",u),S("pollassignees",[])},"handleAssigneeTypeChange"),o=d(()=>{Array.isArray(J.options)||(console.error("Invalid state: values.options is not an array."),S("options",[]));const u={id:Be(),title:"",poll_id:null,deleted_at:null,created_at:null,updated_at:null};S("options",[...J.options,u])},"addEmptyOption");lt(()=>J.options,u=>{});const U=d(u=>{const O=J.options.filter(D=>D.id!==u);console.log("vv",O),S("options",O)},"removeOption"),T=d(()=>Me({queryKey:["getPollMembershisKey"],queryFn:async()=>(await Je(m,{paginate:"false"})).data.map(ct())}),"getMembers"),{isLoading:le,data:W,refetch:ce}=T(),ct=d(()=>u=>({id:u.id,full_name:u.user.full_name,member_id:u.id,user:u.user}),"formatEvent"),ut=Z(()=>{var u;return!W.value||((u=W.value)==null?void 0:u.length)===0?[]:W.value}),mt=d(()=>Me({queryKey:["getBoardPollsKey",m],queryFn:async()=>(await is(m,{paginate:"false"})).data}),"getBoardPolls"),{isLoading:_t,data:pt,refetch:Xe}=mt();return ke(async()=>{ce(),Xe()}),(u,O)=>n(y).hasPermission(["view poll"])?(t(),s("div",Kl,[e("div",zl,[e("div",Gl,[Yl,n(y).hasPermission(["create poll"])?(t(),s("div",Ql,[e("button",{type:"button",onClick:I(me,["prevent"]),class:"btn btn-tool"},[Wl,H(),Zl])])):_("",!0)]),e("div",Jl,[n(_t)?(t(),s("div",Xl,"Loading Board Polls...")):(t(),s("div",ei,[e("div",ti,[(t(!0),s(G,null,Q(n(pt),(D,Y)=>(t(),s("div",{class:"col-lg-12 col-md-12 col-sm-12 mb-2",key:Y},[e("div",si,[e("div",oi,[e("div",ai,[n(y).hasPermission(["edit poll"])?(t(),s("button",{key:0,class:"btn btn-tool",onClick:I(X=>re(D),["prevent"])},ii,8,ni)):_("",!0)])]),e("div",di,[e("div",ri,[ci,e("p",ui,r(D.question),1),e("div",mi,[_i,e("div",pi,[e("div",hi,[e("ul",vi,[(t(!0),s(G,null,Q(D.options.slice(0,Math.ceil(D.options.length/2)),(X,$e)=>(t(),s("li",{key:X.id},r($e+1)+". "+r(X.title),1))),128))])]),e("div",bi,[e("ul",fi,[(t(!0),s(G,null,Q(D.options.slice(Math.ceil(D.options.length/2)),(X,$e)=>(t(),s("li",{key:X.id},r($e+1+Math.ceil(D.options.length/2))+". "+r(X.title),1))),128))])])])])]),e("div",gi,[e("div",null,[yi,e("p",{class:K(f(D.duedate))},r(pe(D.duedate)),3)]),e("div",null,[xi,e("p",null,[e("span",{class:K(v(D.status))},r(D.status),3)])]),e("div",null,[$i,e("p",null,[e("span",{innerHTML:q(D)},null,8,wi)])])]),e("div",ki,[Mi,e("div",Ci,[e("div",Si,[e("ul",Ti,[(t(!0),s(G,null,Q(D.pollassignees.slice(0,Math.ceil(D.pollassignees.length/2)),(X,$e)=>(t(),s("li",{key:X.id},r($e+1)+". "+r(X.user.full_name),1))),128))])]),e("div",Pi,[e("ul",qi,[(t(!0),s(G,null,Q(D.pollassignees.slice(Math.ceil(D.pollassignees.length/2)),(X,$e)=>(t(),s("li",{key:X.id},r($e+1+Math.ceil(D.pollassignees.length/2))+". "+r(X.user.full_name),1))),128))])])])]),e("div",null,[Di,e("p",{innerHTML:D.description,class:"mt-2"},null,8,Ii)])])])]))),128))])]))])]),e("div",Fi,[e("dialog",{id:"pollmodal",class:"modal w-full max-w-4xl mx-auto p-0",ref_key:"PollModal",ref:F},[e("form",Bi,[e("h3",Ei,r(M.value=="create"?"Create Poll":"Edit Poll"),1),Ui,e("div",Ai,[e("div",Ri,[e("div",Vi,[e("form",{novalidate:"",onSubmit:O[3]||(O[3]=I((...D)=>n(be)&&n(be)(...D),["prevent"])),class:""},[A(Pe,{labeled:!0,label:"Poll Question",name:"question",placeholder:"Enter Poll Question",type:"text"}),A(ze,{label:"Poll description",name:"description",theme:"snow",placeholder:"Enter Poll Description",toolbar:"full",contentType:"html",class:"col-span-2"}),e("div",Li,[e("div",ji,[A(Ke,{labeled:!0,name:"questionoptiontype",label:"Select Allowed Answers On the Question",placeholder:"Select Allowed Answers On the Question",options:g.value,onSelectedItem:a},null,8,["options"])]),e("div",Oi,[A(Ve,{label:"Poll Due Date",name:"duedate",flow:["month"],placeholder:"Enter Poll Due Date & Time"})])]),e("div",Ni,[e("div",Hi,[e("div",null,[Ki,e("button",{onClick:I(o,["prevent"]),class:"btn btn-primary h-10 mt-2"}," Add Option ")]),zi,n(J).options?(t(),s("ul",Gi,[(t(!0),s(G,null,Q(n(J).options,(D,Y)=>(t(),s("li",{class:"text-primary font-bold text-justify",key:Y},r(Y+1)+"."+r(D==null?void 0:D.title),1))),128))])):_("",!0)]),n(J).options?(t(),s("div",Yi,[(t(!0),s(G,null,Q(n(J).options,(D,Y)=>(t(),s("div",{class:"form-group flex items-center mb-2",key:Y},[A(os,{labeled:!0,label:"Title for option "+(Y+1),name:"options["+Y+"].title",placeholder:"Enter title",class:"flex-grow",type:"text"},null,8,["label","name"]),e("a",{href:"#",class:"ml-2 text-red-600 font-bold mt-8",onClick:I(X=>U(D.id),["prevent"])}," ✕ ",8,Qi)]))),128))])):_("",!0)]),e("div",Wi,[e("div",Zi,[A(Ke,{labeled:!0,name:"assigneetype",label:"Select Assignee Type",placeholder:"Select Assignee Type",options:l.value,onSelectedItem:c},null,8,["options"])]),e("div",Ji,[w.value==="all_members"?(t(),s("div",Xi,td)):_("",!0)])]),w.value==="individuals"?(t(),s("div",sd,[od,e("div",{class:K(["multiselect-container",{error:!!n($)}])},[A(n(We),{id:"pollassignees",modelValue:P.value,"onUpdate:modelValue":O[0]||(O[0]=D=>P.value=D),mode:"tags",required:"",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:ut.value,valueProp:"member_id",trackBy:"member_id",label:"full_name",class:K(["col-span-3",["multiselect-container",{error:!!n($)}]]),object:!0,onSelect:O[1]||(O[1]=D=>_e()),onDeselect:O[2]||(O[2]=D=>ne())},null,8,["modelValue","options","class"]),n($)?(t(),s("div",ad,r(n($)),1)):_("",!0)],2)])):_("",!0),P.value&&P.value.length||w.value==="all_members"?(t(),s("div",nd,[e("button",ld,r(M.value=="create"?"Create Poll":"Edit Poll"),1)])):_("",!0)],32)])])])])],512)])])):(t(),s("div",id,rd))}});const ve=d(R=>(je("data-v-1356323c"),R=R(),Oe(),R),"_withScopeId"),ud={key:0},md={class:"card h-full"},_d={class:"card-header flex items-center"},pd=ve(()=>e("div",{class:"flex items-center flex-1 w-full"},[e("h2",{class:"card-header-title h3"},"Meeting Tasks")],-1)),hd={key:0,class:"flex items-center space-x-2"},vd=ve(()=>e("i",{class:"far fa fa-plus mr-2"},null,-1)),bd=ve(()=>e("span",{class:"sr-only"},"Add task",-1)),fd={class:"card-container"},gd={key:0},yd={key:1},xd={class:"row overflow-auto p-4",style:{"max-height":"100vh"}},$d={class:"card card-outline card-primary h-100"},wd={class:"card-header"},kd={class:"card-tools"},Md=["onClick"],Cd=ve(()=>e("i",{class:"fas fa-edit"},null,-1)),Sd=[Cd],Td={class:"card-body"},Pd={class:"text-primary text-bold uppercase"},qd={class:"d-flex justify-content-between"},Dd=ve(()=>e("strong",null,"Due Date:",-1)),Id=ve(()=>e("strong",null,"Status:",-1)),Fd={key:0,class:"badge bg-warning"},Bd={key:1,class:"badge bg-info"},Ed={key:2,class:"badge bg-primary"},Ud={key:3,class:"badge bg-success"},Ad={class:""},Rd=ve(()=>e("strong",null,"Assignees:",-1)),Vd={class:"row"},Ld={class:"col-6"},jd={class:"list-unstyled"},Od={class:"col-6"},Nd={class:"list-unstyled"},Hd=ve(()=>e("strong",null,"Description:",-1)),Kd=["innerHTML"],zd={class:"flex justify-center col-md-6"},Gd={method:"dialog",class:"modal-box rounded-xl"},Yd={class:"font-bold text-lg justify-center flex"},Qd=ve(()=>e("button",{class:"btn btn-sm btn-circle btn-ghost absolute right-2 top-2"},"✕",-1)),Wd={class:"overflow-auto p-4",style:{"max-height":"80vh"}},Zd={class:"grid grid-cols-3 md:grid-cols-3 gap-2 p-2"},Jd={class:"col-span-3"},Xd={class:"flex flex-wrap -mx-2 mt-2"},er={class:"w-full md:w-1/2 px-1 md:px-2"},tr={class:"w-full md:w-1/2 px-1 md:px-2"},sr={class:"flex flex-wrap -mx-2 mt-2"},or={class:"w-full md:w-1/2 px-1 md:px-2"},ar={class:"w-full md:w-1/2 px-1 md:px-2"},nr={key:0},lr=ve(()=>e("h2",{class:"font-bold text-primary text-sm text-center"},"All Members Will be assigned this Task",-1)),ir=[lr],dr={key:0,class:"form-group col-span-3"},rr=ve(()=>e("label",{class:"text-bold font-medium tracking-wide"},"People to Assign",-1)),cr={key:0,class:"message"},ur={key:1},mr={type:"submit",class:"btn btn-primary btn-md w-full mt-6"},_r={key:1},pr=ve(()=>e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1)),hr=[pr],vr=xe({__name:"Taskp",setup(R){const y=Ce(),L=De(),x=h(!1),M=h("create"),m=L.params.boardId,j=h(null),P=h([]),F=h(null),C=h(null),w=h("individuals"),V=h(""),ee=Ue();Te("duedate");const{errorMessage:E}=Te("taskassignees"),b=d(o=>{const U=new Date,T=new Date(o);return U>T},"hasDueDatePassed"),$=he({id:p().nullable(),full_name:p().nullable()}),ae=he({id:p().nullable(),task_id:p().nullable(),member_id:p().nullable(),user:$}),z=he({board_id:p().nullable(),title:p().required(),duedate:p().required(),description:p().required(),status:p().required(),assigneetype:p().required(),assigneestatus:p().required(),taskassignees:Le().of(ae).nullable()}),{handleSubmit:ie,setErrors:ue,setFieldValue:B,values:te}=Ae({validationSchema:z,initialValues:{board_id:m,title:"",duedate:"",description:"",status:"pending",assigneetype:"",assigneestatus:"",taskassignees:[]}}),S=d(()=>{var o;ne(),M.value="create",x.value=!0,(o=C.value)==null||o.showModal()},"openCreateTaskModal"),J=d(o=>{var U;ne(),F.value=o,j.value=o.id,B("title",o.title),B("duedate",o.duedate),B("description",o.description),B("status",o.status),B("assigneetype",o.assigneetype),B("assigneestatus",o.assigneestatus),w.value=o.assigneestatus,me(o.taskassignees),M.value="edit",x.value=!0,(U=C.value)==null||U.showModal()},"openEditTaskModal");function me(o){P.value=o.map(U=>({id:U.id,full_name:U.user.full_name,task_id:U.task_id,member_id:U.member_id,user:U.user})),B("taskassignees",P.value)}d(me,"maptaskassigneesToReactiveRef");const re=d(()=>{B("taskassignees",P.value)},"selectedMembers"),se=d(()=>{B("taskassignees",P.value)},"removeselectedUsers"),_e=ie(async(o,{resetForm:U})=>{var T;try{const le={board_id:o.board_id,title:o.title,duedate:o.duedate,description:o.description,status:o.status,assigneetype:o.assigneetype,assigneestatus:o.assigneestatus,taskassignees:o.taskassignees};if(M.value==="create")await ds(le,m);else{const W=j.value;await rs(le,W)}(T=C.value)==null||T.close(),await c(),ne()}catch(le){le instanceof qe?ue(le.messages):ee(le)}}),ne=d(()=>{M.value="create",x.value=!1,j.value=null,w.value="all_members",P.value=[],B("board_id",m),B("title",""),B("duedate",""),B("description","description ................"),B("status","pending"),B("assigneetype","all_members"),B("assigneestatus","all_members"),B("taskassignees",[])},"reset"),be=d(o=>{P.value=[],V.value=o,w.value=o,B("assigneetype",o),B("assigneestatus",o),B("taskassignees",[])},"handleAssigneeTypeChange"),de=[{name:"Individuals",value:"individuals"},{name:"Assign All Meeting Members",value:"all_members"}],pe=Z(()=>de),f=d(()=>Me({queryKey:["getBoardMembersKey"],queryFn:async()=>(await Je(m,{paginate:"false"})).data.map(k())}),"getMembers"),{isLoading:N,data:q,refetch:v}=f(),k=d(()=>o=>({id:o.id,full_name:o.user.full_name,member_id:o.id,user:o.user}),"formatEvent"),i=Z(()=>{var o;return!q.value||((o=q.value)==null?void 0:o.length)===0?[]:q.value}),g=d(()=>Me({queryKey:["getBoardTasksKey",m],queryFn:async()=>(await cs(m,{paginate:"false"})).data}),"getBoardTasks"),{isLoading:l,data:a,refetch:c}=g();return ke(async()=>{c(),v()}),(o,U)=>n(y).hasPermission(["view task"])?(t(),s("div",ud,[e("div",md,[e("div",_d,[pd,n(y).hasPermission(["create task"])?(t(),s("div",hd,[e("button",{type:"button",onClick:I(S,["prevent"]),class:"btn btn-tool"},[vd,H(),bd])])):_("",!0)]),e("div",fd,[n(l)?(t(),s("div",gd,"Loading Meeting Tasks...")):(t(),s("div",yd,[e("div",xd,[(t(!0),s(G,null,Q(n(a),(T,le)=>(t(),s("div",{class:"col-lg-12 col-md-12 col-sm-12 mb-2",key:le},[e("div",$d,[e("div",wd,[e("div",kd,[n(y).hasPermission(["edit task"])?(t(),s("button",{key:0,class:"btn btn-tool",onClick:I(W=>J(T),["prevent"])},Sd,8,Md)):_("",!0)])]),e("div",Td,[e("div",Pd,r(T.title),1),e("div",qd,[e("div",null,[Dd,e("p",{class:K({"text-danger":b(T.duedate)&&T.status!=="completed","text-success":!b(T.duedate)||T.status==="completed"})},r(n(He)(T.duedate)),3)]),e("div",null,[Id,e("p",null,[T.status==="backlog"?(t(),s("span",Fd,"Backlog")):T.status==="pending"?(t(),s("span",Bd,"Pending")):T.status==="onprogress"?(t(),s("span",Ed,"On Progress")):T.status==="completed"?(t(),s("span",Ud,"Completed")):_("",!0)])])]),e("div",Ad,[Rd,e("div",Vd,[e("div",Ld,[e("ul",jd,[(t(!0),s(G,null,Q(T.taskassignees.slice(0,Math.ceil(T.taskassignees.length/2)),(W,ce)=>(t(),s("li",{key:W.id},r(ce+1)+". "+r(W.user.full_name),1))),128))])]),e("div",Od,[e("ul",Nd,[(t(!0),s(G,null,Q(T.taskassignees.slice(Math.ceil(T.taskassignees.length/2)),(W,ce)=>(t(),s("li",{key:W.id},r(ce+1+Math.ceil(T.taskassignees.length/2))+". "+r(W.user.full_name),1))),128))])])])]),e("div",null,[Hd,e("p",{innerHTML:T.description,class:"mt-2"},null,8,Kd)])])])]))),128))])]))])]),e("div",zd,[e("dialog",{id:"taskmodal",class:"modal",ref_key:"TaskModal",ref:C},[e("form",Gd,[e("h3",Yd,r(M.value=="create"?"Create Meeting Task":"Edit Meeting Task"),1),Qd,e("div",Wd,[e("div",Zd,[e("div",Jd,[e("form",{novalidate:"",onSubmit:U[3]||(U[3]=I((...T)=>n(_e)&&n(_e)(...T),["prevent"])),class:""},[e("div",Xd,[e("div",er,[A(Pe,{labeled:!0,label:"Task Title",name:"title",placeholder:"Enter Task Title",type:"text"})]),e("div",tr,[A(Ve,{label:"Task Due Date",name:"duedate",flow:["month"],placeholder:"Task Due Date"})])]),A(ze,{label:"Task Description",name:"description",theme:"snow",placeholder:"Enter Task Description",toolbar:"full",contentType:"html",class:"col-span-3"}),e("div",sr,[e("div",or,[A(Ke,{labeled:!0,name:"assigneetype",label:"Select Assignee Type",placeholder:"Select Assignee Type",options:pe.value,onSelectedItem:be},null,8,["options"])]),e("div",ar,[w.value==="all_members"?(t(),s("div",nr,ir)):_("",!0)])]),w.value==="individuals"?(t(),s("div",dr,[rr,e("div",{class:K(["multiselect-container",{error:!!n(E)}])},[A(n(We),{id:"taskassignees",modelValue:P.value,"onUpdate:modelValue":U[0]||(U[0]=T=>P.value=T),mode:"tags",required:"",placeholder:"Choose your stack","close-on-select":!1,"filter-results":!1,"min-chars":1,"resolve-on-load":!1,delay:0,searchable:!0,options:i.value,valueProp:"member_id",trackBy:"member_id",label:"full_name",class:K(["col-span-3",["multiselect-container",{error:!!n(E)}]]),object:!0,onSelect:U[1]||(U[1]=T=>re()),onDeselect:U[2]||(U[2]=T=>se())},null,8,["modelValue","options","class"]),n(E)?(t(),s("div",cr,r(n(E)),1)):_("",!0)],2)])):_("",!0),P.value&&P.value.length||w.value==="all_members"?(t(),s("div",ur,[e("button",mr,r(M.value=="create"?"Create Task":"Edit Task"),1)])):_("",!0)],32)])])])])],512)])])):(t(),s("div",_r,hr))}});const br=Ee(vr,[["__scopeId","data-v-1356323c"]]),fr={key:0},gr={class:"row"},yr={class:"col-md-6"},xr={class:"col-md-6"},$r={key:1},wr=e("p",{class:"m-0"},[e("span",{class:"h3 text-primary text-bold text-danger"},"Sorry, You are not Authorised to view this page")],-1),kr=[wr],Mr=xe({__name:"TaskPolls",setup(R){const y=Ce();return(L,x)=>n(y).hasPermission(["view task","view poll"])?(t(),s("div",fr,[e("div",gr,[e("div",yr,[A(br)]),e("div",xr,[A(cd)])])])):(t(),s("div",$r,kr))}});const Cr={class:"col-md-12"},Sr={key:0,class:"card card-widget widget-user shadow-lg"},Tr=e("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.5)"}},null,-1),Pr=[Tr],qr={class:"card-footer"},Dr={class:""},Ir={class:"widget-user-image",style:{left:"4%","margin-left":"-45px",position:"absolute",top:"190px"}},Fr=["src"],Br={class:"ml-3 flex-1",style:{"margin-top":"-28px"}},Er=e("i",{class:"fas fa-chevron-left fa-xs"},null,-1),Ur={class:"h2 mb-2 lg:mb-0",style:{"margin-left":"150px"}},Ar={class:"card-outline card-outline-tabs"},Rr={class:"card-header p-0 border-bottom-0"},Vr={class:"nav nav-tabs",id:"custom-tabs-four-tab",role:"tablist"},Lr=["onClick"],jr={class:"card-body"},Or={class:"tab-content",id:"custom-tabs-four-tabContent"},Nr=["id"],uc=xe({__name:"BoardDetails",setup(R){const y=Ce(),L=h(),x=De(),M=Qe(),m=h("home"),j=h(""),P=[{id:"home",name:"Meeting Details",component:ol,permissions:["view meeting"]},{id:"documents",name:"Documents",component:Wa,permissions:["view documents"]},{id:"tasks",name:"Task & Polls",component:Mr,permissions:["view task","view poll"]},{id:"members",name:"Members",component:Hl,permissions:["view meeting memberships"]},{id:"committees",name:"Committees",component:_o,permissions:["view committee"]}],F=Z(()=>P.filter(E=>E.permissions?E.permissions.every(b=>y.hasPermission([b])):!0)),C=d(E=>{j.value=m.value,m.value=E},"setActiveTab"),w=d(()=>{j.value==="agenda"&&(C("agenda"),window.dispatchEvent(new CustomEvent("refetchMemberships")))},"handleMembershipsUpdated");yt(()=>{x.query.previousTab&&(j.value=x.query.previousTab),x.query.currentTab&&(m.value=x.query.currentTab)});function V(){M.push({name:$t})}d(V,"goBack");const ee=x.params.boardId;return ke(async()=>{try{const b=(await wt(ee)).data;L.value=b,window.dispatchEvent(new CustomEvent("updateTitle",{detail:b.name}))}catch(E){console.error("Error fetching board data:",E)}}),(E,b)=>(t(),s("div",Cr,[L.value?(t(),s("div",Sr,[e("div",{class:"widget-user-header text-white",style:it([{backgroundImage:`url(${n(Vt)(L.value.cover)})`,backgroundPosition:"center center",backgroundSize:"cover",backgroundRepeat:"no-repeat"},{height:"250px",width:"100%",position:"relative"}])},Pr,4),e("div",qr,[e("div",Dr,[e("div",Ir,[e("img",{class:"img-circle elevation-2",src:n(dt)(L.value.icon),alt:"User Avatar",style:{width:"128px",height:"128px"}},null,8,Fr)]),e("div",Br,[e("a",{href:"",onClick:b[0]||(b[0]=I($=>V(),["prevent"])),class:"mb-2 lg:mb-0 text-blue-primary",style:{"margin-left":"140px","margin-top":"-44px"}},[Er,H(" Boards ")]),e("h3",Ur,r(L.value.name),1),e("div",Ar,[e("div",Rr,[e("ul",Vr,[(t(!0),s(G,null,Q(F.value,$=>(t(),s("li",{class:"nav-item",key:$.id},[e("a",{class:K(["nav-link",{active:m.value===$.id}]),onClick:ae=>C($.id)},r($.name),11,Lr)]))),128))])]),e("div",jr,[e("div",Or,[(t(!0),s(G,null,Q(F.value,$=>(t(),s("div",{key:$.id,class:K(["tab-pane fade",{"show active":m.value===$.id}]),id:$.id,role:"tabpanel"},[(t(),ye(xt($.component),{onChangeTab:C,onMembershipsUpdated:w},null,32))],10,Nr))),128))])])])])])])])):_("",!0)]))}});export{uc as default};
